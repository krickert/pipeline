
tika-input-doc-038*€Ñsource-code/SecurityIntegrationTests_v1.java source-code/SecurityIntegrationTests_v1.java//Â VARIATIONÂ 38Â ofÂ SecurityÂ TestÂ SourceÂ (VariantÂ 1) //Â GeneratedÂ on:Â 2025-06-18T14:38:08.460485142Z //Â BaseÂ file:Â source-code/SecurityIntegrationTests.java packageÂ com.rokkon.integration.security; importÂ com.google.protobuf.ByteString; importÂ com.google.protobuf.Empty; importÂ com.google.protobuf.Struct; importÂ com.google.protobuf.Value; importÂ com.rokkon.search.model.*; importÂ com.rokkon.search.sdk.*; importÂ io.grpc.ManagedChannel; importÂ io.grpc.ManagedChannelBuilder; importÂ io.grpc.Status; importÂ io.grpc.StatusRuntimeException; importÂ io.quarkus.test.junit.QuarkusIntegrationTest; importÂ org.junit.jupiter.api.*; importÂ org.slf4j.Logger; importÂ org.slf4j.LoggerFactory; importÂ java.nio.charset.StandardCharsets; importÂ java.security.MessageDigest; importÂ java.util.*; importÂ java.util.concurrent.TimeUnit; importÂ java.util.regex.Pattern; importÂ staticÂ org.junit.jupiter.api.Assertions.*; /** Â *Â ComprehensiveÂ securityÂ integrationÂ testsÂ toÂ validateÂ inputÂ validation,Â maliciousÂ contentÂ handling, Â *Â dataÂ integrityÂ verification,Â andÂ securityÂ boundariesÂ acrossÂ allÂ services. Â *Â  Â *Â TheseÂ testsÂ verify: Â *Â -Â InputÂ validationÂ andÂ sanitization Â *Â -Â MaliciousÂ contentÂ detectionÂ andÂ handling Â *Â -Â DataÂ integrityÂ verificationÂ andÂ checksums Â *Â -Â SecurityÂ boundaryÂ enforcement Â *Â -Â BufferÂ overflowÂ andÂ injectionÂ attackÂ prevention Â *Â -Â ContentÂ filteringÂ andÂ blacklistÂ enforcement Â *Â -Â SecureÂ errorÂ handlingÂ withoutÂ informationÂ leakage Â *Â -Â AuthenticationÂ andÂ authorizationÂ patterns Â *Â -Â SecureÂ dataÂ transmissionÂ andÂ storage Â *Â -Â PrivacyÂ andÂ dataÂ protectionÂ compliance Â */ @QuarkusIntegrationTest @TestMethodOrder(MethodOrderer.OrderAnnotation.class) @Disabled("RequiresÂ fullÂ gRPCÂ serviceÂ infrastructureÂ forÂ comprehensiveÂ securityÂ testingÂ againstÂ maliciousÂ inputsÂ andÂ attacks") classÂ SecurityIntegrationTestsÂ { Â Â Â Â privateÂ staticÂ finalÂ LoggerÂ LOGÂ =Â LoggerFactory.getLogger(SecurityIntegrationTests.class); Â Â Â Â  Â Â Â Â //Â SecurityÂ testÂ patterns Â Â Â Â privateÂ staticÂ finalÂ List<String>Â SQL_INJECTION_PATTERNSÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â "';Â DROPÂ TABLEÂ users;Â --", Â Â Â Â Â Â Â Â "'Â ORÂ '1'='1", Â Â Â Â Â Â Â Â "'Â UNIONÂ SELECTÂ *Â FROMÂ sensitive_dataÂ --", Â Â Â Â Â Â Â Â "admin'--", Â Â Â Â Â Â Â Â "'Â ORÂ 1=1#" Â Â Â Â ); Â Â Â Â  Â Â Â Â privateÂ staticÂ finalÂ List<String>Â XSS_PATTERNSÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â "<script>alert('XSS')</script>", Â Â Â Â Â Â Â Â "javascript:alert('XSS')", Â Â Â Â Â Â Â Â "<imgÂ src=xÂ onerror=alert('XSS')>", Â Â Â Â Â Â Â Â "<svgÂ onload=alert('XSS')>", Â Â Â Â Â Â Â Â "';alert('XSS');//" Â Â Â Â ); Â Â Â Â  Â Â Â Â privateÂ staticÂ finalÂ List<String>Â COMMAND_INJECTION_PATTERNSÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â ";Â rmÂ -rfÂ /", Â Â Â Â Â Â Â Â "|Â catÂ /etc/passwd", Â Â Â Â Â Â Â Â "&&Â whoami", Â Â Â Â Â Â Â Â "`rmÂ -rfÂ /`", Â Â Â Â Â Â Â Â "$(catÂ /etc/passwd)" Â Â Â Â ); Â Â Â Â  Â Â Â Â privateÂ staticÂ finalÂ List<String>Â PATH_TRAVERSAL_PATTERNSÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â "../../../etc/passwd", Â Â Â Â Â Â Â Â "..\\..\\..\\windows\\system32\\config\\sam", Â Â Â Â Â Â Â Â "....//....//....//etc/passwd", Â Â Â Â Â Â Â Â "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd", Â Â Â Â Â Â Â Â "..%252f..%252f..%252fetc%252fpasswd" Â Â Â Â ); Â Â Â Â  Â Â Â Â //Â ContentÂ securityÂ patterns Â Â Â Â privateÂ staticÂ finalÂ PatternÂ SUSPICIOUS_PATTERNÂ =Â Pattern.compile( Â Â Â Â Â Â Â Â "(?i)(password|secret|key|token|auth|admin|root|exploit|hack|inject|malware|virus)", Â Â Â Â Â Â Â Â Pattern.CASE_INSENSITIVEÂ |Â Pattern.MULTILINE Â Â Â Â ); Â Â Â Â  Â Â Â Â privateÂ staticÂ finalÂ longÂ MAX_CONTENT_SIZEÂ =Â 100Â *Â 1024Â *Â 1024;Â //Â 100MB Â Â Â Â privateÂ staticÂ finalÂ intÂ MAX_FIELD_LENGTHÂ =Â 10000; Â Â Â Â  Â Â Â Â privateÂ ManagedChannelÂ tikaChannel; Â Â Â Â privateÂ ManagedChannelÂ chunkerChannel; Â Â Â Â privateÂ ManagedChannelÂ embedderChannel; Â Â Â Â privateÂ ManagedChannelÂ echoChannel; Â Â Â Â  Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ tikaClient; Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ chunkerClient; Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ embedderClient; Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ echoClient; Â Â Â Â @BeforeEach Â Â Â Â voidÂ setUp()Â { Â Â Â Â Â Â Â Â //Â SetÂ upÂ gRPCÂ channelsÂ forÂ securityÂ testing Â Â Â Â Â Â Â Â tikaChannelÂ =Â ManagedChannelBuilder.forAddress("localhost",Â 9000).usePlaintext().build(); Â Â Â Â Â Â Â Â chunkerChannelÂ =Â ManagedChannelBuilder.forAddress("localhost",Â 9001).usePlaintext().build(); Â Â Â Â Â Â Â Â embedderChannelÂ =Â ManagedChannelBuilder.forAddress("localhost",Â 9002).usePlaintext().build(); Â Â Â Â Â Â Â Â echoChannelÂ =Â ManagedChannelBuilder.forAddress("localhost",Â 9003).usePlaintext().build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tikaClientÂ =Â PipeStepProcessorGrpc.newBlockingStub(tikaChannel); Â Â Â Â Â Â Â Â chunkerClientÂ =Â PipeStepProcessorGrpc.newBlockingStub(chunkerChannel); Â Â Â Â Â Â Â Â embedderClientÂ =Â PipeStepProcessorGrpc.newBlockingStub(embedderChannel); Â Â Â Â Â Â Â Â echoClientÂ =Â PipeStepProcessorGrpc.newBlockingStub(echoChannel); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("SecurityÂ integrationÂ testÂ environmentÂ initialized"); Â Â Â Â } Â Â Â Â @AfterEachÂ  Â Â Â Â voidÂ tearDown()Â throwsÂ InterruptedExceptionÂ { Â Â Â Â Â Â Â Â ifÂ (tikaChannelÂ !=Â null)Â { Â Â Â Â Â Â Â Â Â Â Â Â tikaChannel.shutdown(); Â Â Â Â Â Â Â Â Â Â Â Â tikaChannel.awaitTermination(5,Â TimeUnit.SECONDS); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â ifÂ (chunkerChannelÂ !=Â null)Â { Â Â Â Â Â Â Â Â Â Â Â Â chunkerChannel.shutdown(); Â Â Â Â Â Â Â Â Â Â Â Â chunkerChannel.awaitTermination(5,Â TimeUnit.SECONDS); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â ifÂ (embedderChannelÂ !=Â null)Â { Â Â Â Â Â Â Â Â Â Â Â Â embedderChannel.shutdown(); Â Â Â Â Â Â Â Â Â Â Â Â embedderChannel.awaitTermination(5,Â TimeUnit.SECONDS); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â ifÂ (echoChannelÂ !=Â null)Â { Â Â Â Â Â Â Â Â Â Â Â Â echoChannel.shutdown(); Â Â Â Â Â Â Â Â Â Â Â Â echoChannel.awaitTermination(5,Â TimeUnit.SECONDS); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(1) Â Â Â Â @DisplayName("SQLÂ InjectionÂ AttackÂ Prevention") Â Â Â Â voidÂ testSqlInjectionPrevention()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ SQLÂ injectionÂ attackÂ prevention"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Map<String,Â Integer>Â serviceVulnerabilitiesÂ =Â newÂ HashMap<>(); Â Â Â Â Â Â Â Â intÂ totalInjectionAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ blockedAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ injectionPatternÂ :Â SQL_INJECTION_PATTERNS)Â { Â Â Â Â Â Â Â Â Â Â Â Â totalInjectionAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ eachÂ serviceÂ withÂ SQLÂ injectionÂ patterns Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testServiceWithMaliciousInput(tikaClient,Â "tika",Â injectionPattern,Â "SQLÂ Injection"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceVulnerabilities.merge("tika",Â 1,Â Integer::sum); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testServiceWithMaliciousInput(chunkerClient,Â "chunker",Â injectionPattern,Â "SQLÂ Injection"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceVulnerabilities.merge("chunker",Â 1,Â Integer::sum); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testServiceWithMaliciousInput(embedderClient,Â "embedder",Â injectionPattern,Â "SQLÂ Injection"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceVulnerabilities.merge("embedder",Â 1,Â Integer::sum); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testServiceWithMaliciousInput(echoClient,Â "echo",Â injectionPattern,Â "SQLÂ Injection"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceVulnerabilities.merge("echo",Â 1,Â Integer::sum); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â totalInjectionAttemptsÂ +=Â 3;Â //Â AddedÂ 3Â moreÂ services Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ blockingRateÂ =Â (double)Â blockedAttemptsÂ /Â totalInjectionAttempts; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â VerifyÂ SQLÂ injectionÂ protection Â Â Â Â Â Â Â Â assertTrue(blockingRateÂ >=Â 0.90,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("SQLÂ injectionÂ blockingÂ rateÂ %.2f%%Â belowÂ minimumÂ 90%%",Â blockingRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â CheckÂ forÂ service-specificÂ vulnerabilities Â Â Â Â Â Â Â Â forÂ (Map.Entry<String,Â Integer>Â entryÂ :Â serviceVulnerabilities.entrySet())Â { Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceNameÂ =Â entry.getKey(); Â Â Â Â Â Â Â Â Â Â Â Â IntegerÂ vulnerabilityCountÂ =Â entry.getValue(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(vulnerabilityCountÂ <=Â 1,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ serviceÂ hasÂ %dÂ SQLÂ injectionÂ vulnerabilities",Â serviceName,Â vulnerabilityCount)); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â SQLÂ injectionÂ preventionÂ testÂ completedÂ -Â BlockingÂ rate:Â {:.2f}%,Â Vulnerabilities:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockingRateÂ *Â 100,Â serviceVulnerabilities); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(2) Â Â Â Â @DisplayName("Cross-SiteÂ ScriptingÂ (XSS)Â Prevention") Â Â Â Â voidÂ testXssPreventionAndSanitization()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ XSSÂ preventionÂ andÂ contentÂ sanitization"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â intÂ totalXssAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ sanitizedResponsesÂ =Â 0; Â Â Â Â Â Â Â Â List<String>Â unsanitizedResponsesÂ =Â newÂ ArrayList<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ xssPatternÂ :Â XSS_PATTERNS)Â { Â Â Â Â Â Â Â Â Â Â Â Â totalXssAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ XSSÂ patternÂ handlingÂ inÂ documentÂ content Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("xss-test-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("XSSÂ Test:Â "Â +Â xssPattern) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody("ContentÂ withÂ XSSÂ attempt:Â "Â +Â xssPattern) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("xss-security-test",Â "echo-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â echoClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseTitleÂ =Â response.getOutputDoc().getTitle(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseBodyÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ ifÂ XSSÂ patternsÂ wereÂ sanitizedÂ orÂ escaped Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ titleSanitizedÂ =Â !responseTitle.contains("<script>")Â &&Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseTitle.contains("javascript:")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseTitle.contains("onerror=")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseTitle.contains("onload="); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ bodySanitizedÂ =Â !responseBody.contains("<script>")Â &&Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseBody.contains("javascript:")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseBody.contains("onerror=")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseBody.contains("onload="); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (titleSanitizedÂ &&Â bodySanitized)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sanitizedResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â unsanitizedResponses.add("Pattern:Â "Â +Â xssPatternÂ +Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "Â -Â Title:Â "Â +Â responseTitleÂ +Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "Â -Â Body:Â "Â +Â responseBody); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ rejectedÂ maliciousÂ contentÂ -Â alsoÂ countsÂ asÂ protection Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sanitizedResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ blockedÂ theÂ requestÂ -Â thisÂ isÂ good Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sanitizedResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LOG.debug("XSSÂ patternÂ blockedÂ byÂ service:Â {}",Â xssPattern); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ sanitizationRateÂ =Â (double)Â sanitizedResponsesÂ /Â totalXssAttempts; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(sanitizationRateÂ >=Â 0.95,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("XSSÂ sanitizationÂ rateÂ %.2f%%Â belowÂ minimumÂ 95%%",Â sanitizationRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(unsanitizedResponses.size()Â <=Â 1,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("TooÂ manyÂ unsanitizedÂ XSSÂ responses:Â %s",Â unsanitizedResponses)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â XSSÂ preventionÂ testÂ completedÂ -Â SanitizationÂ rate:Â {:.2f}%,Â Unsanitized:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sanitizationRateÂ *Â 100,Â unsanitizedResponses.size()); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(3) Â Â Â Â @DisplayName("CommandÂ InjectionÂ AttackÂ Prevention") Â Â Â Â voidÂ testCommandInjectionPrevention()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ commandÂ injectionÂ attackÂ prevention"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â intÂ totalCommandAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ blockedCommandsÂ =Â 0; Â Â Â Â Â Â Â Â Map<String,Â List<String>>Â serviceFailuresÂ =Â newÂ HashMap<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ commandPatternÂ :Â COMMAND_INJECTION_PATTERNS)Â { Â Â Â Â Â Â Â Â Â Â Â Â totalCommandAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ commandÂ injectionÂ inÂ documentÂ processing Â Â Â Â Â Â Â Â Â Â Â Â StringÂ maliciousContentÂ =Â "DocumentÂ contentÂ withÂ commandÂ injection:Â "Â +Â commandPattern; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ TikaÂ serviceÂ (mostÂ likelyÂ toÂ executeÂ commandsÂ onÂ files) Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testTikaServiceWithMaliciousCommand(commandPattern))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedCommands++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceFailures.computeIfAbsent("tika",Â kÂ ->Â newÂ ArrayList<>()).add(commandPattern); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ otherÂ services Â Â Â Â Â Â Â Â Â Â Â Â forÂ (StringÂ serviceNameÂ :Â Arrays.asList("chunker",Â "embedder",Â "echo"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("cmd-injection-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("CommandÂ injectionÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(maliciousContent) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("command-injection-test",Â serviceNameÂ +Â "-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ clientÂ =Â getClientForService(serviceName); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("command-injection-test",Â serviceNameÂ +Â "-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â VerifyÂ noÂ commandÂ executionÂ artifactsÂ inÂ response Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseContentÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ forÂ signsÂ ofÂ commandÂ execution Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ hasExecutionArtifactsÂ =Â responseContent.contains("root:")Â ||Â //Â passwdÂ file Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseContent.contains("uid=")Â ||Â Â Â Â //Â whoamiÂ output Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseContent.contains("/bin/")Â ||Â Â Â //Â systemÂ paths Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseContent.contains("administrator");Â //Â windowsÂ user Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (!hasExecutionArtifacts)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedCommands++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceFailures.computeIfAbsent(serviceName,Â kÂ ->Â newÂ ArrayList<>()).add(commandPattern); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ rejectedÂ maliciousÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedCommands++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ blockedÂ theÂ request Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedCommands++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â totalCommandAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ commandBlockingRateÂ =Â (double)Â blockedCommandsÂ /Â totalCommandAttempts; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(commandBlockingRateÂ >=Â 0.90,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("CommandÂ injectionÂ blockingÂ rateÂ %.2f%%Â belowÂ minimumÂ 90%%",Â commandBlockingRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â VerifyÂ noÂ serviceÂ hadÂ multipleÂ commandÂ injectionÂ vulnerabilities Â Â Â Â Â Â Â Â forÂ (Map.Entry<String,Â List<String>>Â entryÂ :Â serviceFailures.entrySet())Â { Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceNameÂ =Â entry.getKey(); Â Â Â Â Â Â Â Â Â Â Â Â List<String>Â failuresÂ =Â entry.getValue(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(failures.size()Â <=Â 1,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ serviceÂ vulnerableÂ toÂ commandÂ injection:Â %s",Â serviceName,Â failures)); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â CommandÂ injectionÂ preventionÂ testÂ completedÂ -Â BlockingÂ rate:Â {:.2f}%,Â Failures:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â commandBlockingRateÂ *Â 100,Â serviceFailures); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(4) Â Â Â Â @DisplayName("PathÂ TraversalÂ AttackÂ Prevention") Â Â Â Â voidÂ testPathTraversalPrevention()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ pathÂ traversalÂ attackÂ prevention"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â intÂ totalTraversalAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ blockedTraversalsÂ =Â 0; Â Â Â Â Â Â Â Â List<String>Â vulnerableResponsesÂ =Â newÂ ArrayList<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ traversalPatternÂ :Â PATH_TRAVERSAL_PATTERNS)Â { Â Â Â Â Â Â Â Â Â Â Â Â totalTraversalAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ pathÂ traversalÂ inÂ filenameÂ (TikaÂ serviceÂ mostÂ vulnerable) Â Â Â Â Â Â Â Â Â Â Â Â byte[]Â dummyContentÂ =Â "DummyÂ fileÂ contentÂ forÂ pathÂ traversalÂ test".getBytes(StandardCharsets.UTF_8); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â BlobÂ maliciousBlobÂ =Â Blob.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlobId("traversal-test-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setFilename(traversalPattern)Â //Â MaliciousÂ filename Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setData(ByteString.copyFrom(dummyContent)) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMimeType("text/plain") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("path-traversal-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("PathÂ traversalÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlob(maliciousBlob) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("path-traversal-test",Â "tika-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â tikaClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseBodyÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ forÂ signsÂ ofÂ successfulÂ pathÂ traversal Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ hasSystemFilesÂ =Â responseBody.contains("root:x:0:0:root")Â ||Â //Â passwdÂ fileÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseBody.contains("[HKEY_LOCAL_MACHINE")Â ||Â //Â registryÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseBody.contains("Administrator")Â ||Â Â Â Â Â Â //Â windowsÂ admin Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseBody.contains("daemon:x:");Â Â Â Â Â Â Â Â Â Â Â //Â moreÂ passwdÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (!hasSystemFiles)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedTraversals++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â vulnerableResponses.add("Pattern:Â "Â +Â traversalPatternÂ +Â "Â exposedÂ systemÂ files"); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ rejectedÂ maliciousÂ filename Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedTraversals++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ blockedÂ theÂ request Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedTraversals++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LOG.debug("PathÂ traversalÂ blocked:Â {}",Â traversalPattern); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ traversalBlockingRateÂ =Â (double)Â blockedTraversalsÂ /Â totalTraversalAttempts; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(traversalBlockingRateÂ >=Â 0.95,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("PathÂ traversalÂ blockingÂ rateÂ %.2f%%Â belowÂ minimumÂ 95%%",Â traversalBlockingRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(vulnerableResponses.isEmpty(),Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("PathÂ traversalÂ vulnerabilitiesÂ detected:Â %s",Â vulnerableResponses)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â PathÂ traversalÂ preventionÂ testÂ completedÂ -Â BlockingÂ rate:Â {:.2f}%",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â traversalBlockingRateÂ *Â 100); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(5) Â Â Â Â @DisplayName("BufferÂ OverflowÂ andÂ LargeÂ InputÂ Handling") Â Â Â Â voidÂ testBufferOverflowPrevention()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ bufferÂ overflowÂ preventionÂ andÂ largeÂ inputÂ handling"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â List<BufferOverflowTestResult>Â testResultsÂ =Â newÂ ArrayList<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â TestÂ variousÂ bufferÂ overflowÂ scenarios Â Â Â Â Â Â Â Â testResults.add(testLargeContentHandling("echo",Â 1024Â *Â 1024));Â Â Â Â Â Â //Â 1MB Â Â Â Â Â Â Â Â testResults.add(testLargeContentHandling("echo",Â 10Â *Â 1024Â *Â 1024));Â //Â 10MB Â Â Â Â Â Â Â Â testResults.add(testLargeContentHandling("chunker",Â 5Â *Â 1024Â *Â 1024));Â //Â 5MB Â Â Â Â Â Â Â Â testResults.add(testExtremelyLongFieldHandling()); Â Â Â Â Â Â Â Â testResults.add(testMaliciousBinaryContentHandling()); Â Â Â Â Â Â Â Â testResults.add(testDeeplyNestedStructureHandling()); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â VerifyÂ allÂ bufferÂ overflowÂ testsÂ passed Â Â Â Â Â Â Â Â forÂ (BufferOverflowTestResultÂ resultÂ :Â testResults)Â { Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(result.handledGracefully,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("BufferÂ overflowÂ testÂ failed:Â %s",Â result.testDescription)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertFalse(result.causedCrash,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("ServiceÂ crashedÂ duringÂ test:Â %s",Â result.testDescription)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(result.responseTimeÂ <Â 60000,Â //Â MaxÂ 1Â minute Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("TestÂ tookÂ tooÂ longÂ (%dms):Â %s",Â result.responseTime,Â result.testDescription)); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â BufferÂ overflowÂ preventionÂ testÂ completedÂ -Â AllÂ {}Â testsÂ passed",Â testResults.size()); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(6) Â Â Â Â @DisplayName("DataÂ IntegrityÂ andÂ ChecksumÂ Verification") Â Â Â Â voidÂ testDataIntegrityVerification()Â throwsÂ ExceptionÂ { Â Â Â Â Â Â Â Â LOG.info("TestingÂ dataÂ integrityÂ andÂ checksumÂ verification"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Map<String,Â DataIntegrityResult>Â integrityResultsÂ =Â newÂ HashMap<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â TestÂ dataÂ integrityÂ acrossÂ allÂ services Â Â Â Â Â Â Â Â integrityResults.put("TikaParser",Â testServiceDataIntegrity(tikaClient,Â "tika")); Â Â Â Â Â Â Â Â integrityResults.put("Chunker",Â testServiceDataIntegrity(chunkerClient,Â "chunker")); Â Â Â Â Â Â Â Â integrityResults.put("Embedder",Â testServiceDataIntegrity(embedderClient,Â "embedder")); Â Â Â Â Â Â Â Â integrityResults.put("Echo",Â testServiceDataIntegrity(echoClient,Â "echo")); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â VerifyÂ dataÂ integrityÂ forÂ allÂ services Â Â Â Â Â Â Â Â forÂ (Map.Entry<String,Â DataIntegrityResult>Â entryÂ :Â integrityResults.entrySet())Â { Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceNameÂ =Â entry.getKey(); Â Â Â Â Â Â Â Â Â Â Â Â DataIntegrityResultÂ resultÂ =Â entry.getValue(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(result.integrityMaintained,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ failedÂ toÂ maintainÂ dataÂ integrity",Â serviceName)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(result.checksumValid,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ failedÂ checksumÂ validation",Â serviceName)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertFalse(result.dataCorrupted,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ corruptedÂ dataÂ duringÂ processing",Â serviceName)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â LOG.info("âœ…Â {}Â dataÂ integrityÂ verifiedÂ -Â InputÂ hash:Â {},Â OutputÂ hash:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceName,Â result.inputHash,Â result.outputHash); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â DataÂ integrityÂ verificationÂ testÂ completed"); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(7) Â Â Â Â @DisplayName("SecureÂ ErrorÂ HandlingÂ andÂ InformationÂ LeakageÂ Prevention") Â Â Â Â voidÂ testSecureErrorHandling()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ secureÂ errorÂ handlingÂ andÂ informationÂ leakageÂ prevention"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â List<String>Â informationLeaksÂ =Â newÂ ArrayList<>(); Â Â Â Â Â Â Â Â intÂ totalErrorTestsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ secureErrorResponsesÂ =Â 0; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â TestÂ variousÂ errorÂ conditionsÂ thatÂ mightÂ leakÂ sensitiveÂ information Â Â Â Â Â Â Â Â List<String>Â errorInducingInputsÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â Â Â Â Â "",Â Â //Â EmptyÂ input Â Â Â Â Â Â Â Â Â Â Â Â null,Â //Â NullÂ handlingÂ (willÂ beÂ convertedÂ toÂ empty) Â Â Â Â Â Â Â Â Â Â Â Â "a".repeat(MAX_FIELD_LENGTHÂ +Â 1),Â //Â TooÂ longÂ input Â Â Â Â Â Â Â Â Â Â Â Â "\u0000\u0001\u0002",Â //Â Binary/controlÂ characters Â Â Â Â Â Â Â Â Â Â Â Â "{'malformed':Â json}",Â //Â MalformedÂ JSON-likeÂ content Â Â Â Â Â Â Â Â Â Â Â Â "ðŸš€ðŸ”¥ðŸ’¯".repeat(1000)Â //Â UnicodeÂ stressÂ test Â Â Â Â Â Â Â Â ); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ serviceNameÂ :Â Arrays.asList("tika",Â "chunker",Â "embedder",Â "echo"))Â { Â Â Â Â Â Â Â Â Â Â Â Â forÂ (StringÂ errorInputÂ :Â errorInducingInputs)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â totalErrorTests++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ errorDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("error-test-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle(errorInputÂ !=Â nullÂ ?Â errorInputÂ :Â "") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(errorInputÂ !=Â nullÂ ?Â errorInputÂ :Â "") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ request; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("error-handling-test",Â serviceNameÂ +Â "-step",Â errorDoc); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createProcessRequest("error-handling-test",Â serviceNameÂ +Â "-step",Â errorDoc); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ clientÂ =Â getClientForService(serviceName); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ forÂ informationÂ leakageÂ inÂ response Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseTextÂ =Â response.toString(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (containsSensitiveInformation(responseText))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â informationLeaks.add(String.format("%sÂ serviceÂ leakedÂ informationÂ withÂ input:Â %s",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceName,Â errorInput)); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â secureErrorResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ errorÂ messageÂ forÂ informationÂ leakage Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ errorMessageÂ =Â e.getMessage(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (containsSensitiveInformation(errorMessage))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â informationLeaks.add(String.format("%sÂ serviceÂ errorÂ leakedÂ information:Â %s",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceName,Â errorMessage)); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â secureErrorResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â OtherÂ exceptionsÂ shouldÂ alsoÂ beÂ checked Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (containsSensitiveInformation(e.getMessage()))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â informationLeaks.add(String.format("%sÂ serviceÂ exceptionÂ leakedÂ information:Â %s",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceName,Â e.getMessage())); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â secureErrorResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ secureErrorRateÂ =Â (double)Â secureErrorResponsesÂ /Â totalErrorTests; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(secureErrorRateÂ >=Â 0.90,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("SecureÂ errorÂ handlingÂ rateÂ %.2f%%Â belowÂ minimumÂ 90%%",Â secureErrorRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(informationLeaks.size()Â <=Â 2,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("TooÂ manyÂ informationÂ leaksÂ detected:Â %s",Â informationLeaks)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â SecureÂ errorÂ handlingÂ testÂ completedÂ -Â SecureÂ rate:Â {:.2f}%,Â Leaks:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â secureErrorRateÂ *Â 100,Â informationLeaks.size()); Â Â Â Â } Â Â Â Â  Â Â Â Â //Â HelperÂ Methods Â Â Â Â privateÂ booleanÂ testServiceWithMaliciousInput(PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ client, Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceName,Â StringÂ maliciousInput,Â StringÂ attackType)Â { Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("security-test-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle(attackTypeÂ +Â "Â test:Â "Â +Â maliciousInput) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody("ContentÂ withÂ "Â +Â attackTypeÂ +Â ":Â "Â +Â maliciousInput) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ request; Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("security-test",Â serviceNameÂ +Â "-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createProcessRequest("security-test",Â serviceNameÂ +Â "-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ ifÂ maliciousÂ inputÂ wasÂ sanitizedÂ orÂ blocked Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseContentÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â IfÂ theÂ maliciousÂ inputÂ appearsÂ unchanged,Â itÂ wasn'tÂ blocked Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ !responseContent.contains(maliciousInput); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ rejectedÂ theÂ requestÂ -Â goodÂ securityÂ behavior Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true; Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ blockedÂ theÂ requestÂ -Â goodÂ securityÂ behavior Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true; Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â LOG.debug("ServiceÂ {}Â failedÂ withÂ maliciousÂ inputÂ {}:Â {}",Â serviceName,Â maliciousInput,Â e.getMessage()); Â Â Â Â Â Â Â Â Â Â Â Â returnÂ false; Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ booleanÂ testTikaServiceWithMaliciousCommand(StringÂ commandPattern)Â { Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â //Â CreateÂ aÂ documentÂ withÂ commandÂ injectionÂ inÂ filenameÂ andÂ content Â Â Â Â Â Â Â Â Â Â Â Â StringÂ maliciousContentÂ =Â "DocumentÂ contentÂ "Â +Â commandPattern; Â Â Â Â Â Â Â Â Â Â Â Â byte[]Â contentBytesÂ =Â maliciousContent.getBytes(StandardCharsets.UTF_8); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â BlobÂ maliciousBlobÂ =Â Blob.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlobId("cmd-injection-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setFilename("test"Â +Â commandPatternÂ +Â ".txt") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setData(ByteString.copyFrom(contentBytes)) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMimeType("text/plain") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("cmd-injection-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("CommandÂ injectionÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlob(maliciousBlob) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("cmd-injection-test",Â "tika-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â tikaClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseContentÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ forÂ signsÂ ofÂ commandÂ execution Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ !responseContent.contains("root:")Â &&Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseContent.contains("uid=")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseContent.contains("/bin/")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseContent.contains("administrator"); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true;Â //Â ServiceÂ blockedÂ theÂ request Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true;Â //Â ServiceÂ blockedÂ theÂ request Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â returnÂ false; Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ BufferOverflowTestResultÂ testLargeContentHandling(StringÂ serviceName,Â intÂ contentSize)Â { Â Â Â Â Â Â Â Â StringÂ testDescriptionÂ =Â String.format("%sÂ serviceÂ withÂ %dÂ byteÂ content",Â serviceName,Â contentSize); Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System.currentTimeMillis(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â //Â CreateÂ largeÂ content Â Â Â Â Â Â Â Â Â Â Â Â StringBuilderÂ largeContentÂ =Â newÂ StringBuilder(); Â Â Â Â Â Â Â Â Â Â Â Â StringÂ patternÂ =Â "LargeÂ contentÂ testÂ patternÂ "; Â Â Â Â Â Â Â Â Â Â Â Â whileÂ (largeContent.length()Â <Â contentSize)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â largeContent.append(pattern); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (largeContent.length()Â >=Â contentSize)Â break; Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ largeDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("buffer-overflow-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("BufferÂ overflowÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(largeContent.toString()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ request; Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("buffer-test",Â serviceNameÂ +Â "-step",Â largeDoc); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createProcessRequest("buffer-test",Â serviceNameÂ +Â "-step",Â largeDoc); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ clientÂ =Â getClientForService(serviceName); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.withDeadlineAfter(60,Â TimeUnit.SECONDS) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ handledÂ largeÂ contentÂ gracefully Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (e.getStatus().getCode()Â ==Â Status.Code.RESOURCE_EXHAUSTEDÂ ||Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â e.getStatus().getCode()Â ==Â Status.Code.INVALID_ARGUMENT)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ properlyÂ rejectedÂ oversizedÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â UnexpectedÂ error Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â true,Â responseTime); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ BufferOverflowTestResultÂ testExtremelyLongFieldHandling()Â { Â Â Â Â Â Â Â Â StringÂ testDescriptionÂ =Â "ExtremelyÂ longÂ fieldÂ handling"; Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System.currentTimeMillis(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â StringÂ extremelyLongTitleÂ =Â "A".repeat(100000);Â //Â 100kÂ characters Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ longFieldDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("long-field-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle(extremelyLongTitle) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody("NormalÂ bodyÂ content") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("long-field-test",Â "echo-step",Â longFieldDoc); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â echoClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (e.getStatus().getCode()Â ==Â Status.Code.INVALID_ARGUMENTÂ || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â e.getStatus().getCode()Â ==Â Status.Code.RESOURCE_EXHAUSTED)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â true,Â responseTime); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ BufferOverflowTestResultÂ testMaliciousBinaryContentHandling()Â { Â Â Â Â Â Â Â Â StringÂ testDescriptionÂ =Â "MaliciousÂ binaryÂ contentÂ handling"; Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System.currentTimeMillis(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â //Â CreateÂ binaryÂ contentÂ thatÂ mightÂ causeÂ bufferÂ overflows Â Â Â Â Â Â Â Â Â Â Â Â byte[]Â maliciousBinaryÂ =Â newÂ byte[10000]; Â Â Â Â Â Â Â Â Â Â Â Â Arrays.fill(maliciousBinary,Â (byte)Â 0xFF);Â //Â FillÂ withÂ maxÂ byteÂ value Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â BlobÂ maliciousBlobÂ =Â Blob.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlobId("malicious-binary-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setFilename("malicious.bin") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setData(ByteString.copyFrom(maliciousBinary)) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMimeType("application/octet-stream") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ binaryDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("binary-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("BinaryÂ contentÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlob(maliciousBlob) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("binary-test",Â "tika-step",Â binaryDoc); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â tikaClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â true,Â responseTime); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ BufferOverflowTestResultÂ testDeeplyNestedStructureHandling()Â { Â Â Â Â Â Â Â Â StringÂ testDescriptionÂ =Â "DeeplyÂ nestedÂ structureÂ handling"; Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System.currentTimeMillis(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â //Â CreateÂ deeplyÂ nestedÂ JSON-likeÂ content Â Â Â Â Â Â Â Â Â Â Â Â StringBuilderÂ nestedContentÂ =Â newÂ StringBuilder(); Â Â Â Â Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â 0;Â iÂ <Â 1000;Â i++)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â nestedContent.append("{\"level").append(i).append("\":Â "); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â nestedContent.append("\"deep_value\""); Â Â Â Â Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â 0;Â iÂ <Â 1000;Â i++)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â nestedContent.append("}"); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ nestedDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("nested-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("NestedÂ structureÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(nestedContent.toString()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("nested-test",Â "chunker-step",Â nestedDoc); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â chunkerClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â true,Â responseTime); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ DataIntegrityResultÂ testServiceDataIntegrity(PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ client, Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceName)Â throwsÂ ExceptionÂ { Â Â Â Â Â Â Â Â StringÂ testContentÂ =Â "DataÂ integrityÂ testÂ contentÂ forÂ "Â +Â serviceNameÂ +Â "Â service.Â "Â + Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "ThisÂ contentÂ shouldÂ maintainÂ itsÂ integrityÂ duringÂ processing."; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â CalculateÂ inputÂ hash Â Â Â Â Â Â Â Â MessageDigestÂ md5Â =Â MessageDigest.getInstance("MD5"); Â Â Â Â Â Â Â Â StringÂ inputHashÂ =Â bytesToHex(md5.digest(testContent.getBytes(StandardCharsets.UTF_8))); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â PipeDocÂ inputDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("integrity-test-"Â +Â serviceName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("DataÂ integrityÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(testContent) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ProcessRequestÂ request; Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("integrity-test",Â serviceNameÂ +Â "-step",Â inputDoc); Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createProcessRequest("integrity-test",Â serviceNameÂ +Â "-step",Â inputDoc); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.processData(request); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ifÂ (!response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ DataIntegrityResult(false,Â false,Â true,Â inputHash,Â ""); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â StringÂ outputContentÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â StringÂ outputHashÂ =Â bytesToHex(md5.digest(outputContent.getBytes(StandardCharsets.UTF_8))); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â ForÂ mostÂ services,Â contentÂ shouldÂ beÂ preservedÂ exactlyÂ (exceptÂ embedderÂ whichÂ addsÂ embeddings) Â Â Â Â Â Â Â Â booleanÂ integrityMaintainedÂ =Â "embedder".equals(serviceName)Â ||Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â outputContent.contains(testContent)Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â inputHash.equals(outputHash); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â booleanÂ checksumValidÂ =Â inputHash.equals(outputHash)Â ||Â "embedder".equals(serviceName); Â Â Â Â Â Â Â Â booleanÂ dataCorruptedÂ =Â outputContent.isEmpty()Â ||Â outputContent.contains("\u0000"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â returnÂ newÂ DataIntegrityResult(integrityMaintained,Â checksumValid,Â dataCorrupted,Â inputHash,Â outputHash); Â Â Â Â } Â Â Â Â privateÂ booleanÂ containsSensitiveInformation(StringÂ text)Â { Â Â Â Â Â Â Â Â ifÂ (textÂ ==Â null)Â returnÂ false; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â StringÂ lowerTextÂ =Â text.toLowerCase(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â CheckÂ forÂ variousÂ typesÂ ofÂ sensitiveÂ information Â Â Â Â Â Â Â Â returnÂ lowerText.contains("password")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("secret")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("privateÂ key")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("apiÂ key")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("token")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("creditÂ card")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("ssn")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("socialÂ security")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("/etc/passwd")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("c:\\windows")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("database")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("connectionÂ string")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("stackÂ trace")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("exception")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("errorÂ atÂ line")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("fileÂ notÂ found")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("accessÂ denied"); Â Â Â Â } Â Â Â Â privateÂ StringÂ bytesToHex(byte[]Â bytes)Â { Â Â Â Â Â Â Â Â StringBuilderÂ resultÂ =Â newÂ StringBuilder(); Â Â Â Â Â Â Â Â forÂ (byteÂ bÂ :Â bytes)Â { Â Â Â Â Â Â Â Â Â Â Â Â result.append(String.format("%02x",Â b)); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â returnÂ result.toString(); Â Â Â Â } Â Â Â Â privateÂ ProcessRequestÂ createProcessRequest(StringÂ pipelineName,Â StringÂ stepName,Â PipeDocÂ document)Â { Â Â Â Â Â Â Â Â ServiceMetadataÂ metadataÂ =Â ServiceMetadata.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setPipelineName(pipelineName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setPipeStepName(stepName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setStreamId("security-stream-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setCurrentHopNumber(1) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ProcessConfigurationÂ configÂ =Â ProcessConfiguration.newBuilder().build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â returnÂ ProcessRequest.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setDocument(document) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setConfig(config) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMetadata(metadata) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â } Â Â Â Â privateÂ ProcessRequestÂ createEmbedderProcessRequest(StringÂ pipelineName,Â StringÂ stepName,Â PipeDocÂ document)Â { Â Â Â Â Â Â Â Â ServiceMetadataÂ metadataÂ =Â ServiceMetadata.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setPipelineName(pipelineName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setPipeStepName(stepName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setStreamId("security-stream-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setCurrentHopNumber(1) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â StructÂ embedderConfigÂ =Â Struct.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .putFields("embeddingModel",Â Value.newBuilder().setStringValue("ALL_MINILM_L6_V2").build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .putFields("fieldsToEmbed",Â Value.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setListValue(com.google.protobuf.ListValue.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .addValues(Value.newBuilder().setStringValue("title").build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .addValues(Value.newBuilder().setStringValue("body").build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ProcessConfigurationÂ configÂ =Â ProcessConfiguration.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setCustomJsonConfig(embedderConfig) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â returnÂ ProcessRequest.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setDocument(document) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setConfig(config) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMetadata(metadata) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â } Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ getClientForService(StringÂ serviceName)Â { Â Â Â Â Â Â Â Â switchÂ (serviceName)Â { Â Â Â Â Â Â Â Â Â Â Â Â caseÂ "tika":Â returnÂ tikaClient; Â Â Â Â Â Â Â Â Â Â Â Â caseÂ "chunker":Â returnÂ chunkerClient; Â Â Â Â Â Â Â Â Â Â Â Â caseÂ "embedder":Â returnÂ embedderClient; Â Â Â Â Â Â Â Â Â Â Â Â caseÂ "echo":Â returnÂ echoClient; Â Â Â Â Â Â Â Â Â Â Â Â default:Â throwÂ newÂ IllegalArgumentException("UnknownÂ service:Â "Â +Â serviceName); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â //Â InnerÂ classesÂ forÂ testÂ results Â Â Â Â privateÂ staticÂ classÂ BufferOverflowTestResultÂ { Â Â Â Â Â Â Â Â finalÂ StringÂ testDescription; Â Â Â Â Â Â Â Â finalÂ booleanÂ handledGracefully; Â Â Â Â Â Â Â Â finalÂ booleanÂ causedCrash; Â Â Â Â Â Â Â Â finalÂ longÂ responseTime; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â BufferOverflowTestResult(StringÂ testDescription,Â booleanÂ handledGracefully,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ causedCrash,Â longÂ responseTime)Â { Â Â Â Â Â Â Â Â Â Â Â Â this.testDescriptionÂ =Â testDescription; Â Â Â Â Â Â Â Â Â Â Â Â this.handledGracefullyÂ =Â handledGracefully; Â Â Â Â Â Â Â Â Â Â Â Â this.causedCrashÂ =Â causedCrash; Â Â Â Â Â Â Â Â Â Â Â Â this.responseTimeÂ =Â responseTime; Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ staticÂ classÂ DataIntegrityResultÂ { Â Â Â Â Â Â Â Â finalÂ booleanÂ integrityMaintained; Â Â Â Â Â Â Â Â finalÂ booleanÂ checksumValid; Â Â Â Â Â Â Â Â finalÂ booleanÂ dataCorrupted; Â Â Â Â Â Â Â Â finalÂ StringÂ inputHash; Â Â Â Â Â Â Â Â finalÂ StringÂ outputHash; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â DataIntegrityResult(booleanÂ integrityMaintained,Â booleanÂ checksumValid,Â booleanÂ dataCorrupted, Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ inputHash,Â StringÂ outputHash)Â { Â Â Â Â Â Â Â Â Â Â Â Â this.integrityMaintainedÂ =Â integrityMaintained; Â Â Â Â Â Â Â Â Â Â Â Â this.checksumValidÂ =Â checksumValid; Â Â Â Â Â Â Â Â Â Â Â Â this.dataCorruptedÂ =Â dataCorrupted; Â Â Â Â Â Â Â Â Â Â Â Â this.inputHashÂ =Â inputHash; Â Â Â Â Â Â Â Â Â Â Â Â this.outputHashÂ =Â outputHash; Â Â Â Â Â Â Â Â } Â Â Â Â } } //Â ENDÂ VARIATIONÂ 38 //Â TotalÂ size:Â 45299Â charactersbÊ

loc989
6
x_tika_encodingdetectorUniversalEncodingDetector
q
x_tika_parsed_by_full_setTRorg.apache.tika.parser.DefaultParser; org.apache.tika.parser.code.SourceCodeParser
$
content_typetext/x-java-source

content_encodingUTF-8
"
x_tika_detectedencodingUTF-8
>
resourcename.,source-code/SecurityIntegrationTests_v1.java
h
x_tika_parsed_byTRorg.apache.tika.parser.DefaultParser; org.apache.tika.parser.code.SourceCodeParserjùÄ
$68ca0ae8-c94f-452c-8813-05ce8713af99bodystandard_500_50*chunks_chunker_standard_500_502

?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_0È
îsource - code / SecurityIntegrationTests _ v 1. java source - code / SecurityIntegrationTests _ v 1. java // VARIATION 38 of Security Test Source (Variant 1) // Generated on: 2025 - 06 - 18 T 14: 38: 08. 460485142 Z // Base file: source - code / SecurityIntegrationTests. java package com. rokkon. integration. security; import com. google. protobuf. ByteString; import com. google. protobuf. Empty; import com. google. protobuf. Struct; import com. google. protobuf. Value; import com. rokkon.?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_0  (½:standard_500_50" 
average_word_length	O@aÃS@"$
potential_heading_score	        "
sentence_count	      5@"$
alphanumeric_percentage	•C‹lçç?"š
punctuation_countsƒ*€

(	      ð?

)	      ð?

:	      @

;	      @

-	      @

.	      5@

/	      "@

_	       @"!
uppercase_percentage	2U0*©°?""
whitespace_percentage	£#¹ü‡ôÃ?"
list_item_indicator  "

word_count	     €[@"$
average_sentence_length	Ýµ„|Ðó@"
vocabulary_density	ûËîÉÃÚ?"
digit_percentage	dÌ]KÈ­?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk "
character_count	     à~@"
relative_position	        2Ï	
?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_1Ë
ðcom. google. protobuf. Value; import com. rokkon. search. model. *; import com. rokkon. search. sdk. *; import io. grpc. ManagedChannel; import io. grpc. ManagedChannelBuilder; import io. grpc. Status; import io. grpc. StatusRuntimeException; import io. quarkus. test. junit. QuarkusIntegrationTest; import org. junit. jupiter. api. *; import org. slf 4 j. Logger; import org. slf 4 j. LoggerFactory; import java. nio. charset. StandardCharsets; import java. security. MessageDigest; import java.?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_1 ‘(Ø:standard_500_50" 
average_word_length	×òAÏf@"$
potential_heading_score	        "
sentence_count	     €B@"$
alphanumeric_percentage	46<½Rè?"H
punctuation_counts2*0

*	      @

;	      *@

.	     €B@"!
uppercase_percentage	à¾œ3¢¤?""
whitespace_percentage	(~Œ¹k	Á?"
list_item_indicator  "

word_count	     @]@"$
average_sentence_length	#J{ƒ/L	@"
vocabulary_density	6«>W[±Ó?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	F%uš‹?2”

?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_2Ï
ô; import java. security. MessageDigest; import java. util. *; import java. util. concurrent. TimeUnit; import java. util. regex. Pattern; import static org. junit. jupiter. api. Assertions. *; / ** * Comprehensive security integration tests to validate input validation, malicious content handling, * data integrity verification, and security boundaries across all services. * * These tests verify: * - Input validation and sanitization * - Malicious content detection and handling * - Data integrity?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_2 §(’
:standard_500_50" 
average_word_length	€H¿}x@"$
potential_heading_score	š™™™™™É?"
sentence_count	      1@"$
alphanumeric_percentage	øSã¥›Äè?"ˆ
punctuation_countsr*p

*	      &@

:	      ð?

;	      @

,	      @

-	      @

.	      0@

/	      ð?"!
uppercase_percentage	ºI+‡–?""
whitespace_percentage	;ßO—nÂ?"
list_item_indicator  "

word_count	     €X@"$
average_sentence_length	;M„@"
vocabulary_density	Ô+eâXß?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position		Šcîš?2¡

?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_3Ê
ïcontent detection and handling * - Data integrity verification and checksums * - Security boundary enforcement * - Buffer overflow and injection attack prevention * - Content filtering and blacklist enforcement * - Secure error handling without information leakage * - Authentication and authorization patterns * - Secure data transmission and storage * - Privacy and data protection compliance * / @ QuarkusIntegrationTest @ TestMethodOrder (MethodOrderer. OrderAnnotation. class) @ Disabled ("?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_3 á	(Ð:standard_500_50" 
average_word_length	®Ø_vO^@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	î|?5^ºé?"š
punctuation_countsƒ*€

@	      @

"	      ð?

(	       @

)	      ð?

*	      "@

-	       @

.	       @

/	      ð?"!
uppercase_percentage	a2U0*©£?""
whitespace_percentage	aÃÓ+eÂ?"
list_item_indicator  "

word_count	      S@"$
average_sentence_length	¾Á&SU9@"
vocabulary_density	µûËîÉã?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ð~@"
relative_position	ÓMbX9¤?2¥
?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_4Î
ó(MethodOrderer. OrderAnnotation. class) @ Disabled (" Requires full gRPC service infrastructure for comprehensive security testing against malicious inputs and attacks ") class SecurityIntegrationTests {private static final Logger LOG = LoggerFactory. getLogger (SecurityIntegrationTests. class); // Security test patterns private static final List < String > SQL _ INJECTION _ PATTERNS = Arrays. asList (" '; DROP TABLE users; -- ", " ' OR ' 1 ' = ' 1 ", " ' UNION SELECT * FROM sensitive _ data --?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_4  (Ÿ:standard_500_50" 
average_word_length	•eˆc]\@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	–C‹lçûç?"š
punctuation_countsƒ*€

@	      ð?

"	      @

'	      @

(	      @

)	      @

*	      ð?

,	       @

-	      @

.	      @

/	       @

{	      ð?

;	      @

<	      ð?

=	      @

>	      ð?

_	      @"!
uppercase_percentage	}Ð³Yõ¹Â?""
whitespace_percentage	Ä±.n£Ä?"
list_item_indicator  "

word_count	     @X@"$
average_sentence_length	B>èÙ¬*0@"
vocabulary_density	jMóŽStä?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position		Šcîª?2Ö
?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_5Ï
ô, " ' UNION SELECT * FROM sensitive _ data -- ", " admin ' -- ", " ' OR 1 = 1 # "); private static final List < String > XSS _ PATTERNS = Arrays. asList (" < script > alert (' XSS ') < / script > ", " javascript: alert (' XSS ') ", " < img src = x onerror = alert (' XSS ') > ", " < svg onload = alert (' XSS ') > ", " '; alert (' XSS '); // "); private static final List < String > COMMAND _ INJECTION _ PATTERNS = Arrays. asList ("; rm - rf / ", " | cat / etc / passwd ", " && whoami ", " ` rm - rf?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_5 î(‰:standard_500_50" 
average_word_length	š™™™™™@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	¢E¶óýÔà?"Ê
punctuation_counts³*°

`	      ð?

"	      7@

#	      ð?

&	       @

'	      ,@

(	      @

)	      @

*	      ð?

,	      $@

-	      @

.	       @

/	      @

:	      ð?

;	      @

<	      @

|	      ð?

=	      @

>	      @

_	      @"!
uppercase_percentage	333333Ã?""
whitespace_percentage	ü©ñÒMbÐ?"
list_item_indicator  "

word_count	      d@"$
average_sentence_length	ßà“©ªJ@"
vocabulary_density	âX·Ñ Ö?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	*©ÐDØ°?2´
?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_6Í
òetc / passwd ", " && whoami ", " ` rm - rf / ` ", " $ (cat / etc / passwd) "); private static final List < String > PATH _ TRAVERSAL _ PATTERNS = Arrays. asList (" .. / .. / .. / etc / passwd ", " .. \\ .. \\ .. \\ windows \\ system 32 \\ config \\ sam ", " .... // .... // .... // etc / passwd ", " % 2 e % 2 e % 2 f % 2 e % 2 e % 2 f % 2 e % 2 e % 2 fetc % 2 fpasswd ", " .. % 252 f .. % 252 f .. % 252 fetc % 252 fpasswd "); // Content security patterns private static final Pattern SUSPICIOUS _?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_6 Ø(¾:standard_500_50" 
average_word_length	¬Zd;@"$
potential_heading_score	        "
sentence_count	      ,@"$
alphanumeric_percentage	V-²ß?"ª
punctuation_counts“*

`	       @

"	      1@

$	      ð?

%	      ,@

&	       @

(	       @

)	      @

,	      @

-	      ð?

.	      ?@

/	      1@

;	       @

<	      ð?

\	      (@

=	      ð?

>	      ð?

_	      @"!
uppercase_percentage	¾Á&S³?""
whitespace_percentage	¶„|Ð³YÑ?"
list_item_indicator  "

word_count	     àb@"$
average_sentence_length	5ï8EG’%@"
vocabulary_density	{ƒ/L¦
Ö?"
digit_percentage	=›UŸ«­¨?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	Â†§WÊ2´?2Ù

?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_7Â
çprivate static final Pattern SUSPICIOUS _ PATTERN = Pattern. compile (" (? i) (password | secret | key | token | auth | admin | root | exploit | hack | inject | malware | virus) ", Pattern. CASE _ INSENSITIVE | Pattern. MULTILINE); private static final long MAX _ CONTENT _ SIZE = 100 * 1024 * 1024; // 100 MB private static final int MAX _ FIELD _ LENGTH = 10000; private ManagedChannel tikaChannel; private ManagedChannel chunkerChannel; private ManagedChannel embedderChannel; private?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_7 —(Š:standard_500_50" 
average_word_length	[Ó¼ã]@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	)ËÇº¸ç?"Ú
punctuation_countsÃ*À

"	       @

(	      @

)	      @

*	       @

;	      @

|	      (@

,	      ð?

=	      @

.	      @

_	      @

?	      ð?

/	       @"!
uppercase_percentage	®GázÆ?""
whitespace_percentage	<½R–!ŽÅ?"
list_item_indicator  "

word_count	     ÀX@"$
average_sentence_length	     À8@"
vocabulary_density	µ¦yÇ)à?"
digit_percentage	+‡ÙÎ÷£?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     p~@"
relative_position	k+ö—Ý“·?2¶

?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_8Ï
ôManagedChannel embedderChannel; private ManagedChannel echoChannel; private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub tikaClient; private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub chunkerClient; private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub embedderClient; private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub echoClient; @ BeforeEach void setUp () {// Set up gRPC channels for security testing tikaChannel = ManagedChannelBuilder. forAddress (" localhost?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_8 à(ü:standard_500_50" 
average_word_length	mçû©ñ!@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	ÓMbX9ì?"ª
punctuation_counts“*

@	      ð?

"	      ð?

(	       @

)	      ð?

;	      @

{	      ð?

=	      ð?

.	      @

/	       @"!
uppercase_percentage	V-²½?""
whitespace_percentage	+‡ÙÎ÷³?"
list_item_indicator  "

word_count	      K@"$
average_sentence_length	      "@"
vocabulary_density	<½R–!Žã?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	ÐDØðôº?2Œ

?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_9	Ç
ì= ManagedChannelBuilder. forAddress (" localhost ", 9000). usePlaintext (). build (); chunkerChannel = ManagedChannelBuilder. forAddress (" localhost ", 9001). usePlaintext (). build (); embedderChannel = ManagedChannelBuilder. forAddress (" localhost ", 9002). usePlaintext (). build (); echoChannel = ManagedChannelBuilder. forAddress (" localhost ", 9003). usePlaintext (). build (); tikaClient = PipeStepProcessorGrpc. newBlockingStub (tikaChannel); chunkerClient = PipeStepProcessorGrpc.?ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_9 Ð(Ê#:standard_500_50" 
average_word_length	     @@"$
potential_heading_score	        "
sentence_count	      ,@"$
alphanumeric_percentage	À[ Añcè?"ˆ
punctuation_countsr*p

"	       @

(	      *@

)	      *@

;	      @

,	      @

=	      @

.	      ,@"!
uppercase_percentage	46<½²?""
whitespace_percentage	ÎQÚ¼?"
list_item_indicator  "

word_count	      X@"$
average_sentence_length	=›UŸ«m@"
vocabulary_density	      Ð?"
digit_percentage	¤p=
×£ ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     À~@"
relative_position	¬­Ø_vO¾?2Ó

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_10
Ë
ï); chunkerClient = PipeStepProcessorGrpc. newBlockingStub (chunkerChannel); embedderClient = PipeStepProcessorGrpc. newBlockingStub (embedderChannel); echoClient = PipeStepProcessorGrpc. newBlockingStub (echoChannel); LOG. info (" Security integration test environment initialized ");} @ AfterEach void tearDown () throws InterruptedException {if (tikaChannel! = null) {tikaChannel. shutdown (); tikaChannel. awaitTermination (5, TimeUnit. SECONDS);} if (chunkerChannel! = null) {chunkerChannel.@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_10 š#(î':standard_500_50" 
average_word_length	Å °rhQ@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	D‹lçû©é?"Ê
punctuation_counts³*°

@	      ð?

!	       @

"	       @

(	      "@

)	      $@

;	      @

{	      @

,	      ð?

=	      @

}	       @

.	       @"!
uppercase_percentage	¢E¶óýÔ¸?""
whitespace_percentage	¢E¶óýÔ¸?"
list_item_indicator  "

word_count	      V@"$
average_sentence_length	      &@"
vocabulary_density	¯”eˆc]Ü?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ð~@"
relative_position	*©ÐDØÀ?2â

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_11Ê
î! = null) {chunkerChannel. shutdown (); chunkerChannel. awaitTermination (5, TimeUnit. SECONDS);} if (embedderChannel! = null) {embedderChannel. shutdown (); embedderChannel. awaitTermination (5, TimeUnit. SECONDS);} if (echoChannel! = null) {echoChannel. shutdown (); echoChannel. awaitTermination (5, TimeUnit. SECONDS);}} @ Test @ Order (1) @ DisplayName (" SQL Injection Attack Prevention ") void testSqlInjectionPrevention () {LOG. info (" Testing SQL injection attack prevention "); Map <@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_11 É'(¾,:standard_500_50" 
average_word_length	Y†8ÖÅí@"$
potential_heading_score	        "
sentence_count	      &@"$
alphanumeric_percentage	¡g³êsµç?"Ú
punctuation_countsÃ*À

@	      @

!	      @

"	      @

(	      (@

)	      *@

{	      @

;	      @

,	      @

<	      ð?

=	      @

}	      @

.	      $@"!
uppercase_percentage	Tt$—ÿ¾?""
whitespace_percentage	V-²¿?"
list_item_indicator  "

word_count	      \@"$
average_sentence_length	[Ó¼ã]$@"
vocabulary_density	Ð³Yõ¹ÚÖ?"
digit_percentage	‚âÇ˜»–€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	ö—Ý“‡…Â?2ý

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_12µ
Ùattack prevention "); Map < String, Integer > serviceVulnerabilities = new HashMap < > (); int totalInjectionAttempts = 0; int blockedAttempts = 0; for (String injectionPattern: SQL _ INJECTION _ PATTERNS) {totalInjectionAttempts ++; // Test each service with SQL injection patterns if (testServiceWithMaliciousInput (tikaClient, " tika ", injectionPattern, " SQL Injection " )) {blockedAttempts ++;} else {serviceVulnerabilities. merge (" tika ", 1, Integer :: sum);} if (@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_12 •,(Ž1:standard_500_50" 
average_word_length	Â&S#@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	:’ËH¿ç?"Š
punctuation_countsó*ð

"	      @

(	      @

)	      @

+	      @

,	      @

.	      ð?

/	       @

:	      @

;	      @

{	      @

<	       @

=	      @

}	       @

>	       @

_	       @"!
uppercase_percentage	Wì/»'»?""
whitespace_percentage	B`åÐ"ÛÁ?"
list_item_indicator  "

word_count	     ÀW@"$
average_sentence_length	     ÀG@"
vocabulary_density	ŒÛh oà?"
digit_percentage	 Òo_Îy?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     }@"
relative_position	Kê46Ä?2Å

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_13Í
ñsum);} if (testServiceWithMaliciousInput (chunkerClient, " chunker ", injectionPattern, " SQL Injection " )) {blockedAttempts ++;} else {serviceVulnerabilities. merge (" chunker ", 1, Integer :: sum);} if (testServiceWithMaliciousInput (embedderClient, " embedder ", injectionPattern, " SQL Injection " )) {blockedAttempts ++;} else {serviceVulnerabilities. merge (" embedder ", 1, Integer :: sum);} if (testServiceWithMaliciousInput (echoClient, " echo ", injectionPattern, " SQL Injection " )) {@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_13 Þ0(þ5:standard_500_50" 
average_word_length	+‡@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	9ÖÅm4€ç?"º
punctuation_counts£* 

"	      0@

(	       @

)	      "@

:	      @

;	      @

{	      @

+	      @

,	      *@

}	      @

.	       @"!
uppercase_percentage	û:pÎˆ²?""
whitespace_percentage	~8gDi¿?"
list_item_indicator  "

word_count	     €Y@"$
average_sentence_length	      A@"
vocabulary_density	à- ø1Ò?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	Ÿ<,ÔšæÅ?2§
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_14Ï
ó, " echo ", injectionPattern, " SQL Injection " )) {blockedAttempts ++;} else {serviceVulnerabilities. merge (" echo ", 1, Integer :: sum);} totalInjectionAttempts + = 3; // Added 3 more services} double blockingRate = (double) blockedAttempts / totalInjectionAttempts; // Verify SQL injection protection assertTrue (blockingRate > = 0. 90, String. format (" SQL injection blocking rate %. 2 f %% below minimum 90 %% ", blockingRate * 100 )); // Check for service - specific vulnerabilities for (Map@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_14 Ð5(Õ::standard_500_50" 
average_word_length	ú~j¼t@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	¾Á&Sç?"š
punctuation_countsƒ*€

"	       @

%	      @

(	      @

)	      @

*	      ð?

+	      @

,	      @

-	      ð?

.	      @

/	      @

:	       @

{	       @

;	      @

}	      @

=	      @

>	      ð?"!
uppercase_percentage	šwœ¢#¹¬?""
whitespace_percentage	ëâ6ÀÃ?"
list_item_indicator  "

word_count	     @Z@"$
average_sentence_length	      5@"
vocabulary_density	³êsµûá?"
digit_percentage	ú~j¼t“˜?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	k+ö—Ý“Ç?2™
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_15Ñ
õservice - specific vulnerabilities for (Map. Entry < String, Integer > entry: serviceVulnerabilities. entrySet ()) {String serviceName = entry. getKey (); Integer vulnerabilityCount = entry. getValue (); assertTrue (vulnerabilityCount < = 1, String. format (" % s service has % d SQL injection vulnerabilities ", serviceName, vulnerabilityCount ));} LOG. info (" âœ… SQL injection prevention test completed - Blocking rate: {:. 2 f} %, Vulnerabilities: {} ", blockingRate * 100, serviceVulnerabilities@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_15 ¥:(ò>:standard_500_50" 
average_word_length	)\Âõ¨@"$
potential_heading_score	š™™™™™É?"
sentence_count	       @"$
alphanumeric_percentage	B`åÐ"Ûç?"Š
punctuation_countsó*ð

"	      @

%	      @

(	      @

)	      @

*	      ð?

,	      @

-	       @

.	      @

:	      @

{	      @

;	      @

<	       @

=	      @

}	      @

>	      ð?"!
uppercase_percentage	Ú¬ú\mÅ®?""
whitespace_percentage	…|Ð³YõÁ?"
list_item_indicator  "

word_count	     ÀY@"$
average_sentence_length	     À)@"
vocabulary_density	Gx$(à?"
digit_percentage	{®Gáz„?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	¿}8gDÉ?2È
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_16Ð
ôblockingRate * 100, serviceVulnerabilities);} @ Test @ Order (2) @ DisplayName (" Cross - Site Scripting (XSS) Prevention ") void testXssPreventionAndSanitization () {LOG. info (" Testing XSS prevention and content sanitization "); int totalXssAttempts = 0; int sanitizedResponses = 0; List < String > unsanitizedResponses = new ArrayList < > (); for (String xssPattern: XSS _ PATTERNS) {totalXssAttempts ++; // Test XSS pattern handling in document content PipeDoc maliciousDoc = PipeDoc. newBuilder@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_16 É>(§C:standard_500_50" 
average_word_length	ßà“©‚@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	¨ÆK7‰Aè?"º
punctuation_counts£* 

@	      @

"	      @

(	      @

)	       @

*	      ð?

+	       @

,	      ð?

-	      ð?

.	       @

/	       @

:	      ð?

;	      @

{	       @

<	       @

}	      ð?

=	      @

>	       @

_	      ð?"!
uppercase_percentage	Év¾Ÿ/½?""
whitespace_percentage	“V-Â?"
list_item_indicator  "

word_count	     €X@"$
average_sentence_length	!ôlVU@@"
vocabulary_density	Çº¸ðâ?"
digit_percentage	ú~j¼t“ˆ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	‹lçû©ñÊ?2Ò

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_17Ê
îPipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" xss - test - " + System. currentTimeMillis ()). setTitle (" XSS Test: " + xssPattern). setBody (" Content with XSS attempt: " + xssPattern). build (); ProcessRequest request = createProcessRequest (" xss - security - test ", " echo - step ", maliciousDoc); try {ProcessResponse response = echoClient. processData (request); if (response. getSuccess ()) {String responseTitle = response. getOutputDoc (). getTitle (); String responseBody =@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_17 ÿB(§H:standard_500_50" 
average_word_length	®Ø_vOž@"$
potential_heading_score	        "
sentence_count	      &@"$
alphanumeric_percentage		Šcîæ?"Ê
punctuation_counts³*°

"	      $@

(	      (@

)	      (@

:	       @

+	      @

;	      @

{	       @

,	       @

=	      @

-	      @

.	      $@"!
uppercase_percentage	Â†§WÊ2´?""
whitespace_percentage	z¥,CëÂ?"
list_item_indicator  "

word_count	     €[@"$
average_sentence_length	      $@"
vocabulary_density	Ô+eâXÛ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	à¾œ3¢Ì?2ç

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_18Ï
ó(); String responseBody = response. getOutputDoc (). getBody (); // Check if XSS patterns were sanitized or escaped boolean titleSanitized =! responseTitle. contains (" < script > ") &&! responseTitle. contains (" javascript: ") &&! responseTitle. contains (" onerror = ") &&! responseTitle. contains (" onload = "); boolean bodySanitized =! responseBody. contains (" < script > ") &&! responseBody. contains (" javascript: ") &&! responseBody. contains (" onerror = ") &&! responseBody. contains ("@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_18 ûG(¿N:standard_500_50" 
average_word_length	¬­Ø_vO@"$
potential_heading_score	        "
sentence_count	      &@"$
alphanumeric_percentage	tµûËîå?"Ú
punctuation_countsÃ*À

!	       @

"	      .@

&	      (@

(	      &@

)	      $@

:	       @

;	      @

<	       @

=	      @

.	      $@

>	       @

/	       @"!
uppercase_percentage	ý‡ôÛ×£?""
whitespace_percentage	$—ÿ~ûÂ?"
list_item_indicator  "

word_count	      ]@"$
average_sentence_length	žï§ÆK%@"
vocabulary_density	RI€&ÂÒ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	¬­Ø_vOÎ?2—
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_19Ï
ó! responseBody. contains (" onload = "); if (titleSanitized && bodySanitized) {sanitizedResponses ++;} else {unsanitizedResponses. add (" Pattern: " + xssPattern + " - Title: " + responseTitle + " - Body: " + responseBody);}} else {// Service rejected malicious content - also counts as protection sanitizedResponses ++;}} catch (StatusRuntimeException e) {// Service blocked the request - this is good sanitizedResponses ++; LOG. debug (" XSS pattern blocked by service: {} ", xssPattern);}} double@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_19 ¨N(°U:standard_500_50" 
average_word_length	¶„|Ð³Ù@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	Àìž<,Ôæ?"Š
punctuation_countsó*ð

!	      ð?

"	      $@

&	       @

(	      @

)	      @

+	      &@

,	      ð?

-	      @

.	      @

/	      @

:	      @

;	      @

{	      @

=	      ð?

}	       @"!
uppercase_percentage	»'µ¦©?""
whitespace_percentage	}Ð³Yõ¹Â?"
list_item_indicator  "

word_count	     ÀZ@"$
average_sentence_length	     À:@"
vocabulary_density	«>W[±¿à?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	      Ð?2¦
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_20Î
ò);}} double sanitizationRate = (double) sanitizedResponses / totalXssAttempts; assertTrue (sanitizationRate > = 0. 95, String. format (" XSS sanitization rate %. 2 f %% below minimum 95 %% ", sanitizationRate * 100 )); assertTrue (unsanitizedResponses. size () < = 1, String. format (" Too many unsanitized XSS responses: % s ", unsanitizedResponses )); LOG. info (" âœ… XSS prevention test completed - Sanitization rate: {:. 2 f} %, Unsanitized: {} ", sanitizationRate * 100, unsanitizedResponses.@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_20 ÿT(ÖY:standard_500_50" 
average_word_length	~Œ¹k	ù@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	ºÚŠýe÷æ?"š
punctuation_countsƒ*€

"	      @

%	      @

(	      @

)	      @

*	       @

,	      @

-	      ð?

.	       @

/	      ð?

:	      @

;	      @

{	       @

<	      ð?

}	      @

=	      @

>	      ð?"!
uppercase_percentage	ÁÊ¡E¶ó­?""
whitespace_percentage	ðHPüÃ?"
list_item_indicator  "

word_count	     @[@"$
average_sentence_length	     @+@"
vocabulary_density	û:pÎˆÞ?"
digit_percentage	ÿ!ýöuàœ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	*©ÐDØÐ?2¶
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_21Î
òsanitizationRate * 100, unsanitizedResponses. size ());} @ Test @ Order (3) @ DisplayName (" Command Injection Attack Prevention ") void testCommandInjectionPrevention () {LOG. info (" Testing command injection attack prevention "); int totalCommandAttempts = 0; int blockedCommands = 0; Map < String, List < String >> serviceFailures = new HashMap < > (); for (String commandPattern: COMMAND _ INJECTION _ PATTERNS) {totalCommandAttempts ++; // Test command injection in document processing String@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_21 ªY(ƒ^:standard_500_50" 
average_word_length	÷_˜LÕ@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	)\Âõ(è?"ª
punctuation_counts“*

@	      @

"	      @

(	      @

)	       @

*	      ð?

+	       @

,	       @

.	       @

/	       @

:	      ð?

;	      @

{	       @

<	      @

}	      ð?

=	      @

>	      @

_	       @"!
uppercase_percentage	Zd;ßO½?""
whitespace_percentage	§èH.ÿÁ?"
list_item_indicator  "

word_count	      X@"$
average_sentence_length	      @@"
vocabulary_density	KÈ=›Uã?"
digit_percentage	ú~j¼t“ˆ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	 ø1æ®Ñ?2’
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_22Ê
îin document processing String maliciousContent = " Document content with command injection: " + commandPattern; // Test Tika service (most likely to execute commands on files) if (testTikaServiceWithMaliciousCommand (commandPattern )) {blockedCommands ++;} else {serviceFailures. computeIfAbsent (" tika ", k - > new ArrayList < > ()). add (commandPattern);} // Test other services for (String serviceName: Arrays. asList (" chunker ", " embedder ", " echo " )) {PipeDoc maliciousDoc = PipeDoc.@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_22 Û](Õb:standard_500_50" 
average_word_length	u“VN@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	õJY†8Öç?"Š
punctuation_countsó*ð

"	      $@

(	       @

)	       @

+	      @

,	      @

-	      ð?

.	      @

/	      @

:	       @

;	      @

{	      @

<	      ð?

=	       @

}	       @

>	       @"!
uppercase_percentage	çŒ(í®?""
whitespace_percentage	úíëÀ9#Â?"
list_item_indicator  "

word_count	     €X@"$
average_sentence_length	     €8@"
vocabulary_density	óŽSt$—ã?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	ºI+‡Ò?2È

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_23Ð
ô{PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" cmd - injection - " + System. currentTimeMillis ()). setTitle (" Command injection test "). setBody (maliciousContent). build (); ProcessRequest request = createProcessRequest (" command - injection - test ", serviceName + " - step ", maliciousDoc); try {PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client = getClientForService (serviceName); if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" command@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_23 ¥b(ëg:standard_500_50" 
average_word_length	ffffff@"$
potential_heading_score	š™™™™™É?"
sentence_count	      "@"$
alphanumeric_percentage	þÔxé&1è?"º
punctuation_counts£* 

"	      &@

(	      &@

)	      $@

{	      @

+	       @

;	      @

,	       @

=	      @

-	      @

.	       @"!
uppercase_percentage	‹lçû©ñ²?""
whitespace_percentage	Tã¥›Ä À?"
list_item_indicator  "

word_count	     ÀW@"$
average_sentence_length	±Pkšw%@"
vocabulary_density	OjMóÚ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	 AñcÌ]Ó?2…
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_24Í
ñrequest = createEmbedderProcessRequest (" command - injection - test ", serviceName + " - step ", maliciousDoc);} ProcessResponse response = client. processData (request); // Verify no command execution artifacts in response if (response. getSuccess ()) {String responseContent = response. getOutputDoc (). getBody (); // Check for signs of command execution boolean hasExecutionArtifacts = responseContent. contains (" root: ") || // passwd file responseContent. contains (" uid = ") || // whoami@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_24 ½g(¨m:standard_500_50" 
average_word_length	ëâ6À›@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	6«>W[±ç?"ú
punctuation_countsã*à

"	       @

(	       @

)	       @

+	      ð?

,	       @

-	      @

.	      @

/	       @

:	      ð?

;	      @

{	      ð?

|	      @

=	      @

}	      ð?"!
uppercase_percentage	¾0™*•¤?""
whitespace_percentage	/n£¼Â?"
list_item_indicator  "

word_count	     @X@"$
average_sentence_length	ŸÍªÏÕ¶+@"
vocabulary_density	åÐ"Ûù~à?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	Kê46Ô?2œ
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_25Ä
èresponseContent. contains (" uid = ") || // whoami output responseContent. contains (" / bin / ") || // system paths responseContent. contains (" administrator "); // windows user if (! hasExecutionArtifacts) {blockedCommands ++;} else {serviceFailures. computeIfAbsent (serviceName, k - > new ArrayList < > ()). add (commandPattern);}} else {// Service rejected malicious content blockedCommands ++;}} catch (StatusRuntimeException e) {// Service blocked the request blockedCommands ++;}@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_25 ùl(Žt:standard_500_50" 
average_word_length	z6«>@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	†ZÓ¼ãç?"š
punctuation_countsƒ*€

!	      ð?

"	      @

(	       @

)	       @

+	      @

,	      ð?

-	      ð?

.	      @

/	      (@

;	      @

{	      @

|	      @

<	      ð?

=	      ð?

}	      @

>	       @"!
uppercase_percentage	Ë¡E¶óý¤?""
whitespace_percentage	±áé•²Á?"
list_item_indicator  "

word_count	     ÀX@"$
average_sentence_length	     €0@"
vocabulary_density	s×òAÏà?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     €~@"
relative_position	±áé•²Õ?2¤
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_26Ì
ðblockedCommands ++;} totalCommandAttempts ++;}} double commandBlockingRate = (double) blockedCommands / totalCommandAttempts; assertTrue (commandBlockingRate > = 0. 90, String. format (" Command injection blocking rate %. 2 f %% below minimum 90 %% ", commandBlockingRate * 100 )); // Verify no service had multiple command injection vulnerabilities for (Map. Entry < String, List < String >> entry: serviceFailures. entrySet ()) {String serviceName = entry. getKey (); List < String > failures =@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_26 ës(éx:standard_500_50" 
average_word_length	     À@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	+‡ÙÎç?"š
punctuation_countsƒ*€

"	       @

%	      @

(	      @

)	      @

*	      ð?

+	      @

,	      @

.	      @

/	      @

:	      ð?

;	      @

{	      ð?

<	      @

}	      @

=	      @

>	      @"!
uppercase_percentage	!°rh‘í¬?""
whitespace_percentage	È˜»–Â?"
list_item_indicator  "

word_count	      X@"$
average_sentence_length	ËÇº¸m+@"
vocabulary_density	µ7øÂdªâ?"
digit_percentage	û:pÎˆ’?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	ÛŠýe÷äÕ?2¥
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_27Í
ñ. getKey (); List < String > failures = entry. getValue (); assertTrue (failures. size () < = 1, String. format (" % s service vulnerable to command injection: % s ", serviceName, failures ));} LOG. info (" âœ… Command injection prevention test completed - Blocking rate: {:. 2 f} %, Failures: {} ", commandBlockingRate * 100, serviceFailures);} @ Test @ Order (4) @ DisplayName (" Path Traversal Attack Prevention ") void testPathTraversalPrevention () {LOG. info (" Testing path traversal attack@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_27 ¼x(…}:standard_500_50" 
average_word_length	. ø1æ@"$
potential_heading_score	š™™™™™É?"
sentence_count	       @"$
alphanumeric_percentage	;ßO—næ?"š
punctuation_countsƒ*€

@	      @

"	      @

%	      @

(	      $@

)	      "@

*	      ð?

,	      @

-	      ð?

.	      @

:	      @

;	      @

{	      @

<	       @

=	       @

}	      @

>	      ð?"!
uppercase_percentage	Çº¸°?""
whitespace_percentage	M„O¯Ä?"
list_item_indicator  "

word_count	     À]@"$
average_sentence_length	     À-@"
vocabulary_density	©ÐDØðà?"
digit_percentage	€·@‚âÇˆ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ð~@"
relative_position	46<½Ö?2“
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_28Ë
î{LOG. info (" Testing path traversal attack prevention "); int totalTraversalAttempts = 0; int blockedTraversals = 0; List < String > vulnerableResponses = new ArrayList < > (); for (String traversalPattern: PATH _ TRAVERSAL _ PATTERNS) {totalTraversalAttempts ++; // Test path traversal in filename (Tika service most vulnerable) byte [] dummyContent = " Dummy file content for path traversal test ". getBytes (StandardCharsets. UTF _ 8); Blob maliciousBlob = Blob. newBuilder (). setBlobId ("@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_28 Õ|(Ã:standard_500_50" 
average_word_length	×£p=
×@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	Õxé&1è?"Š
punctuation_countsó*ð

"	      @

(	      @

)	      @

+	       @

.	      @

/	       @

:	      ð?

{	       @

;	      @

[	      ð?

<	       @

=	      @

]	      ð?

>	       @

_	      @"!
uppercase_percentage	d]ÜFx»?""
whitespace_percentage	z¥,CëÂ?"
list_item_indicator  "

word_count	      Y@"$
average_sentence_length	B>èÙ¬ª0@"
vocabulary_density	=
×£p=â?"
digit_percentage	ðHPüx?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	k+ö—Ý“×?2Ú

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_29Ò
ôBlob. newBuilder (). setBlobId (" traversal - test - " + System. currentTimeMillis ()). setFilename (traversalPattern) // Malicious filename. setData (ByteString. copyFrom (dummyContent )). setMimeType (" text / plain "). build (); PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" path - traversal - test "). setTitle (" Path traversal test "). setBlob (maliciousBlob). build (); ProcessRequest request = createProcessRequest (" path - traversal - test ", " tika - step ", maliciousDoc); try {@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_29 ’(Ö†:standard_500_50" 
average_word_length	ð…ÉTÁ(@"$
potential_heading_score	        "
sentence_count	      ,@"$
alphanumeric_percentage	-²ï§æ?"Ê
punctuation_counts³*°

"	      (@

(	      ,@

)	      ,@

+	      ð?

;	      @

{	      ð?

,	       @

-	      @

=	       @

.	      *@

/	      @"!
uppercase_percentage	L7‰A`å°?""
whitespace_percentage	‹lçû©ñÂ?"
list_item_indicator  "

word_count	     @\@"$
average_sentence_length	jÞqŠŽ$ @"
vocabulary_density	çŒ(íÚ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	•Ô	h"lØ?2ù

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_30Ñ
ó", maliciousDoc); try {ProcessResponse response = tikaClient. processData (request); if (response. getSuccess ()) {String responseBody = response. getOutputDoc (). getBody (); // Check for signs of successful path traversal boolean hasSystemFiles = responseBody. contains (" root: x: 0: 0: root ") || // passwd file content responseBody. contains (" [HKEY _ LOCAL _ MACHINE ") || // registry content responseBody. contains (" Administrator ") || // windows admin responseBody. contains (" daemon: x:@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_30 §†(œŒ:standard_500_50" 
average_word_length	Å1w-¡@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	¥½Á&ç?"ê
punctuation_countsÓ*Ð

"	       @

(	      "@

)	      "@

,	      ð?

.	       @

/	       @

:	      @

;	      @

{	       @

[	      ð?

|	      @

=	      @

_	       @"!
uppercase_percentage	üs×ò±?""
whitespace_percentage	Õ	h"lxÂ?"
list_item_indicator  "

word_count	      [@"$
average_sentence_length	      (@"
vocabulary_density	ñôJY†8Þ?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	ûËîÉÃBÙ?2ë

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_31Ã
åresponseBody. contains (" daemon: x: "); // more passwd content if (! hasSystemFiles) {blockedTraversals ++;} else {vulnerableResponses. add (" Pattern: " + traversalPattern + " exposed system files ");}} else {// Service rejected malicious filename blockedTraversals ++;}} catch (StatusRuntimeException e) {// Service blocked the request blockedTraversals ++; LOG. debug (" Path traversal blocked: {} ", traversalPattern);}} double traversalBlockingRate = (double) blockedTraversals /@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_31 ý‹( ’:standard_500_50" 
average_word_length	².n£|@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	þCúíëÀç?"ê
punctuation_countsÓ*Ð

!	      ð?

"	       @

(	      @

)	      @

+	       @

,	      ð?

.	      @

/	      @

:	      @

;	      @

{	      @

}	       @

=	      ð?"!
uppercase_percentage	‘z6«>§?""
whitespace_percentage	Cëâ6À?"
list_item_indicator  "

word_count	     @X@"$
average_sentence_length	     @8@"
vocabulary_density	åÐ"Ûù~à?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     P~@"
relative_position	%ušÚ?2«
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_32 Ó
õ= (double) blockedTraversals / totalTraversalAttempts; assertTrue (traversalBlockingRate > = 0. 95, String. format (" Path traversal blocking rate %. 2 f %% below minimum 95 %% ", traversalBlockingRate * 100 )); assertTrue (vulnerableResponses. isEmpty (), String. format (" Path traversal vulnerabilities detected: % s ", vulnerableResponses )); LOG. info (" âœ… Path traversal prevention test completed - Blocking rate: {:. 2 f} % ", traversalBlockingRate * 100);} @ Test @ Order (5) @ DisplayName (@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_32 ƒ’(Ã–:standard_500_50" 
average_word_length	-²ï§Æ@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	žï§ÆK7ç?"š
punctuation_countsƒ*€

@	      @

"	      @

%	      @

(	      "@

)	       @

*	       @

,	      @

-	      ð?

.	      @

/	      ð?

:	      @

;	      @

{	      ð?

=	       @

}	       @

>	      ð?"!
uppercase_percentage	û\mÅþ²«?""
whitespace_percentage	$—ÿ~ûÂ?"
list_item_indicator  "

word_count	     ÀZ@"$
average_sentence_length	     À*@"
vocabulary_density	´Èv¾Ÿß?"
digit_percentage	¼?Æœ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	OjMóÚ?2
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_33!É
ë);} @ Test @ Order (5) @ DisplayName (" Buffer Overflow and Large Input Handling ") void testBufferOverflowPrevention () {LOG. info (" Testing buffer overflow prevention and large input handling "); List < BufferOverflowTestResult > testResults = new ArrayList < > (); // Test various buffer overflow scenarios testResults. add (testLargeContentHandling (" echo ", 1024 * 1024 )); // 1 MB testResults. add (testLargeContentHandling (" echo ", 10 * 1024 * 1024 )); // 10 MB testResults. add (@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_33 ’–(·š:standard_500_50" 
average_word_length	i oÅ@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	‰A`åÐ"ç?"ú
punctuation_countsã*à

@	      @

"	       @

(	      $@

)	      $@

*	      @

,	       @

.	      @

/	      @

;	      @

{	      ð?

<	       @

}	      ð?

=	      ð?

>	       @"!
uppercase_percentage	ÆÜµ„|Ð³?""
whitespace_percentage	ŸÍªÏÕVÄ?"
list_item_indicator  "

word_count	      Z@"$
average_sentence_length	ÍÌÌÌÌÌ4@"
vocabulary_density	Ú¬ú\mÅÞ?"
digit_percentage	Çº¸ð¦?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     °~@"
relative_position	µûËîÉÛ?2Ö

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_34"Î
ð* 1024 * 1024 )); // 10 MB testResults. add (testLargeContentHandling (" chunker ", 5 * 1024 * 1024 )); // 5 MB testResults. add (testExtremelyLongFieldHandling ()); testResults. add (testMaliciousBinaryContentHandling ()); testResults. add (testDeeplyNestedStructureHandling ()); // Verify all buffer overflow tests passed for (BufferOverflowTestResult result: testResults) {assertTrue (result. handledGracefully, String. format (" Buffer overflow test failed: % s ", result. testDescription ));@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_34 ‡š(³ž:standard_500_50" 
average_word_length	Ù=yX¨µ@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	46<½Rè?"Ê
punctuation_counts³*°

"	      @

%	      ð?

(	      &@

)	      *@

*	      @

:	       @

;	      @

{	      ð?

,	      @

.	      @

/	      @"!
uppercase_percentage	ð§ÆK7‰±?""
whitespace_percentage	°rh‘í|¿?"
list_item_indicator "

word_count	     @W@"$
average_sentence_length	     @'@"
vocabulary_density	œ3¢´7Ü?"
digit_percentage	à¾œ3¢¤?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	à¾œ3¢Ü?2‡
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_35#Ï
ñtest failed: % s ", result. testDescription )); assertFalse (result. causedCrash, String. format (" Service crashed during test: % s ", result. testDescription )); assertTrue (result. responseTime < 60000, // Max 1 minute String. format (" Test took too long (% dms): % s ", result. responseTime, result. testDescription ));} LOG. info (" âœ… Buffer overflow prevention test completed - All {} tests passed ", testResults. size ());} @ Test @ Order (6) @ DisplayName (" Data Integrity and Checksum@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_35 ‰ž(Ñ¢:standard_500_50" 
average_word_length	ŒJê4@"$
potential_heading_score	š™™™™™É?"
sentence_count	      &@"$
alphanumeric_percentage	qà-æ?"ú
punctuation_countsã*à

@	      @

"	       @

%	      @

(	      "@

)	      $@

,	      @

-	      ð?

.	      $@

/	       @

:	      @

;	      @

{	      ð?

<	      ð?

}	      @"!
uppercase_percentage	áz®Gáª?""
whitespace_percentage	Y†8ÖÅmÄ?"
list_item_indicator  "

word_count	     €]@"$
average_sentence_length	øÂdª`t%@"
vocabulary_density	z¥,CëÞ?"
digit_percentage	ÿ!ýöuàŒ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ð~@"
relative_position	F¶óýÔxÝ?2Ý

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_36$Å
ç(6) @ DisplayName (" Data Integrity and Checksum Verification ") void testDataIntegrityVerification () throws Exception {LOG. info (" Testing data integrity and checksum verification "); Map < String, DataIntegrityResult > integrityResults = new HashMap < > (); // Test data integrity across all services integrityResults. put (" TikaParser ", testServiceDataIntegrity (tikaClient, " tika " )); integrityResults. put (" Chunker ", testServiceDataIntegrity (chunkerClient, " chunker " ));@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_36 ¡¢(«¦:standard_500_50" 
average_word_length	±áé•²Œ@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	8øÂdª`è?"Ú
punctuation_countsÃ*À

@	      ð?

"	      (@

(	      "@

)	      "@

{	      ð?

;	      @

<	       @

,	      @

=	      ð?

.	      @

>	       @

/	       @"!
uppercase_percentage	z¥,Cë²?""
whitespace_percentage	J+‡Á?"
list_item_indicator  "

word_count	     ÀV@"$
average_sentence_length	     À6@"
vocabulary_density	¬Zd;á?"
digit_percentage	ŒJê4a?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     p~@"
relative_position	p_ÎQÞ?2ø

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_37%Ð
ò(chunkerClient, " chunker " )); integrityResults. put (" Embedder ", testServiceDataIntegrity (embedderClient, " embedder " )); integrityResults. put (" Echo ", testServiceDataIntegrity (echoClient, " echo " )); // Verify data integrity for all services for (Map. Entry < String, DataIntegrityResult > entry: integrityResults. entrySet ()) {String serviceName = entry. getKey (); DataIntegrityResult result = entry. getValue (); assertTrue (result. integrityMaintained, String. format (" % s failed@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_37 ¦(Ëª:standard_500_50" 
average_word_length	‘z6«~@"$
potential_heading_score	š™™™™™É?"
sentence_count	      "@"$
alphanumeric_percentage	•C‹lçç?"ê
punctuation_countsÓ*Ð

"	      &@

%	      ð?

(	      &@

)	      $@

,	      @

.	       @

/	       @

:	      ð?

;	      @

{	      ð?

<	      ð?

=	       @

>	      ð?"!
uppercase_percentage	.ÿ!ýöu°?""
whitespace_percentage	NbX9´À?"
list_item_indicator  "

word_count	     ÀX@"$
average_sentence_length	      &@"
vocabulary_density	².n£¼Ý?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	ÖVì/»'ß?2î

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_38&Ö
ø, String. format (" % s failed to maintain data integrity ", serviceName )); assertTrue (result. checksumValid, String. format (" % s failed checksum validation ", serviceName )); assertFalse (result. dataCorrupted, String. format (" % s corrupted data during processing ", serviceName )); LOG. info (" âœ… {} data integrity verified - Input hash: {}, Output hash: {} ", serviceName, result. inputHash, result. outputHash);} LOG. info (" âœ… Data integrity verification test completed ");} @ Test @ Order@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_38 ¡ª(¬¯:standard_500_50" 
average_word_length	ÎªÏÕVì@"$
potential_heading_score	š™™™™™É?"
sentence_count	      $@"$
alphanumeric_percentage	bX9´Èæ?"Ú
punctuation_countsÃ*À

@	       @

"	      $@

%	      @

(	      @

)	       @

:	       @

;	      @

{	      @

,	      $@

}	      @

-	      ð?

.	      "@"!
uppercase_percentage	ú~j¼t“¨?""
whitespace_percentage	ƒÀÊ¡E¶Ã?"
list_item_indicator  "

word_count	     @]@"$
average_sentence_length	ffffff'@"
vocabulary_density	¡g³êsµÙ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	      à?2ú

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_39'Ò
ôtest completed ");} @ Test @ Order (7) @ DisplayName (" Secure Error Handling and Information Leakage Prevention ") void testSecureErrorHandling () {LOG. info (" Testing secure error handling and information leakage prevention "); List < String > informationLeaks = new ArrayList < > (); int totalErrorTests = 0; int secureErrorResponses = 0; // Test various error conditions that might leak sensitive information List < String > errorInducingInputs = Arrays. asList ("", // Empty input null, // Null@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_39 ¯(Î³:standard_500_50" 
average_word_length	z6«>@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	V-²ïç?"ê
punctuation_countsÓ*Ð

@	      @

"	      @

(	      @

)	      @

,	       @

.	       @

/	      @

;	      @

{	      ð?

<	      @

}	      ð?

=	      @

>	      @"!
uppercase_percentage	ìQ¸…ë±?""
whitespace_percentage	ƒÀÊ¡E¶Ã?"
list_item_indicator  "

word_count	     ÀX@"$
average_sentence_length	     €@@"
vocabulary_density	aÃÓ+eã?"
digit_percentage	ú~j¼t“x?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	•Ô	h"là?2¹
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_40(Ñ
ó"", // Empty input null, // Null handling (will be converted to empty) " a ". repeat (MAX _ FIELD _ LENGTH + 1), // Too long input " \ u 0000 \ u 0001 \ u 0002 ", // Binary / control characters " {' malformed ': json} ", // Malformed JSON - like content " ? ? ? ? ? ? ". repeat (1000) // Unicode stress test); for (String serviceName: Arrays. asList (" tika ", " chunker ", " embedder ", " echo " )) {for (String errorInput: errorInducingInputs) {totalErrorTests ++; try {PipeDoc errorDoc = PipeDoc.@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_40 ¢³(’¸:standard_500_50" 
average_word_length	¯%äƒžM@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	øÂdª`Tä?"ª
punctuation_counts“*

"	      2@

'	       @

(	      @

)	      @

+	      @

,	       @

-	      ð?

.	      @

/	      *@

:	      @

{	      @

;	       @

\	      @

}	      ð?

=	      ð?

_	       @

?	      @"!
uppercase_percentage	MŒJê´?""
whitespace_percentage	kšwœ¢#É?"
list_item_indicator  "

word_count	     €`@"$
average_sentence_length	     €@@"
vocabulary_density	¼–z6á?"
digit_percentage	½R–!Žu¡?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	HPüs×à?2ù

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_41)Á
ã{PipeDoc errorDoc = PipeDoc. newBuilder (). setId (" error - test - " + System. currentTimeMillis ()). setTitle (errorInput! = null? errorInput: ""). setBody (errorInput! = null? errorInput: ""). build (); ProcessRequest request; if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" error - handling - test ", serviceName + " - step ", errorDoc);} else {request = createProcessRequest (" error - handling - test ", serviceName + " - step ", errorDoc);}@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_41 â·(À½:standard_500_50" 
average_word_length	ÁÊ¡E¶s@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	’\þCúíå?"ú
punctuation_countsã*à

!	       @

"	      0@

(	      $@

)	      $@

+	      @

,	      @

-	       @

.	      @

:	       @

{	      @

;	      @

=	      @

}	       @

?	       @"!
uppercase_percentage	V-²­?""
whitespace_percentage	@¤ß¾œÃ?"
list_item_indicator  "

word_count	     À\@"$
average_sentence_length	     À,@"
vocabulary_density	ŠcîZBÖ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0~@"
relative_position	Ý$•Cá?2ø

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_42*À
â+ " - step ", errorDoc);} PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client = getClientForService (serviceName); ProcessResponse response = client. processData (request); // Check for information leakage in response String responseText = response. toString (); if (containsSensitiveInformation (responseText )) {informationLeaks. add (String. format (" % s service leaked information with input: % s ", serviceName, errorInput ));} else {secureErrorResponses ++;}} catch (@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_42 –½(×Ã:standard_500_50" 
average_word_length	Å °rhQ@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	ûËîÉÃè?"ú
punctuation_countsã*à

"	      @

%	       @

(	       @

)	       @

+	      @

,	      @

-	      ð?

.	      @

/	       @

:	      ð?

;	      @

{	       @

}	      @

=	      @"!
uppercase_percentage	›UŸ«­Ø¯?""
whitespace_percentage	›æ§èH¾?"
list_item_indicator "

word_count	      V@"$
average_sentence_length	…|Ð³YU-@"
vocabulary_density	XÊ2Ä±.â?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      ~@"
relative_position	 ø1æ®á?2õ

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_43+Í
ï}} catch (StatusRuntimeException e) {// Check error message for information leakage String errorMessage = e. getMessage (); if (containsSensitiveInformation (errorMessage )) {informationLeaks. add (String. format (" % s service error leaked information: % s ", serviceName, errorMessage ));} else {secureErrorResponses ++;}} catch (Exception e) {// Other exceptions should also be checked if (containsSensitiveInformation (e. getMessage ())) {informationLeaks. add (String. format (" % s service@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_43 ¨Ã(áÉ:standard_500_50" 
average_word_length	ÆÜµ„|Ð@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	 cîZB>è?"ê
punctuation_countsÓ*Ð

"	      @

%	      @

(	      (@

)	      $@

+	       @

,	       @

.	      @

/	      @

:	      ð?

{	      @

;	      @

}	      @

=	      ð?"!
uppercase_percentage	+‡ÙÎ§?""
whitespace_percentage	AñcÌ]KÀ?"
list_item_indicator  "

word_count	     @X@"$
average_sentence_length	ŸÍªÏÕ¶+@"
vocabulary_density	EØðôJYÞ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ð~@"
relative_position	%ušâ?2©
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_44,Ñ
óinformationLeaks. add (String. format (" % s service exception leaked information: % s ", serviceName, e. getMessage ()));} else {secureErrorResponses ++;}}}} double secureErrorRate = (double) secureErrorResponses / totalErrorTests; assertTrue (secureErrorRate > = 0. 90, String. format (" Secure error handling rate %. 2 f %% below minimum 90 %% ", secureErrorRate * 100 )); assertTrue (informationLeaks. size () < = 2, String. format (" Too many information leaks detected: % s ", informationLeaks@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_44 ´É(øÎ:standard_500_50" 
average_word_length	>èÙ¬ú@"$
potential_heading_score	š™™™™™É?"
sentence_count	      "@"$
alphanumeric_percentage	žï§ÆK7ç?"š
punctuation_countsƒ*€

"	      @

%	       @

(	      "@

)	      @

*	      ð?

+	       @

,	      @

.	       @

/	      ð?

:	       @

;	      @

{	      ð?

<	      ð?

}	      @

=	      @

>	      ð?"!
uppercase_percentage	à- ¨?""
whitespace_percentage	Õ	h"lxÂ?"
list_item_indicator  "

word_count	     €Z@"$
average_sentence_length	X¨5Í;Ž'@"
vocabulary_density	£’:Mà?"
digit_percentage	{®Gáz”?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	ØðôJY†â?2›
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_45-Ó
õinformation leaks detected: % s ", informationLeaks )); LOG. info (" âœ… Secure error handling test completed - Secure rate: {:. 2 f} %, Leaks: {} ", secureErrorRate * 100, informationLeaks. size ());} // Helper Methods private boolean testServiceWithMaliciousInput (PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client, String serviceName, String maliciousInput, String attackType) {try {PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" security - test - " + System. currentTimeMillis (@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_45 ÈÎ(±Ó:standard_500_50" 
average_word_length	„O¯”å@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	çû©ñÒMè?"Š
punctuation_countsó*ð

"	      @

%	       @

(	      @

)	      @

*	      ð?

+	      ð?

,	      @

-	      @

.	      @

/	       @

:	      @

;	       @

{	      @

}	      @

=	      ð?"!
uppercase_percentage	ì/»'µ?""
whitespace_percentage	=›UŸ«­À?"
list_item_indicator  "

word_count	     @X@"$
average_sentence_length	     @(@"
vocabulary_density	·bÙ=yâ?"
digit_percentage	ü©ñÒMb€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	mÅþ²{òâ?2ã

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_46.Ë
ísetId (" security - test - " + System. currentTimeMillis ()). setTitle (attackType + " test: " + maliciousInput). setBody (" Content with " + attackType + ": " + maliciousInput). build (); ProcessRequest request; if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" security - test ", serviceName + " - step ", maliciousDoc);} else {request = createProcessRequest (" security - test ", serviceName + " - step ", maliciousDoc);} ProcessResponse response = client.@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_46 €Ó(Ø:standard_500_50" 
average_word_length	O@aÃS@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	øÂdª`Tæ?"Ú
punctuation_countsÃ*À

"	      2@

(	      "@

)	      "@

:	       @

+	       @

;	      @

{	       @

,	      @

-	      @

=	      @

}	       @

.	      @"!
uppercase_percentage	…|Ð³Yõ©?""
whitespace_percentage	”‡…ZÓ¼Ã?"
list_item_indicator  "

word_count	     €[@"$
average_sentence_length	¾Á&SU2@"
vocabulary_density	ã¥›Ä °Ö?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     Ð~@"
relative_position	šž^ã?2ç

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_47/Ï
ñProcessResponse response = client. processData (request); // Check if malicious input was sanitized or blocked if (response. getSuccess ()) {String responseContent = response. getOutputDoc (). getBody (); // If the malicious input appears unchanged, it wasn ' t blocked return! responseContent. contains (maliciousInput);} else {// Service rejected the request - good security behavior return true;}} catch (StatusRuntimeException e) {// Service blocked the request - good security behavior return@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_47 à×(•Ý:standard_500_50" 
average_word_length	?5^ºIL@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	Ð³Yõ¹Úè?"Ú
punctuation_countsÃ*À

!	      ð?

'	      ð?

(	      @

)	      @

;	      @

{	      @

,	      ð?

=	       @

}	      @

-	       @

.	      @

/	       @"!
uppercase_percentage	û:pÎˆ¢?""
whitespace_percentage	7À[ AÁ?"
list_item_indicator  "

word_count	     €W@"$
average_sentence_length	…|Ð³YU/@"
vocabulary_density	Ýµ„|Ð³á?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	µûËîÉã?2©
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_480Ñ
ó- good security behavior return true;} catch (Exception e) {LOG. debug (" Service {} failed with malicious input {}: {} ", serviceName, maliciousInput, e. getMessage ()); return false;}} private boolean testTikaServiceWithMaliciousCommand (String commandPattern) {try {// Create a document with command injection in filename and content String maliciousContent = " Document content " + commandPattern; byte [] contentBytes = maliciousContent. getBytes (StandardCharsets. UTF _ 8); Blob maliciousBlob@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_48 ëÜ(Öá:standard_500_50" 
average_word_length	÷_˜L@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	—nƒÀè?"š
punctuation_countsƒ*€

"	      @

(	      @

)	      @

+	      ð?

,	      @

-	      ð?

.	      @

/	       @

:	      ð?

;	      @

{	      @

[	      ð?

}	      @

=	       @

]	      ð?

_	      ð?"!
uppercase_percentage	Ú¬ú\mÅ®?""
whitespace_percentage	=›UŸ«­À?"
list_item_indicator "

word_count	      X@"$
average_sentence_length	3333333@"
vocabulary_density	µ7øÂdªä?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	Kê46ä?2Ö

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_491Î
ð_ 8); Blob maliciousBlob = Blob. newBuilder (). setBlobId (" cmd - injection - " + System. currentTimeMillis ()). setFilename (" test " + commandPattern + ". txt "). setData (ByteString. copyFrom (contentBytes )). setMimeType (" text / plain "). build (); PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" cmd - injection - test "). setTitle (" Command injection test "). setBlob (maliciousBlob). build (); ProcessRequest request = createProcessRequest (" cmd - injection - test ", " tika -@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_49 §á(äæ:standard_500_50" 
average_word_length	Ú¬ú\mE@"$
potential_heading_score	        "
sentence_count	      .@"$
alphanumeric_percentage	      æ?"Ê
punctuation_counts³*°

"	      .@

(	      ,@

)	      ,@

;	      @

+	      @

,	      ð?

=	      @

-	      @

.	      ,@

_	      ð?

/	      ð?"!
uppercase_percentage	 /Ý$±?""
whitespace_percentage	À[ AñcÄ?"
list_item_indicator  "

word_count	     €]@"$
average_sentence_length	ÖÅm4€w@"
vocabulary_density	Ãdª`TR×?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	þe÷äa¡ä?2‰
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_502Ñ
ócreateProcessRequest (" cmd - injection - test ", " tika - step ", maliciousDoc); ProcessResponse response = tikaClient. processData (request); if (response. getSuccess ()) {String responseContent = response. getOutputDoc (). getBody (); // Check for signs of command execution return! responseContent. contains (" root: ") &&! responseContent. contains (" uid = ") &&! responseContent. contains (" / bin / ") &&! responseContent. contains (" administrator ");} else {return true; // Service blocked@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_50 ´æ(Ëë:standard_500_50" 
average_word_length	Ô+eâØ@"$
potential_heading_score	š™™™™™É?"
sentence_count	      "@"$
alphanumeric_percentage	ûËîÉÃæ?"ú
punctuation_countsã*à

!	      @

"	      (@

&	      @

(	      $@

)	      $@

,	       @

-	      @

.	       @

/	      @

:	      ð?

;	      @

{	       @

=	      @

}	      ð?"!
uppercase_percentage	ý‡ôÛ×£?""
whitespace_percentage	-Cëâ6Â?"
list_item_indicator  "

word_count	     À[@"$
average_sentence_length	{ƒ/L¦ª(@"
vocabulary_density	¢E¶óýÔÜ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	“:M„å?2Ú

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_513Ò
ô{return true; // Service blocked the request}} catch (StatusRuntimeException e) {return true; // Service blocked the request} catch (Exception e) {return false;}} private BufferOverflowTestResult testLargeContentHandling (String serviceName, int contentSize) {String testDescription = String. format (" % s service with % d byte content ", serviceName, contentSize); long startTime = System. currentTimeMillis (); try {// Create large content StringBuilder largeContent = new StringBuilder (); String@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_51 ›ë(´ð:standard_500_50" 
average_word_length	–²q¬Ë@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	 /Ý$é?"Ê
punctuation_counts³*°

"	       @

%	       @

(	      @

)	      @

{	      @

;	      @

,	      @

}	      @

=	      @

.	       @

/	      @"!
uppercase_percentage	ü©ñÒMb°?""
whitespace_percentage	Tã¥›Ä À?"
list_item_indicator  "

word_count	     @W@"$
average_sentence_length	      ?@"
vocabulary_density	2æ®%äƒà?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	(µ¦yå?2ä

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_524Ì
î= new StringBuilder (); String pattern = " Large content test pattern "; while (largeContent. length () < contentSize) {largeContent. append (pattern); if (largeContent. length () > = contentSize) break;} PipeDoc largeDoc = PipeDoc. newBuilder (). setId (" buffer - overflow - test "). setTitle (" Buffer overflow test "). setBody (largeContent. toString ()). build (); ProcessRequest request; if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" buffer - test ",@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_52 Œð(»õ:standard_500_50" 
average_word_length	ÇK7‰Aà@"$
potential_heading_score	        "
sentence_count	      &@"$
alphanumeric_percentage	Y·Ñ Þæ?"Ú
punctuation_countsÃ*À

"	      $@

(	      .@

)	      ,@

;	      @

{	       @

<	      ð?

,	      ð?

=	      @

}	      ð?

-	      @

.	      $@

>	      ð?"!
uppercase_percentage	Ä±.n£¬?""
whitespace_percentage	J{ƒ/L¦Â?"
list_item_indicator  "

word_count	     @\@"$
average_sentence_length	=›UŸ‹$@"
vocabulary_density	]þCúíëØ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	ÛŠýe÷äå?2è

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_535Ð
ò= createEmbedderProcessRequest (" buffer - test ", serviceName + " - step ", largeDoc);} else {request = createProcessRequest (" buffer - test ", serviceName + " - step ", largeDoc);} PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client = getClientForService (serviceName); ProcessResponse response = client. withDeadlineAfter (60, TimeUnit. SECONDS). processData (request); long responseTime = System. currentTimeMillis () - startTime; // Service handled large content gracefully return new@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_53 õ(Šú:standard_500_50" 
average_word_length	¡g³ês5@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	46<½è?"Ú
punctuation_countsÃ*À

"	       @

(	      @

)	      @

+	       @

;	      @

{	      ð?

,	      @

=	      @

-	      @

}	       @

.	      @

/	       @"!
uppercase_percentage	M„O¯”µ?""
whitespace_percentage	\Âõ(\¿?"
list_item_indicator  "

word_count	     ÀV@"$
average_sentence_length	…|Ð³YU.@"
vocabulary_density	‹lçû©ñÞ?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	p_ÎQæ?2è

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_546Ð
òlarge content gracefully return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (StatusRuntimeException e) {long responseTime = System. currentTimeMillis () - startTime; if (e. getStatus (). getCode () == Status. Code. RESOURCE _ EXHAUSTED || e. getStatus (). getCode () == Status. Code. INVALID _ ARGUMENT) {// Service properly rejected oversized content return new BufferOverflowTestResult (testDescription, true, false, responseTime);} else {// Unexpected error@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_54 Üù(Ñþ:standard_500_50" 
average_word_length	õJY†8Ö@"$
potential_heading_score	š™™™™™É?"
sentence_count	      $@"$
alphanumeric_percentage	_˜LŒè?"Ú
punctuation_countsÃ*À

(	      "@

)	      "@

;	      @

{	      @

,	      @

|	       @

}	       @

=	      @

-	      ð?

.	      "@

_	       @

/	      @"!
uppercase_percentage	¬Zd;ß¿?""
whitespace_percentage	\Âõ(\¿?"
list_item_indicator  "

word_count	     €X@"$
average_sentence_length	š™™™™™#@"
vocabulary_density	{ƒ/L¦
Þ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	#Ûù~j¼æ?2Ô

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_557Ì
î} else {// Unexpected error return new BufferOverflowTestResult (testDescription, false, false, responseTime);}} catch (Exception e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, false, true, responseTime);}} private BufferOverflowTestResult testExtremelyLongFieldHandling () {String testDescription = " Extremely long field handling "; long startTime = System. currentTimeMillis (); try {String extremelyLongTitle = " A ".@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_55 ¦þ(™ƒ:standard_500_50" 
average_word_length	Ôšæ§¨@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	Ûù~j¼té?"Ê
punctuation_counts³*°

"	      @

(	      @

)	      @

{	      @

;	      @

,	      @

}	      @

=	      @

-	      ð?

.	      @

/	       @"!
uppercase_percentage	rùé·¯³?""
whitespace_percentage	x$(~¼?"
list_item_indicator  "

word_count	     @U@"$
average_sentence_length	¾Á&SU<@"
vocabulary_density	“©‚QIÜ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	¸¯çŒ(ç?2È

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_568Ð
òtry {String extremelyLongTitle = " A ". repeat (100000); // 100 k characters PipeDoc longFieldDoc = PipeDoc. newBuilder (). setId (" long - field - test "). setTitle (extremelyLongTitle). setBody (" Normal body content "). build (); ProcessRequest request = createProcessRequest (" long - field - test ", " echo - step ", longFieldDoc); ProcessResponse response = echoClient. processData (request); long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_56 è‚(ö‡:standard_500_50" 
average_word_length	¾0™*•@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	ƒÀÊ¡E¶ç?"º
punctuation_counts£* 

"	      $@

(	      $@

)	      "@

{	      ð?

;	      @

,	       @

=	      @

-	      @

.	       @

/	       @"!
uppercase_percentage	n4€·@‚²?""
whitespace_percentage	Æm4€·@Â?"
list_item_indicator  "

word_count	     ÀY@"$
average_sentence_length	O¯”eˆã&@"
vocabulary_density	mçû©ñÒÝ?"
digit_percentage	û:pÎˆ’?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	k+ö—Ý“ç?2Ù

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_579Ñ
ó; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (StatusRuntimeException e) {long responseTime = System. currentTimeMillis () - startTime; if (e. getStatus (). getCode () == Status. Code. INVALID _ ARGUMENT || e. getStatus (). getCode () == Status. Code. RESOURCE _ EXHAUSTED) {return new BufferOverflowTestResult (testDescription, true, false, responseTime);} else {return new BufferOverflowTestResult (testDescription, false, false, responseTime);}} catch@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_57 Å‡(¿Œ:standard_500_50" 
average_word_length	%•CK@"$
potential_heading_score	š™™™™™É?"
sentence_count	      $@"$
alphanumeric_percentage	;ßO—nè?"Ê
punctuation_counts³*°

(	      $@

)	      $@

;	      @

{	      @

,	      "@

|	       @

}	      @

=	      @

-	      ð?

.	      "@

_	       @"!
uppercase_percentage	åa¡Ö4ïÀ?""
whitespace_percentage	:’ËH¿½?"
list_item_indicator  "

word_count	     €Y@"$
average_sentence_length	ffffff$@"
vocabulary_density	¼–z6×?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	      è?2ñ

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_58:É
ë, responseTime);}} catch (Exception e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, false, true, responseTime);}} private BufferOverflowTestResult testMaliciousBinaryContentHandling () {String testDescription = " Malicious binary content handling "; long startTime = System. currentTimeMillis (); try {// Create binary content that might cause buffer overflows byte [] maliciousBinary = new byte [10000]; Arrays. fill (@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_58 ’Œ(ø:standard_500_50" 
average_word_length	œÄ °rè@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	“©‚QIé?"ê
punctuation_countsÓ*Ð

"	       @

(	      @

)	      @

,	      @

-	      ð?

.	      @

/	       @

;	      @

{	      @

[	       @

}	      @

=	      @

]	       @"!
uppercase_percentage	eª`TR'°?""
whitespace_percentage	yX¨5Í;¾?"
list_item_indicator  "

word_count	     ÀU@"$
average_sentence_length	     À5@"
vocabulary_density	z¥,Cëà?"
digit_percentage	ˆ…ZÓ¼ã„?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     °~@"
relative_position	•Ô	h"lè?2Î

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_59;Æ
è= new byte [10000]; Arrays. fill (maliciousBinary, (byte) 0 xFF); // Fill with max byte value Blob maliciousBlob = Blob. newBuilder (). setBlobId (" malicious - binary - test "). setFilename (" malicious. bin "). setData (ByteString. copyFrom (maliciousBinary )). setMimeType (" application / octet - stream "). build (); PipeDoc binaryDoc = PipeDoc. newBuilder (). setId (" binary - test "). setTitle (" Binary content test "). setBlob (maliciousBlob). build (); ProcessRequest request =@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_59 Î(—–:standard_500_50" 
average_word_length	Å °rh@"$
potential_heading_score	        "
sentence_count	      .@"$
alphanumeric_percentage	­iÞqŠŽæ?"Ê
punctuation_counts³*°

"	      $@

(	      ,@

)	      ,@

[	      ð?

;	      @

,	      ð?

=	      @

]	      ð?

-	      @

.	      ,@

/	      @"!
uppercase_percentage		ž^)Ë°?""
whitespace_percentage	ºk	ù gÃ?"
list_item_indicator  "

word_count	     €]@"$
average_sentence_length	ÖÅm4€w@"
vocabulary_density	a2U0*©Û?"
digit_percentage	(í¾0‰?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     €~@"
relative_position	HPüs×è?2É

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_60<Ñ
óProcessRequest request = createProcessRequest (" binary - test ", " tika - step ", binaryDoc); ProcessResponse response = tikaClient. processData (request); long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (StatusRuntimeException e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (Exception e@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_60 €–(Êš:standard_500_50" 
average_word_length	|a2U°@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	aÃÓ+eé?"º
punctuation_counts£* 

"	      @

(	       @

)	      @

;	      @

{	      ð?

,	       @

=	      @

-	      @

}	       @

.	      @"!
uppercase_percentage	üs×ò±?""
whitespace_percentage	šwœ¢#¹¼?"
list_item_indicator  "

word_count	     €V@"$
average_sentence_length	     €6@"
vocabulary_density	¬­Ø_vOÚ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	Ý$•Cé?2é

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_61=Ñ
ófalse, responseTime);} catch (Exception e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, false, true, responseTime);}} private BufferOverflowTestResult testDeeplyNestedStructureHandling () {String testDescription = " Deeply nested structure handling "; long startTime = System. currentTimeMillis (); try {// Create deeply nested JSON - like content StringBuilder nestedContent = new StringBuilder (); for (int i = 0; i < 1000; i@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_61 ™š(ûž:standard_500_50" 
average_word_length	      @"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	Á¨¤N@é?"Ú
punctuation_countsÃ*À

"	       @

(	      @

)	      @

;	       @

{	      @

,	      @

<	      ð?

}	      @

=	      @

-	       @

.	       @

/	       @"!
uppercase_percentage	ý‡ôÛ×³?""
whitespace_percentage	zÇ):’Ë¿?"
list_item_indicator  "

word_count	      W@"$
average_sentence_length	B>èÙ¬ª>@"
vocabulary_density	EØðôJYà?"
digit_percentage	{®Gáz„?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	 ø1æ®é?2’
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_62>Ê
ì(); for (int i = 0; i < 1000; i ++) {nestedContent. append (" {\ " level "). append (i). append (" \ ": ");} nestedContent. append (" \ " deep _ value \ ""); for (int i = 0; i < 1000; i ++) {nestedContent. append ("} ");} PipeDoc nestedDoc = PipeDoc. newBuilder (). setId (" nested - test "). setTitle (" Nested structure test "). setBody (nestedContent. toString ()). build (); ProcessRequest request = createProcessRequest (" nested - test ", " chunker - step ", nestedDoc); ProcessResponse@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_62 Ñž(ù£:standard_500_50" 
average_word_length	ÄB­iÞq@"$
potential_heading_score	š™™™™™É?"
sentence_count	      (@"$
alphanumeric_percentage	•C‹lçã?"Š
punctuation_countsó*ð

"	      4@

(	      .@

)	      .@

+	      @

,	       @

-	      @

.	      &@

:	      ð?

;	      $@

{	      @

<	       @

\	      @

=	      @

}	      @

_	      ð?"!
uppercase_percentage	¥,Cëâ¦?""
whitespace_percentage	. ø1æÆ?"
list_item_indicator  "

word_count	      b@"$
average_sentence_length	      (@"
vocabulary_density	      Ô?"
digit_percentage	Dioð…É”?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     À~@"
relative_position	%ušê?2Ê

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_63?Ò
ô- step ", nestedDoc); ProcessResponse response = chunkerClient. processData (request); long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (StatusRuntimeException e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (Exception e) {long responseTime = System. currentTimeMillis () - startTime; return@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_63 Ë£(´¨:standard_500_50" 
average_word_length	Ð³Yõ¹š@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	F¶óýÔxé?"º
punctuation_counts£* 

"	      ð?

(	       @

)	      "@

;	      @

{	       @

,	      @

-	      @

=	      @

}	       @

.	      @"!
uppercase_percentage	;ßO—n²?""
whitespace_percentage	ÙÎ÷Sã¥»?"
list_item_indicator "

word_count	     ÀV@"$
average_sentence_length	3333332@"
vocabulary_density	ª‚QI€Ö?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	ØðôJY†ê?2è

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_64@Ð
ò() - startTime; return new BufferOverflowTestResult (testDescription, false, true, responseTime);}} private DataIntegrityResult testServiceDataIntegrity (PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client, String serviceName) throws Exception {String testContent = " Data integrity test content for " + serviceName + " service. " + " This content should maintain its integrity during processing. "; // Calculate input hash MessageDigest md 5 = MessageDigest. getInstance (" MD 5 "); String@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_64 “¨(“­:standard_500_50" 
average_word_length	¬­Ø_v@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	‰ÒÞà“é?"Ú
punctuation_countsÃ*À

"	       @

(	      @

)	      @

;	      @

{	      ð?

+	      @

,	      @

-	      ð?

}	       @

=	       @

.	      @

/	       @"!
uppercase_percentage	]ÜFx´?""
whitespace_percentage	\Âõ(\¿?"
list_item_indicator  "

word_count	     ÀT@"$
average_sentence_length	š™™™™™0@"
vocabulary_density	D‹lçû©ã?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	mÅþ²{òê?2ê

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_65AÒ
ô= MessageDigest. getInstance (" MD 5 "); String inputHash = bytesToHex (md 5. digest (testContent. getBytes (StandardCharsets. UTF _ 8 ))); PipeDoc inputDoc = PipeDoc. newBuilder (). setId (" integrity - test - " + serviceName). setTitle (" Data integrity test "). setBody (testContent). build (); ProcessRequest request; if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" integrity - test ", serviceName + " - step ", inputDoc);} else {request = createProcessRequest@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_65 â¬(Á±:standard_500_50" 
average_word_length	¼?Æ@"$
potential_heading_score	š™™™™™É?"
sentence_count	      &@"$
alphanumeric_percentage	`åÐ"Ûùæ?"Ú
punctuation_countsÃ*À

"	      (@

(	      (@

)	      (@

;	      @

+	       @

{	       @

,	       @

=	      @

-	      @

}	      ð?

.	      $@

_	      ð?"!
uppercase_percentage	Ûù~j¼t³?""
whitespace_percentage	ã¥›Ä °Â?"
list_item_indicator  "

word_count	     À[@"$
average_sentence_length	­iÞqŠ.$@"
vocabulary_density	ê•²q¬Û?"
digit_percentage	ú~j¼t“x?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	šž^ë?2…
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_66BÍ
ïelse {request = createProcessRequest (" integrity - test ", serviceName + " - step ", inputDoc);} ProcessResponse response = client. processData (request); if (! response. getSuccess ()) {return new DataIntegrityResult (false, false, true, inputHash, "");} String outputContent = response. getOutputDoc (). getBody (); String outputHash = bytesToHex (md 5. digest (outputContent. getBytes (StandardCharsets. UTF _ 8 ))); // For most services, content should be preserved exactly (except embedder@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_66 ‘±(Ûµ:standard_500_50" 
average_word_length	 Òo_N@"$
potential_heading_score	š™™™™™É?"
sentence_count	       @"$
alphanumeric_percentage	$(~Œ¹ç?"ú
punctuation_countsã*à

!	      ð?

"	      @

(	      &@

)	      $@

+	      ð?

,	      @

-	       @

.	      @

/	       @

{	       @

;	      @

=	      @

}	       @

_	      ð?"!
uppercase_percentage	âX·Ñ ®?""
whitespace_percentage	ioð…ÉTÁ?"
list_item_indicator  "

word_count	     @Z@"$
average_sentence_length	     @*@"
vocabulary_density	›æ§èHâ?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ð~@"
relative_position	µûËîÉë?2º

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_67CÒ
ôshould be preserved exactly (except embedder which adds embeddings) boolean integrityMaintained = " embedder ". equals (serviceName) || outputContent. contains (testContent) || inputHash. equals (outputHash); boolean checksumValid = inputHash. equals (outputHash) || " embedder ". equals (serviceName); boolean dataCorrupted = outputContent. isEmpty () || outputContent. contains (" \ u 0000 "); return new DataIntegrityResult (integrityMaintained, checksumValid, dataCorrupted, inputHash, outputHash@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_67 °µ(‡º:standard_500_50" 
average_word_length	ÌH¿}Ý@"$
potential_heading_score	š™™™™™É?"
sentence_count	       @"$
alphanumeric_percentage	ôýÔxé&é?"ª
punctuation_counts“*

"	      @

(	      "@

)	       @

;	      @

|	       @

\	      ð?

,	      @

=	      @

.	      @"!
uppercase_percentage	ºI+‡¦?""
whitespace_percentage	V-²½?"
list_item_indicator  "

word_count	     @V@"$
average_sentence_length	     @&@"
vocabulary_density	@aÃÓ+Ù?"
digit_percentage	ü©ñÒMb€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	Kê46ì?2Ô

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_68DÌ
î, dataCorrupted, inputHash, outputHash);} private boolean containsSensitiveInformation (String text) {if (text == null) return false; String lowerText = text. toLowerCase (); // Check for various types of sensitive information return lowerText. contains (" password ") || lowerText. contains (" secret ") || lowerText. contains (" private key ") || lowerText. contains (" api key ") || lowerText. contains (" token ") || lowerText. contains (" credit card ") || lowerText. contains (" ssn ") ||@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_68 â¹(Æ¾:standard_500_50" 
average_word_length	–²q¬‹@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	yé&1¬æ?"Ê
punctuation_counts³*°

"	      ,@

(	      $@

)	      &@

;	      @

{	      ð?

,	      @

|	      ,@

}	      ð?

=	      @

.	       @

/	       @"!
uppercase_percentage	Â&S£¢?""
whitespace_percentage	"lxz¥,Ã?"
list_item_indicator  "

word_count	     €[@"$
average_sentence_length	¨WÊ2Äq(@"
vocabulary_density	8gDioØ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	þe÷äa¡ì?2é

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_69EÑ
ó") || lowerText. contains (" ssn ") || lowerText. contains (" social security ") || lowerText. contains (" / etc / passwd ") || lowerText. contains (" c: \\ windows ") || lowerText. contains (" database ") || lowerText. contains (" connection string ") || lowerText. contains (" stack trace ") || lowerText. contains (" exception ") || lowerText. contains (" error at line ") || lowerText. contains (" file not found ") || lowerText. contains (" access denied ");} private String bytesToHex (byte []@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_69 –¾(ƒÃ:standard_500_50" 
average_word_length	¼?Æ
@"$
potential_heading_score	        "
sentence_count	      (@"$
alphanumeric_percentage	òAÏfÕçä?"Ú
punctuation_countsÃ*À

"	      7@

(	      (@

)	      (@

:	      ð?

;	      ð?

[	      ð?

|	      6@

\	       @

}	      ð?

]	      ð?

.	      &@

/	       @"!
uppercase_percentage	¼?Æœ?""
whitespace_percentage	´Yõ¹ÚŠÅ?"
list_item_indicator  "

word_count	      _@"$
average_sentence_length	{ƒ/L¦ª$@"
vocabulary_density	Tã¥›Ä Ô?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	“:M„í?2Š
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_70FÂ
ä");} private String bytesToHex (byte [] bytes) {StringBuilder result = new StringBuilder (); for (byte b: bytes) {result. append (String. format (" % 02 x ", b ));} return result. toString ();} private ProcessRequest createProcessRequest (String pipelineName, String stepName, PipeDoc document) {ServiceMetadata metadata = ServiceMetadata. newBuilder (). setPipelineName (pipelineName). setPipeStepName (stepName). setStreamId (" security - stream - " + System. currentTimeMillis ()).@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_70 ÖÂ(ªÇ:standard_500_50" 
average_word_length	MŒJêD@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	tµûËîç?"Š
punctuation_countsó*ð

"	      @

%	      ð?

(	      (@

)	      *@

+	      ð?

,	      @

-	       @

.	      "@

:	      ð?

;	      @

[	      ð?

{	      @

}	      @

]	      ð?

=	       @"!
uppercase_percentage	ÎˆÒÞà³?""
whitespace_percentage	Tã¥›Ä À?"
list_item_indicator  "

word_count	      Z@"$
average_sentence_length	±Pkšw'@"
vocabulary_density	ð§ÆK7‰Ý?"
digit_percentage		ž^)Ëp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @~@"
relative_position	(µ¦yí?2Ô

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_71GÌ
î- " + System. currentTimeMillis ()). setCurrentHopNumber (1). build (); ProcessConfiguration config = ProcessConfiguration. newBuilder (). build (); return ProcessRequest. newBuilder (). setDocument (document). setConfig (config). setMetadata (metadata). build ();} private ProcessRequest createEmbedderProcessRequest (String pipelineName, String stepName, PipeDoc document) {ServiceMetadata metadata = ServiceMetadata. newBuilder (). setPipelineName (pipelineName). setPipeStepName (stepName).@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_71 ùÆ(—Ì:standard_500_50" 
average_word_length	Ð³Yõ¹š@"$
potential_heading_score	        "
sentence_count	      ,@"$
alphanumeric_percentage	‡ÙÎ÷Sé?"Ê
punctuation_counts³*°

"	      ð?

(	      ,@

)	      .@

+	      ð?

;	      @

{	      ð?

,	       @

-	      ð?

=	       @

}	      ð?

.	      ,@"!
uppercase_percentage	#Ûù~j¼´?""
whitespace_percentage	ÃÓ+eâ¸?"
list_item_indicator "

word_count	     ÀV@"$
average_sentence_length	      @"
vocabulary_density	á“©‚QÙ?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	ÛŠýe÷äí?2Ç

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_72HÏ
ñ. setPipeStepName (stepName). setStreamId (" security - stream - " + System. currentTimeMillis ()). setCurrentHopNumber (1). build (); Struct embedderConfig = Struct. newBuilder (). putFields (" embeddingModel ", Value. newBuilder (). setStringValue (" ALL _ MINILM _ L 6 _ V 2 "). build ()). putFields (" fieldsToEmbed ", Value. newBuilder (). setListValue (com. google. protobuf. ListValue. newBuilder (). addValues (Value. newBuilder (). setStringValue (" title "). build ()). addValues (Value.@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_72 ìË(ßÐ:standard_500_50" 
average_word_length	¿œ3¢´@"$
potential_heading_score	        "
sentence_count	      7@"$
alphanumeric_percentage	Õ	h"lxæ?"º
punctuation_counts£* 

"	      $@

(	      3@

)	      0@

+	      ð?

;	      ð?

,	       @

-	       @

=	      ð?

.	      7@

_	      @"!
uppercase_percentage	þCúíëÀ¹?""
whitespace_percentage	/n£¼Â?"
list_item_indicator  "

word_count	     À]@"$
average_sentence_length	üs×²@"
vocabulary_density	 ‰°áé•Ö?"
digit_percentage	ú~j¼t“x?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	p_ÎQî?2º

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_73IÒ
ô. addValues (Value. newBuilder (). setStringValue (" body "). build ()). build ()). build ()). build (); ProcessConfiguration config = ProcessConfiguration. newBuilder (). setCustomJsonConfig (embedderConfig). build (); return ProcessRequest. newBuilder (). setDocument (document). setConfig (config). setMetadata (metadata). build ();} private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub getClientForService (String serviceName) {switch (serviceName) {case " tika ": return tikaClient; case@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_73 ÏÐ(œÖ:standard_500_50" 
average_word_length	ù g³ê³@"$
potential_heading_score	š™™™™™É?"
sentence_count	      1@"$
alphanumeric_percentage	¦›Ä °rè?"ª
punctuation_counts“*

"	      @

(	      1@

)	      3@

:	      ð?

;	      @

{	       @

=	      ð?

}	      ð?

.	      0@"!
uppercase_percentage	;ßO—n²?""
whitespace_percentage	‰A`åÐ"»?"
list_item_indicator  "

word_count	     @Y@"$
average_sentence_length	ûËîÉÃ@"
vocabulary_density	S–!Žuq×?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	#Ûù~j¼î?2½

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_74JÅ
çcase " tika ": return tikaClient; case " chunker ": return chunkerClient; case " embedder ": return embedderClient; case " echo ": return echoClient; default: throw new IllegalArgumentException (" Unknown service: " + serviceName);}} // Inner classes for test results private static class BufferOverflowTestResult {final String testDescription; final boolean handledGracefully; final boolean causedCrash; final long responseTime; BufferOverflowTestResult (String testDescription, boolean@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_74 íÕ(ÀÚ:standard_500_50" 
average_word_length	‰A`åÐ"@"$
potential_heading_score	      à?"
sentence_count	      ð?"$
alphanumeric_percentage	mçû©ñÒé?"º
punctuation_counts£* 

"	      $@

(	       @

)	      ð?

:	      @

;	      "@

+	      ð?

{	      ð?

,	      ð?

}	       @

/	       @"!
uppercase_percentage	NÑ‘\þCª?""
whitespace_percentage	q¬‹Ûh ¿?"
list_item_indicator  "

word_count	     @T@"$
average_sentence_length	     @T@"
vocabulary_density	‹ýe÷äaá?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     p~@"
relative_position	¸¯çŒ(ï?2 

@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_75KÈ
ê(String testDescription, boolean handledGracefully, boolean causedCrash, long responseTime) {this. testDescription = testDescription; this. handledGracefully = handledGracefully; this. causedCrash = causedCrash; this. responseTime = responseTime;}} private static class DataIntegrityResult {final boolean integrityMaintained; final boolean checksumValid; final boolean dataCorrupted; final String inputHash; final String outputHash; DataIntegrityResult (boolean integrityMaintained, boolean@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_75 ¡Ú(¢ß:standard_500_50" 
average_word_length	1w-!_@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	^ºI+ë?"š
punctuation_countsƒ*€

(	       @

)	      ð?

{	       @

;	      "@

,	      @

=	      @

}	       @

.	      @"!
uppercase_percentage	Kê46¬?""
whitespace_percentage	™*•Ô	¸?"
list_item_indicator  "

word_count	     €Q@"$
average_sentence_length	      ,@"
vocabulary_density	i oÅ×?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      ~@"
relative_position	k+ö—Ý“ï?2µ	
@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_76L½
ß(boolean integrityMaintained, boolean checksumValid, boolean dataCorrupted, String inputHash, String outputHash) {this. integrityMaintained = integrityMaintained; this. checksumValid = checksumValid; this. dataCorrupted = dataCorrupted; this. inputHash = inputHash; this. outputHash = outputHash;}}} // END VARIATION 38 // Total size: 45299 characters@ca5191dc-3562-4a0d-b351-16ec7c89cf09_tika-input-doc-038_chunk_76 þÞ(½â:standard_500_50" 
average_word_length	Ù_vO–@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	>yX¨5Íé?"º
punctuation_counts£* 

(	      ð?

)	      ð?

:	      ð?

{	      ð?

;	      @

,	      @

=	      @

}	      @

.	      @

/	      @"!
uppercase_percentage	ÙÎ÷Sãµ?""
whitespace_percentage	$(~Œ¹»?"
list_item_indicator  "

word_count	      M@"$
average_sentence_length	…|Ð³YU#@"
vocabulary_density	/Ý$•Û?"
digit_percentage	8øÂdª`”?"
is_last_chunk "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ðu@"
relative_position	      ð?