
tika-input-doc-017*•Ïsource-code/SecurityIntegrationTests.java source-code/SecurityIntegrationTests.javapackageÂ com.rokkon.integration.security; importÂ com.google.protobuf.ByteString; importÂ com.google.protobuf.Empty; importÂ com.google.protobuf.Struct; importÂ com.google.protobuf.Value; importÂ com.rokkon.search.model.*; importÂ com.rokkon.search.sdk.*; importÂ io.grpc.ManagedChannel; importÂ io.grpc.ManagedChannelBuilder; importÂ io.grpc.Status; importÂ io.grpc.StatusRuntimeException; importÂ io.quarkus.test.junit.QuarkusIntegrationTest; importÂ org.junit.jupiter.api.*; importÂ org.slf4j.Logger; importÂ org.slf4j.LoggerFactory; importÂ java.nio.charset.StandardCharsets; importÂ java.security.MessageDigest; importÂ java.util.*; importÂ java.util.concurrent.TimeUnit; importÂ java.util.regex.Pattern; importÂ staticÂ org.junit.jupiter.api.Assertions.*; /** Â *Â ComprehensiveÂ securityÂ integrationÂ testsÂ toÂ validateÂ inputÂ validation,Â maliciousÂ contentÂ handling, Â *Â dataÂ integrityÂ verification,Â andÂ securityÂ boundariesÂ acrossÂ allÂ services. Â *Â  Â *Â TheseÂ testsÂ verify: Â *Â -Â InputÂ validationÂ andÂ sanitization Â *Â -Â MaliciousÂ contentÂ detectionÂ andÂ handling Â *Â -Â DataÂ integrityÂ verificationÂ andÂ checksums Â *Â -Â SecurityÂ boundaryÂ enforcement Â *Â -Â BufferÂ overflowÂ andÂ injectionÂ attackÂ prevention Â *Â -Â ContentÂ filteringÂ andÂ blacklistÂ enforcement Â *Â -Â SecureÂ errorÂ handlingÂ withoutÂ informationÂ leakage Â *Â -Â AuthenticationÂ andÂ authorizationÂ patterns Â *Â -Â SecureÂ dataÂ transmissionÂ andÂ storage Â *Â -Â PrivacyÂ andÂ dataÂ protectionÂ compliance Â */ @QuarkusIntegrationTest @TestMethodOrder(MethodOrderer.OrderAnnotation.class) @Disabled("RequiresÂ fullÂ gRPCÂ serviceÂ infrastructureÂ forÂ comprehensiveÂ securityÂ testingÂ againstÂ maliciousÂ inputsÂ andÂ attacks") classÂ SecurityIntegrationTestsÂ { Â Â Â Â privateÂ staticÂ finalÂ LoggerÂ LOGÂ =Â LoggerFactory.getLogger(SecurityIntegrationTests.class); Â Â Â Â  Â Â Â Â //Â SecurityÂ testÂ patterns Â Â Â Â privateÂ staticÂ finalÂ List<String>Â SQL_INJECTION_PATTERNSÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â "';Â DROPÂ TABLEÂ users;Â --", Â Â Â Â Â Â Â Â "'Â ORÂ '1'='1", Â Â Â Â Â Â Â Â "'Â UNIONÂ SELECTÂ *Â FROMÂ sensitive_dataÂ --", Â Â Â Â Â Â Â Â "admin'--", Â Â Â Â Â Â Â Â "'Â ORÂ 1=1#" Â Â Â Â ); Â Â Â Â  Â Â Â Â privateÂ staticÂ finalÂ List<String>Â XSS_PATTERNSÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â "<script>alert('XSS')</script>", Â Â Â Â Â Â Â Â "javascript:alert('XSS')", Â Â Â Â Â Â Â Â "<imgÂ src=xÂ onerror=alert('XSS')>", Â Â Â Â Â Â Â Â "<svgÂ onload=alert('XSS')>", Â Â Â Â Â Â Â Â "';alert('XSS');//" Â Â Â Â ); Â Â Â Â  Â Â Â Â privateÂ staticÂ finalÂ List<String>Â COMMAND_INJECTION_PATTERNSÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â ";Â rmÂ -rfÂ /", Â Â Â Â Â Â Â Â "|Â catÂ /etc/passwd", Â Â Â Â Â Â Â Â "&&Â whoami", Â Â Â Â Â Â Â Â "`rmÂ -rfÂ /`", Â Â Â Â Â Â Â Â "$(catÂ /etc/passwd)" Â Â Â Â ); Â Â Â Â  Â Â Â Â privateÂ staticÂ finalÂ List<String>Â PATH_TRAVERSAL_PATTERNSÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â "../../../etc/passwd", Â Â Â Â Â Â Â Â "..\\..\\..\\windows\\system32\\config\\sam", Â Â Â Â Â Â Â Â "....//....//....//etc/passwd", Â Â Â Â Â Â Â Â "%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd", Â Â Â Â Â Â Â Â "..%252f..%252f..%252fetc%252fpasswd" Â Â Â Â ); Â Â Â Â  Â Â Â Â //Â ContentÂ securityÂ patterns Â Â Â Â privateÂ staticÂ finalÂ PatternÂ SUSPICIOUS_PATTERNÂ =Â Pattern.compile( Â Â Â Â Â Â Â Â "(?i)(password|secret|key|token|auth|admin|root|exploit|hack|inject|malware|virus)", Â Â Â Â Â Â Â Â Pattern.CASE_INSENSITIVEÂ |Â Pattern.MULTILINE Â Â Â Â ); Â Â Â Â  Â Â Â Â privateÂ staticÂ finalÂ longÂ MAX_CONTENT_SIZEÂ =Â 100Â *Â 1024Â *Â 1024;Â //Â 100MB Â Â Â Â privateÂ staticÂ finalÂ intÂ MAX_FIELD_LENGTHÂ =Â 10000; Â Â Â Â  Â Â Â Â privateÂ ManagedChannelÂ tikaChannel; Â Â Â Â privateÂ ManagedChannelÂ chunkerChannel; Â Â Â Â privateÂ ManagedChannelÂ embedderChannel; Â Â Â Â privateÂ ManagedChannelÂ echoChannel; Â Â Â Â  Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ tikaClient; Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ chunkerClient; Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ embedderClient; Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ echoClient; Â Â Â Â @BeforeEach Â Â Â Â voidÂ setUp()Â { Â Â Â Â Â Â Â Â //Â SetÂ upÂ gRPCÂ channelsÂ forÂ securityÂ testing Â Â Â Â Â Â Â Â tikaChannelÂ =Â ManagedChannelBuilder.forAddress("localhost",Â 9000).usePlaintext().build(); Â Â Â Â Â Â Â Â chunkerChannelÂ =Â ManagedChannelBuilder.forAddress("localhost",Â 9001).usePlaintext().build(); Â Â Â Â Â Â Â Â embedderChannelÂ =Â ManagedChannelBuilder.forAddress("localhost",Â 9002).usePlaintext().build(); Â Â Â Â Â Â Â Â echoChannelÂ =Â ManagedChannelBuilder.forAddress("localhost",Â 9003).usePlaintext().build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tikaClientÂ =Â PipeStepProcessorGrpc.newBlockingStub(tikaChannel); Â Â Â Â Â Â Â Â chunkerClientÂ =Â PipeStepProcessorGrpc.newBlockingStub(chunkerChannel); Â Â Â Â Â Â Â Â embedderClientÂ =Â PipeStepProcessorGrpc.newBlockingStub(embedderChannel); Â Â Â Â Â Â Â Â echoClientÂ =Â PipeStepProcessorGrpc.newBlockingStub(echoChannel); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("SecurityÂ integrationÂ testÂ environmentÂ initialized"); Â Â Â Â } Â Â Â Â @AfterEachÂ  Â Â Â Â voidÂ tearDown()Â throwsÂ InterruptedExceptionÂ { Â Â Â Â Â Â Â Â ifÂ (tikaChannelÂ !=Â null)Â { Â Â Â Â Â Â Â Â Â Â Â Â tikaChannel.shutdown(); Â Â Â Â Â Â Â Â Â Â Â Â tikaChannel.awaitTermination(5,Â TimeUnit.SECONDS); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â ifÂ (chunkerChannelÂ !=Â null)Â { Â Â Â Â Â Â Â Â Â Â Â Â chunkerChannel.shutdown(); Â Â Â Â Â Â Â Â Â Â Â Â chunkerChannel.awaitTermination(5,Â TimeUnit.SECONDS); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â ifÂ (embedderChannelÂ !=Â null)Â { Â Â Â Â Â Â Â Â Â Â Â Â embedderChannel.shutdown(); Â Â Â Â Â Â Â Â Â Â Â Â embedderChannel.awaitTermination(5,Â TimeUnit.SECONDS); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â ifÂ (echoChannelÂ !=Â null)Â { Â Â Â Â Â Â Â Â Â Â Â Â echoChannel.shutdown(); Â Â Â Â Â Â Â Â Â Â Â Â echoChannel.awaitTermination(5,Â TimeUnit.SECONDS); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(1) Â Â Â Â @DisplayName("SQLÂ InjectionÂ AttackÂ Prevention") Â Â Â Â voidÂ testSqlInjectionPrevention()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ SQLÂ injectionÂ attackÂ prevention"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Map<String,Â Integer>Â serviceVulnerabilitiesÂ =Â newÂ HashMap<>(); Â Â Â Â Â Â Â Â intÂ totalInjectionAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ blockedAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ injectionPatternÂ :Â SQL_INJECTION_PATTERNS)Â { Â Â Â Â Â Â Â Â Â Â Â Â totalInjectionAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ eachÂ serviceÂ withÂ SQLÂ injectionÂ patterns Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testServiceWithMaliciousInput(tikaClient,Â "tika",Â injectionPattern,Â "SQLÂ Injection"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceVulnerabilities.merge("tika",Â 1,Â Integer::sum); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testServiceWithMaliciousInput(chunkerClient,Â "chunker",Â injectionPattern,Â "SQLÂ Injection"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceVulnerabilities.merge("chunker",Â 1,Â Integer::sum); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testServiceWithMaliciousInput(embedderClient,Â "embedder",Â injectionPattern,Â "SQLÂ Injection"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceVulnerabilities.merge("embedder",Â 1,Â Integer::sum); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testServiceWithMaliciousInput(echoClient,Â "echo",Â injectionPattern,Â "SQLÂ Injection"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceVulnerabilities.merge("echo",Â 1,Â Integer::sum); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â totalInjectionAttemptsÂ +=Â 3;Â //Â AddedÂ 3Â moreÂ services Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ blockingRateÂ =Â (double)Â blockedAttemptsÂ /Â totalInjectionAttempts; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â VerifyÂ SQLÂ injectionÂ protection Â Â Â Â Â Â Â Â assertTrue(blockingRateÂ >=Â 0.90,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("SQLÂ injectionÂ blockingÂ rateÂ %.2f%%Â belowÂ minimumÂ 90%%",Â blockingRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â CheckÂ forÂ service-specificÂ vulnerabilities Â Â Â Â Â Â Â Â forÂ (Map.Entry<String,Â Integer>Â entryÂ :Â serviceVulnerabilities.entrySet())Â { Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceNameÂ =Â entry.getKey(); Â Â Â Â Â Â Â Â Â Â Â Â IntegerÂ vulnerabilityCountÂ =Â entry.getValue(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(vulnerabilityCountÂ <=Â 1,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ serviceÂ hasÂ %dÂ SQLÂ injectionÂ vulnerabilities",Â serviceName,Â vulnerabilityCount)); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â SQLÂ injectionÂ preventionÂ testÂ completedÂ -Â BlockingÂ rate:Â {:.2f}%,Â Vulnerabilities:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockingRateÂ *Â 100,Â serviceVulnerabilities); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(2) Â Â Â Â @DisplayName("Cross-SiteÂ ScriptingÂ (XSS)Â Prevention") Â Â Â Â voidÂ testXssPreventionAndSanitization()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ XSSÂ preventionÂ andÂ contentÂ sanitization"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â intÂ totalXssAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ sanitizedResponsesÂ =Â 0; Â Â Â Â Â Â Â Â List<String>Â unsanitizedResponsesÂ =Â newÂ ArrayList<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ xssPatternÂ :Â XSS_PATTERNS)Â { Â Â Â Â Â Â Â Â Â Â Â Â totalXssAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ XSSÂ patternÂ handlingÂ inÂ documentÂ content Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("xss-test-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("XSSÂ Test:Â "Â +Â xssPattern) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody("ContentÂ withÂ XSSÂ attempt:Â "Â +Â xssPattern) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("xss-security-test",Â "echo-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â echoClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseTitleÂ =Â response.getOutputDoc().getTitle(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseBodyÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ ifÂ XSSÂ patternsÂ wereÂ sanitizedÂ orÂ escaped Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ titleSanitizedÂ =Â !responseTitle.contains("<script>")Â &&Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseTitle.contains("javascript:")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseTitle.contains("onerror=")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseTitle.contains("onload="); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ bodySanitizedÂ =Â !responseBody.contains("<script>")Â &&Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseBody.contains("javascript:")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseBody.contains("onerror=")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseBody.contains("onload="); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (titleSanitizedÂ &&Â bodySanitized)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sanitizedResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â unsanitizedResponses.add("Pattern:Â "Â +Â xssPatternÂ +Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "Â -Â Title:Â "Â +Â responseTitleÂ +Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "Â -Â Body:Â "Â +Â responseBody); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ rejectedÂ maliciousÂ contentÂ -Â alsoÂ countsÂ asÂ protection Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sanitizedResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ blockedÂ theÂ requestÂ -Â thisÂ isÂ good Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sanitizedResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LOG.debug("XSSÂ patternÂ blockedÂ byÂ service:Â {}",Â xssPattern); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ sanitizationRateÂ =Â (double)Â sanitizedResponsesÂ /Â totalXssAttempts; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(sanitizationRateÂ >=Â 0.95,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("XSSÂ sanitizationÂ rateÂ %.2f%%Â belowÂ minimumÂ 95%%",Â sanitizationRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(unsanitizedResponses.size()Â <=Â 1,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("TooÂ manyÂ unsanitizedÂ XSSÂ responses:Â %s",Â unsanitizedResponses)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â XSSÂ preventionÂ testÂ completedÂ -Â SanitizationÂ rate:Â {:.2f}%,Â Unsanitized:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â sanitizationRateÂ *Â 100,Â unsanitizedResponses.size()); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(3) Â Â Â Â @DisplayName("CommandÂ InjectionÂ AttackÂ Prevention") Â Â Â Â voidÂ testCommandInjectionPrevention()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ commandÂ injectionÂ attackÂ prevention"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â intÂ totalCommandAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ blockedCommandsÂ =Â 0; Â Â Â Â Â Â Â Â Map<String,Â List<String>>Â serviceFailuresÂ =Â newÂ HashMap<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ commandPatternÂ :Â COMMAND_INJECTION_PATTERNS)Â { Â Â Â Â Â Â Â Â Â Â Â Â totalCommandAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ commandÂ injectionÂ inÂ documentÂ processing Â Â Â Â Â Â Â Â Â Â Â Â StringÂ maliciousContentÂ =Â "DocumentÂ contentÂ withÂ commandÂ injection:Â "Â +Â commandPattern; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ TikaÂ serviceÂ (mostÂ likelyÂ toÂ executeÂ commandsÂ onÂ files) Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (testTikaServiceWithMaliciousCommand(commandPattern))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedCommands++; Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceFailures.computeIfAbsent("tika",Â kÂ ->Â newÂ ArrayList<>()).add(commandPattern); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ otherÂ services Â Â Â Â Â Â Â Â Â Â Â Â forÂ (StringÂ serviceNameÂ :Â Arrays.asList("chunker",Â "embedder",Â "echo"))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("cmd-injection-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("CommandÂ injectionÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(maliciousContent) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("command-injection-test",Â serviceNameÂ +Â "-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ clientÂ =Â getClientForService(serviceName); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("command-injection-test",Â serviceNameÂ +Â "-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â VerifyÂ noÂ commandÂ executionÂ artifactsÂ inÂ response Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseContentÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ forÂ signsÂ ofÂ commandÂ execution Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ hasExecutionArtifactsÂ =Â responseContent.contains("root:")Â ||Â //Â passwdÂ file Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseContent.contains("uid=")Â ||Â Â Â Â //Â whoamiÂ output Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseContent.contains("/bin/")Â ||Â Â Â //Â systemÂ paths Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseContent.contains("administrator");Â //Â windowsÂ user Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (!hasExecutionArtifacts)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedCommands++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceFailures.computeIfAbsent(serviceName,Â kÂ ->Â newÂ ArrayList<>()).add(commandPattern); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ rejectedÂ maliciousÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedCommands++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ blockedÂ theÂ request Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedCommands++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â totalCommandAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ commandBlockingRateÂ =Â (double)Â blockedCommandsÂ /Â totalCommandAttempts; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(commandBlockingRateÂ >=Â 0.90,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("CommandÂ injectionÂ blockingÂ rateÂ %.2f%%Â belowÂ minimumÂ 90%%",Â commandBlockingRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â VerifyÂ noÂ serviceÂ hadÂ multipleÂ commandÂ injectionÂ vulnerabilities Â Â Â Â Â Â Â Â forÂ (Map.Entry<String,Â List<String>>Â entryÂ :Â serviceFailures.entrySet())Â { Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceNameÂ =Â entry.getKey(); Â Â Â Â Â Â Â Â Â Â Â Â List<String>Â failuresÂ =Â entry.getValue(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(failures.size()Â <=Â 1,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ serviceÂ vulnerableÂ toÂ commandÂ injection:Â %s",Â serviceName,Â failures)); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â CommandÂ injectionÂ preventionÂ testÂ completedÂ -Â BlockingÂ rate:Â {:.2f}%,Â Failures:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â commandBlockingRateÂ *Â 100,Â serviceFailures); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(4) Â Â Â Â @DisplayName("PathÂ TraversalÂ AttackÂ Prevention") Â Â Â Â voidÂ testPathTraversalPrevention()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ pathÂ traversalÂ attackÂ prevention"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â intÂ totalTraversalAttemptsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ blockedTraversalsÂ =Â 0; Â Â Â Â Â Â Â Â List<String>Â vulnerableResponsesÂ =Â newÂ ArrayList<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ traversalPatternÂ :Â PATH_TRAVERSAL_PATTERNS)Â { Â Â Â Â Â Â Â Â Â Â Â Â totalTraversalAttempts++; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â TestÂ pathÂ traversalÂ inÂ filenameÂ (TikaÂ serviceÂ mostÂ vulnerable) Â Â Â Â Â Â Â Â Â Â Â Â byte[]Â dummyContentÂ =Â "DummyÂ fileÂ contentÂ forÂ pathÂ traversalÂ test".getBytes(StandardCharsets.UTF_8); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â BlobÂ maliciousBlobÂ =Â Blob.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlobId("traversal-test-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setFilename(traversalPattern)Â //Â MaliciousÂ filename Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setData(ByteString.copyFrom(dummyContent)) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMimeType("text/plain") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("path-traversal-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("PathÂ traversalÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlob(maliciousBlob) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("path-traversal-test",Â "tika-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â tikaClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseBodyÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ forÂ signsÂ ofÂ successfulÂ pathÂ traversal Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ hasSystemFilesÂ =Â responseBody.contains("root:x:0:0:root")Â ||Â //Â passwdÂ fileÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseBody.contains("[HKEY_LOCAL_MACHINE")Â ||Â //Â registryÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseBody.contains("Administrator")Â ||Â Â Â Â Â Â //Â windowsÂ admin Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â responseBody.contains("daemon:x:");Â Â Â Â Â Â Â Â Â Â Â //Â moreÂ passwdÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (!hasSystemFiles)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedTraversals++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â vulnerableResponses.add("Pattern:Â "Â +Â traversalPatternÂ +Â "Â exposedÂ systemÂ files"); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ rejectedÂ maliciousÂ filename Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedTraversals++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ blockedÂ theÂ request Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â blockedTraversals++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LOG.debug("PathÂ traversalÂ blocked:Â {}",Â traversalPattern); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ traversalBlockingRateÂ =Â (double)Â blockedTraversalsÂ /Â totalTraversalAttempts; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(traversalBlockingRateÂ >=Â 0.95,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("PathÂ traversalÂ blockingÂ rateÂ %.2f%%Â belowÂ minimumÂ 95%%",Â traversalBlockingRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(vulnerableResponses.isEmpty(),Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("PathÂ traversalÂ vulnerabilitiesÂ detected:Â %s",Â vulnerableResponses)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â PathÂ traversalÂ preventionÂ testÂ completedÂ -Â BlockingÂ rate:Â {:.2f}%",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â traversalBlockingRateÂ *Â 100); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(5) Â Â Â Â @DisplayName("BufferÂ OverflowÂ andÂ LargeÂ InputÂ Handling") Â Â Â Â voidÂ testBufferOverflowPrevention()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ bufferÂ overflowÂ preventionÂ andÂ largeÂ inputÂ handling"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â List<BufferOverflowTestResult>Â testResultsÂ =Â newÂ ArrayList<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â TestÂ variousÂ bufferÂ overflowÂ scenarios Â Â Â Â Â Â Â Â testResults.add(testLargeContentHandling("echo",Â 1024Â *Â 1024));Â Â Â Â Â Â //Â 1MB Â Â Â Â Â Â Â Â testResults.add(testLargeContentHandling("echo",Â 10Â *Â 1024Â *Â 1024));Â //Â 10MB Â Â Â Â Â Â Â Â testResults.add(testLargeContentHandling("chunker",Â 5Â *Â 1024Â *Â 1024));Â //Â 5MB Â Â Â Â Â Â Â Â testResults.add(testExtremelyLongFieldHandling()); Â Â Â Â Â Â Â Â testResults.add(testMaliciousBinaryContentHandling()); Â Â Â Â Â Â Â Â testResults.add(testDeeplyNestedStructureHandling()); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â VerifyÂ allÂ bufferÂ overflowÂ testsÂ passed Â Â Â Â Â Â Â Â forÂ (BufferOverflowTestResultÂ resultÂ :Â testResults)Â { Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(result.handledGracefully,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("BufferÂ overflowÂ testÂ failed:Â %s",Â result.testDescription)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertFalse(result.causedCrash,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("ServiceÂ crashedÂ duringÂ test:Â %s",Â result.testDescription)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(result.responseTimeÂ <Â 60000,Â //Â MaxÂ 1Â minute Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("TestÂ tookÂ tooÂ longÂ (%dms):Â %s",Â result.responseTime,Â result.testDescription)); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â BufferÂ overflowÂ preventionÂ testÂ completedÂ -Â AllÂ {}Â testsÂ passed",Â testResults.size()); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(6) Â Â Â Â @DisplayName("DataÂ IntegrityÂ andÂ ChecksumÂ Verification") Â Â Â Â voidÂ testDataIntegrityVerification()Â throwsÂ ExceptionÂ { Â Â Â Â Â Â Â Â LOG.info("TestingÂ dataÂ integrityÂ andÂ checksumÂ verification"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Map<String,Â DataIntegrityResult>Â integrityResultsÂ =Â newÂ HashMap<>(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â TestÂ dataÂ integrityÂ acrossÂ allÂ services Â Â Â Â Â Â Â Â integrityResults.put("TikaParser",Â testServiceDataIntegrity(tikaClient,Â "tika")); Â Â Â Â Â Â Â Â integrityResults.put("Chunker",Â testServiceDataIntegrity(chunkerClient,Â "chunker")); Â Â Â Â Â Â Â Â integrityResults.put("Embedder",Â testServiceDataIntegrity(embedderClient,Â "embedder")); Â Â Â Â Â Â Â Â integrityResults.put("Echo",Â testServiceDataIntegrity(echoClient,Â "echo")); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â VerifyÂ dataÂ integrityÂ forÂ allÂ services Â Â Â Â Â Â Â Â forÂ (Map.Entry<String,Â DataIntegrityResult>Â entryÂ :Â integrityResults.entrySet())Â { Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceNameÂ =Â entry.getKey(); Â Â Â Â Â Â Â Â Â Â Â Â DataIntegrityResultÂ resultÂ =Â entry.getValue(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(result.integrityMaintained,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ failedÂ toÂ maintainÂ dataÂ integrity",Â serviceName)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertTrue(result.checksumValid,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ failedÂ checksumÂ validation",Â serviceName)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â assertFalse(result.dataCorrupted,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â String.format("%sÂ corruptedÂ dataÂ duringÂ processing",Â serviceName)); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â LOG.info("âœ…Â {}Â dataÂ integrityÂ verifiedÂ -Â InputÂ hash:Â {},Â OutputÂ hash:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceName,Â result.inputHash,Â result.outputHash); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â DataÂ integrityÂ verificationÂ testÂ completed"); Â Â Â Â } Â Â Â Â @Test Â Â Â Â @Order(7) Â Â Â Â @DisplayName("SecureÂ ErrorÂ HandlingÂ andÂ InformationÂ LeakageÂ Prevention") Â Â Â Â voidÂ testSecureErrorHandling()Â { Â Â Â Â Â Â Â Â LOG.info("TestingÂ secureÂ errorÂ handlingÂ andÂ informationÂ leakageÂ prevention"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â List<String>Â informationLeaksÂ =Â newÂ ArrayList<>(); Â Â Â Â Â Â Â Â intÂ totalErrorTestsÂ =Â 0; Â Â Â Â Â Â Â Â intÂ secureErrorResponsesÂ =Â 0; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â TestÂ variousÂ errorÂ conditionsÂ thatÂ mightÂ leakÂ sensitiveÂ information Â Â Â Â Â Â Â Â List<String>Â errorInducingInputsÂ =Â Arrays.asList( Â Â Â Â Â Â Â Â Â Â Â Â "",Â Â //Â EmptyÂ input Â Â Â Â Â Â Â Â Â Â Â Â null,Â //Â NullÂ handlingÂ (willÂ beÂ convertedÂ toÂ empty) Â Â Â Â Â Â Â Â Â Â Â Â "a".repeat(MAX_FIELD_LENGTHÂ +Â 1),Â //Â TooÂ longÂ input Â Â Â Â Â Â Â Â Â Â Â Â "\u0000\u0001\u0002",Â //Â Binary/controlÂ characters Â Â Â Â Â Â Â Â Â Â Â Â "{'malformed':Â json}",Â //Â MalformedÂ JSON-likeÂ content Â Â Â Â Â Â Â Â Â Â Â Â "ðŸš€ðŸ”¥ðŸ’¯".repeat(1000)Â //Â UnicodeÂ stressÂ test Â Â Â Â Â Â Â Â ); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â forÂ (StringÂ serviceNameÂ :Â Arrays.asList("tika",Â "chunker",Â "embedder",Â "echo"))Â { Â Â Â Â Â Â Â Â Â Â Â Â forÂ (StringÂ errorInputÂ :Â errorInducingInputs)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â totalErrorTests++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ errorDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("error-test-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle(errorInputÂ !=Â nullÂ ?Â errorInputÂ :Â "") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(errorInputÂ !=Â nullÂ ?Â errorInputÂ :Â "") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ request; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("error-handling-test",Â serviceNameÂ +Â "-step",Â errorDoc); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createProcessRequest("error-handling-test",Â serviceNameÂ +Â "-step",Â errorDoc); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ clientÂ =Â getClientForService(serviceName); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ forÂ informationÂ leakageÂ inÂ response Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseTextÂ =Â response.toString(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (containsSensitiveInformation(responseText))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â informationLeaks.add(String.format("%sÂ serviceÂ leakedÂ informationÂ withÂ input:Â %s",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceName,Â errorInput)); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â secureErrorResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ errorÂ messageÂ forÂ informationÂ leakage Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ errorMessageÂ =Â e.getMessage(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (containsSensitiveInformation(errorMessage))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â informationLeaks.add(String.format("%sÂ serviceÂ errorÂ leakedÂ information:Â %s",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceName,Â errorMessage)); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â secureErrorResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â OtherÂ exceptionsÂ shouldÂ alsoÂ beÂ checked Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (containsSensitiveInformation(e.getMessage()))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â informationLeaks.add(String.format("%sÂ serviceÂ exceptionÂ leakedÂ information:Â %s",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â serviceName,Â e.getMessage())); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â secureErrorResponses++; Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â doubleÂ secureErrorRateÂ =Â (double)Â secureErrorResponsesÂ /Â totalErrorTests; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(secureErrorRateÂ >=Â 0.90,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("SecureÂ errorÂ handlingÂ rateÂ %.2f%%Â belowÂ minimumÂ 90%%",Â secureErrorRateÂ *Â 100)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â assertTrue(informationLeaks.size()Â <=Â 2,Â  Â Â Â Â Â Â Â Â Â Â Â Â String.format("TooÂ manyÂ informationÂ leaksÂ detected:Â %s",Â informationLeaks)); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â LOG.info("âœ…Â SecureÂ errorÂ handlingÂ testÂ completedÂ -Â SecureÂ rate:Â {:.2f}%,Â Leaks:Â {}",Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â secureErrorRateÂ *Â 100,Â informationLeaks.size()); Â Â Â Â } Â Â Â Â  Â Â Â Â //Â HelperÂ Methods Â Â Â Â privateÂ booleanÂ testServiceWithMaliciousInput(PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ client, Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceName,Â StringÂ maliciousInput,Â StringÂ attackType)Â { Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("security-test-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle(attackTypeÂ +Â "Â test:Â "Â +Â maliciousInput) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody("ContentÂ withÂ "Â +Â attackTypeÂ +Â ":Â "Â +Â maliciousInput) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ request; Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("security-test",Â serviceNameÂ +Â "-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createProcessRequest("security-test",Â serviceNameÂ +Â "-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ ifÂ maliciousÂ inputÂ wasÂ sanitizedÂ orÂ blocked Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseContentÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â IfÂ theÂ maliciousÂ inputÂ appearsÂ unchanged,Â itÂ wasn'tÂ blocked Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ !responseContent.contains(maliciousInput); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ rejectedÂ theÂ requestÂ -Â goodÂ securityÂ behavior Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true; Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ blockedÂ theÂ requestÂ -Â goodÂ securityÂ behavior Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true; Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â LOG.debug("ServiceÂ {}Â failedÂ withÂ maliciousÂ inputÂ {}:Â {}",Â serviceName,Â maliciousInput,Â e.getMessage()); Â Â Â Â Â Â Â Â Â Â Â Â returnÂ false; Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ booleanÂ testTikaServiceWithMaliciousCommand(StringÂ commandPattern)Â { Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â //Â CreateÂ aÂ documentÂ withÂ commandÂ injectionÂ inÂ filenameÂ andÂ content Â Â Â Â Â Â Â Â Â Â Â Â StringÂ maliciousContentÂ =Â "DocumentÂ contentÂ "Â +Â commandPattern; Â Â Â Â Â Â Â Â Â Â Â Â byte[]Â contentBytesÂ =Â maliciousContent.getBytes(StandardCharsets.UTF_8); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â BlobÂ maliciousBlobÂ =Â Blob.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlobId("cmd-injection-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setFilename("test"Â +Â commandPatternÂ +Â ".txt") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setData(ByteString.copyFrom(contentBytes)) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMimeType("text/plain") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ maliciousDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("cmd-injection-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("CommandÂ injectionÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlob(maliciousBlob) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("cmd-injection-test",Â "tika-step",Â maliciousDoc); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â tikaClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ responseContentÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â CheckÂ forÂ signsÂ ofÂ commandÂ execution Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ !responseContent.contains("root:")Â &&Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseContent.contains("uid=")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseContent.contains("/bin/")Â && Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â !responseContent.contains("administrator"); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true;Â //Â ServiceÂ blockedÂ theÂ request Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â returnÂ true;Â //Â ServiceÂ blockedÂ theÂ request Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â returnÂ false; Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ BufferOverflowTestResultÂ testLargeContentHandling(StringÂ serviceName,Â intÂ contentSize)Â { Â Â Â Â Â Â Â Â StringÂ testDescriptionÂ =Â String.format("%sÂ serviceÂ withÂ %dÂ byteÂ content",Â serviceName,Â contentSize); Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System.currentTimeMillis(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â //Â CreateÂ largeÂ content Â Â Â Â Â Â Â Â Â Â Â Â StringBuilderÂ largeContentÂ =Â newÂ StringBuilder(); Â Â Â Â Â Â Â Â Â Â Â Â StringÂ patternÂ =Â "LargeÂ contentÂ testÂ patternÂ "; Â Â Â Â Â Â Â Â Â Â Â Â whileÂ (largeContent.length()Â <Â contentSize)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â largeContent.append(pattern); Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (largeContent.length()Â >=Â contentSize)Â break; Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ largeDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("buffer-overflow-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("BufferÂ overflowÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(largeContent.toString()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ request; Â Â Â Â Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("buffer-test",Â serviceNameÂ +Â "-step",Â largeDoc); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createProcessRequest("buffer-test",Â serviceNameÂ +Â "-step",Â largeDoc); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ clientÂ =Â getClientForService(serviceName); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.withDeadlineAfter(60,Â TimeUnit.SECONDS) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ handledÂ largeÂ contentÂ gracefully Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (e.getStatus().getCode()Â ==Â Status.Code.RESOURCE_EXHAUSTEDÂ ||Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â e.getStatus().getCode()Â ==Â Status.Code.INVALID_ARGUMENT)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â ServiceÂ properlyÂ rejectedÂ oversizedÂ content Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //Â UnexpectedÂ error Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â true,Â responseTime); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ BufferOverflowTestResultÂ testExtremelyLongFieldHandling()Â { Â Â Â Â Â Â Â Â StringÂ testDescriptionÂ =Â "ExtremelyÂ longÂ fieldÂ handling"; Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System.currentTimeMillis(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â StringÂ extremelyLongTitleÂ =Â "A".repeat(100000);Â //Â 100kÂ characters Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ longFieldDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("long-field-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle(extremelyLongTitle) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody("NormalÂ bodyÂ content") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("long-field-test",Â "echo-step",Â longFieldDoc); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â echoClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (e.getStatus().getCode()Â ==Â Status.Code.INVALID_ARGUMENTÂ || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â e.getStatus().getCode()Â ==Â Status.Code.RESOURCE_EXHAUSTED)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â true,Â responseTime); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ BufferOverflowTestResultÂ testMaliciousBinaryContentHandling()Â { Â Â Â Â Â Â Â Â StringÂ testDescriptionÂ =Â "MaliciousÂ binaryÂ contentÂ handling"; Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System.currentTimeMillis(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â //Â CreateÂ binaryÂ contentÂ thatÂ mightÂ causeÂ bufferÂ overflows Â Â Â Â Â Â Â Â Â Â Â Â byte[]Â maliciousBinaryÂ =Â newÂ byte[10000]; Â Â Â Â Â Â Â Â Â Â Â Â Arrays.fill(maliciousBinary,Â (byte)Â 0xFF);Â //Â FillÂ withÂ maxÂ byteÂ value Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â BlobÂ maliciousBlobÂ =Â Blob.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlobId("malicious-binary-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setFilename("malicious.bin") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setData(ByteString.copyFrom(maliciousBinary)) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMimeType("application/octet-stream") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ binaryDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("binary-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("BinaryÂ contentÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBlob(maliciousBlob) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("binary-test",Â "tika-step",Â binaryDoc); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â tikaClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â true,Â responseTime); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ BufferOverflowTestResultÂ testDeeplyNestedStructureHandling()Â { Â Â Â Â Â Â Â Â StringÂ testDescriptionÂ =Â "DeeplyÂ nestedÂ structureÂ handling"; Â Â Â Â Â Â Â Â longÂ startTimeÂ =Â System.currentTimeMillis(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â tryÂ { Â Â Â Â Â Â Â Â Â Â Â Â //Â CreateÂ deeplyÂ nestedÂ JSON-likeÂ content Â Â Â Â Â Â Â Â Â Â Â Â StringBuilderÂ nestedContentÂ =Â newÂ StringBuilder(); Â Â Â Â Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â 0;Â iÂ <Â 1000;Â i++)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â nestedContent.append("{\"level").append(i).append("\":Â "); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â nestedContent.append("\"deep_value\""); Â Â Â Â Â Â Â Â Â Â Â Â forÂ (intÂ iÂ =Â 0;Â iÂ <Â 1000;Â i++)Â { Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â nestedContent.append("}"); Â Â Â Â Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â PipeDocÂ nestedDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("nested-test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("NestedÂ structureÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(nestedContent.toString()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â ProcessRequestÂ requestÂ =Â createProcessRequest("nested-test",Â "chunker-step",Â nestedDoc); Â Â Â Â Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â chunkerClient.processData(request); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â }Â catchÂ (StatusRuntimeExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â true,Â false,Â responseTime); Â Â Â Â Â Â Â Â }Â catchÂ (ExceptionÂ e)Â { Â Â Â Â Â Â Â Â Â Â Â Â longÂ responseTimeÂ =Â System.currentTimeMillis()Â -Â startTime; Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ BufferOverflowTestResult(testDescription,Â false,Â true,Â responseTime); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ DataIntegrityResultÂ testServiceDataIntegrity(PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ client, Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ serviceName)Â throwsÂ ExceptionÂ { Â Â Â Â Â Â Â Â StringÂ testContentÂ =Â "DataÂ integrityÂ testÂ contentÂ forÂ "Â +Â serviceNameÂ +Â "Â service.Â "Â + Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â "ThisÂ contentÂ shouldÂ maintainÂ itsÂ integrityÂ duringÂ processing."; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â CalculateÂ inputÂ hash Â Â Â Â Â Â Â Â MessageDigestÂ md5Â =Â MessageDigest.getInstance("MD5"); Â Â Â Â Â Â Â Â StringÂ inputHashÂ =Â bytesToHex(md5.digest(testContent.getBytes(StandardCharsets.UTF_8))); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â PipeDocÂ inputDocÂ =Â PipeDoc.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setId("integrity-test-"Â +Â serviceName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setTitle("DataÂ integrityÂ test") Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setBody(testContent) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ProcessRequestÂ request; Â Â Â Â Â Â Â Â ifÂ ("embedder".equals(serviceName))Â { Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createEmbedderProcessRequest("integrity-test",Â serviceNameÂ +Â "-step",Â inputDoc); Â Â Â Â Â Â Â Â }Â elseÂ { Â Â Â Â Â Â Â Â Â Â Â Â requestÂ =Â createProcessRequest("integrity-test",Â serviceNameÂ +Â "-step",Â inputDoc); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ProcessResponseÂ responseÂ =Â client.processData(request); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ifÂ (!response.getSuccess())Â { Â Â Â Â Â Â Â Â Â Â Â Â returnÂ newÂ DataIntegrityResult(false,Â false,Â true,Â inputHash,Â ""); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â StringÂ outputContentÂ =Â response.getOutputDoc().getBody(); Â Â Â Â Â Â Â Â StringÂ outputHashÂ =Â bytesToHex(md5.digest(outputContent.getBytes(StandardCharsets.UTF_8))); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â ForÂ mostÂ services,Â contentÂ shouldÂ beÂ preservedÂ exactlyÂ (exceptÂ embedderÂ whichÂ addsÂ embeddings) Â Â Â Â Â Â Â Â booleanÂ integrityMaintainedÂ =Â "embedder".equals(serviceName)Â ||Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â outputContent.contains(testContent)Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â inputHash.equals(outputHash); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â booleanÂ checksumValidÂ =Â inputHash.equals(outputHash)Â ||Â "embedder".equals(serviceName); Â Â Â Â Â Â Â Â booleanÂ dataCorruptedÂ =Â outputContent.isEmpty()Â ||Â outputContent.contains("\u0000"); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â returnÂ newÂ DataIntegrityResult(integrityMaintained,Â checksumValid,Â dataCorrupted,Â inputHash,Â outputHash); Â Â Â Â } Â Â Â Â privateÂ booleanÂ containsSensitiveInformation(StringÂ text)Â { Â Â Â Â Â Â Â Â ifÂ (textÂ ==Â null)Â returnÂ false; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â StringÂ lowerTextÂ =Â text.toLowerCase(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â //Â CheckÂ forÂ variousÂ typesÂ ofÂ sensitiveÂ information Â Â Â Â Â Â Â Â returnÂ lowerText.contains("password")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("secret")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("privateÂ key")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("apiÂ key")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("token")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("creditÂ card")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("ssn")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("socialÂ security")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("/etc/passwd")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("c:\\windows")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("database")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("connectionÂ string")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("stackÂ trace")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("exception")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("errorÂ atÂ line")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("fileÂ notÂ found")Â || Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lowerText.contains("accessÂ denied"); Â Â Â Â } Â Â Â Â privateÂ StringÂ bytesToHex(byte[]Â bytes)Â { Â Â Â Â Â Â Â Â StringBuilderÂ resultÂ =Â newÂ StringBuilder(); Â Â Â Â Â Â Â Â forÂ (byteÂ bÂ :Â bytes)Â { Â Â Â Â Â Â Â Â Â Â Â Â result.append(String.format("%02x",Â b)); Â Â Â Â Â Â Â Â } Â Â Â Â Â Â Â Â returnÂ result.toString(); Â Â Â Â } Â Â Â Â privateÂ ProcessRequestÂ createProcessRequest(StringÂ pipelineName,Â StringÂ stepName,Â PipeDocÂ document)Â { Â Â Â Â Â Â Â Â ServiceMetadataÂ metadataÂ =Â ServiceMetadata.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setPipelineName(pipelineName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setPipeStepName(stepName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setStreamId("security-stream-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setCurrentHopNumber(1) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ProcessConfigurationÂ configÂ =Â ProcessConfiguration.newBuilder().build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â returnÂ ProcessRequest.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setDocument(document) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setConfig(config) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMetadata(metadata) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â } Â Â Â Â privateÂ ProcessRequestÂ createEmbedderProcessRequest(StringÂ pipelineName,Â StringÂ stepName,Â PipeDocÂ document)Â { Â Â Â Â Â Â Â Â ServiceMetadataÂ metadataÂ =Â ServiceMetadata.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setPipelineName(pipelineName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setPipeStepName(stepName) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setStreamId("security-stream-"Â +Â System.currentTimeMillis()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setCurrentHopNumber(1) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â StructÂ embedderConfigÂ =Â Struct.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .putFields("embeddingModel",Â Value.newBuilder().setStringValue("ALL_MINILM_L6_V2").build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .putFields("fieldsToEmbed",Â Value.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setListValue(com.google.protobuf.ListValue.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .addValues(Value.newBuilder().setStringValue("title").build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .addValues(Value.newBuilder().setStringValue("body").build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build()) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â ProcessConfigurationÂ configÂ =Â ProcessConfiguration.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setCustomJsonConfig(embedderConfig) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â returnÂ ProcessRequest.newBuilder() Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setDocument(document) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setConfig(config) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .setMetadata(metadata) Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .build(); Â Â Â Â } Â Â Â Â privateÂ PipeStepProcessorGrpc.PipeStepProcessorBlockingStubÂ getClientForService(StringÂ serviceName)Â { Â Â Â Â Â Â Â Â switchÂ (serviceName)Â { Â Â Â Â Â Â Â Â Â Â Â Â caseÂ "tika":Â returnÂ tikaClient; Â Â Â Â Â Â Â Â Â Â Â Â caseÂ "chunker":Â returnÂ chunkerClient; Â Â Â Â Â Â Â Â Â Â Â Â caseÂ "embedder":Â returnÂ embedderClient; Â Â Â Â Â Â Â Â Â Â Â Â caseÂ "echo":Â returnÂ echoClient; Â Â Â Â Â Â Â Â Â Â Â Â default:Â throwÂ newÂ IllegalArgumentException("UnknownÂ service:Â "Â +Â serviceName); Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â //Â InnerÂ classesÂ forÂ testÂ results Â Â Â Â privateÂ staticÂ classÂ BufferOverflowTestResultÂ { Â Â Â Â Â Â Â Â finalÂ StringÂ testDescription; Â Â Â Â Â Â Â Â finalÂ booleanÂ handledGracefully; Â Â Â Â Â Â Â Â finalÂ booleanÂ causedCrash; Â Â Â Â Â Â Â Â finalÂ longÂ responseTime; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â BufferOverflowTestResult(StringÂ testDescription,Â booleanÂ handledGracefully,Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â booleanÂ causedCrash,Â longÂ responseTime)Â { Â Â Â Â Â Â Â Â Â Â Â Â this.testDescriptionÂ =Â testDescription; Â Â Â Â Â Â Â Â Â Â Â Â this.handledGracefullyÂ =Â handledGracefully; Â Â Â Â Â Â Â Â Â Â Â Â this.causedCrashÂ =Â causedCrash; Â Â Â Â Â Â Â Â Â Â Â Â this.responseTimeÂ =Â responseTime; Â Â Â Â Â Â Â Â } Â Â Â Â } Â Â Â Â privateÂ staticÂ classÂ DataIntegrityResultÂ { Â Â Â Â Â Â Â Â finalÂ booleanÂ integrityMaintained; Â Â Â Â Â Â Â Â finalÂ booleanÂ checksumValid; Â Â Â Â Â Â Â Â finalÂ booleanÂ dataCorrupted; Â Â Â Â Â Â Â Â finalÂ StringÂ inputHash; Â Â Â Â Â Â Â Â finalÂ StringÂ outputHash; Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â DataIntegrityResult(booleanÂ integrityMaintained,Â booleanÂ checksumValid,Â booleanÂ dataCorrupted, Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â StringÂ inputHash,Â StringÂ outputHash)Â { Â Â Â Â Â Â Â Â Â Â Â Â this.integrityMaintainedÂ =Â integrityMaintained; Â Â Â Â Â Â Â Â Â Â Â Â this.checksumValidÂ =Â checksumValid; Â Â Â Â Â Â Â Â Â Â Â Â this.dataCorruptedÂ =Â dataCorrupted; Â Â Â Â Â Â Â Â Â Â Â Â this.inputHashÂ =Â inputHash; Â Â Â Â Â Â Â Â Â Â Â Â this.outputHashÂ =Â outputHash; Â Â Â Â Â Â Â Â } Â Â Â Â } }bÇ

loc982
6
x_tika_encodingdetectorUniversalEncodingDetector
q
x_tika_parsed_by_full_setTRorg.apache.tika.parser.DefaultParser; org.apache.tika.parser.code.SourceCodeParser
$
content_typetext/x-java-source

content_encodingUTF-8
"
x_tika_detectedencodingUTF-8
;
resourcename+)source-code/SecurityIntegrationTests.java
h
x_tika_parsed_byTRorg.apache.tika.parser.DefaultParser; org.apache.tika.parser.code.SourceCodeParserjÛÀ
$ed58ce8e-09e1-48a1-8638-cdebd033d8d0bodystandard_500_50*chunks_chunker_standard_500_502Û	
?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_0¹
ßsource - code / SecurityIntegrationTests. java source - code / SecurityIntegrationTests. javapackage com. rokkon. integration. security; import com. google. protobuf. ByteString; import com. google. protobuf. Empty; import com. google. protobuf. Struct; import com. google. protobuf. Value; import com. rokkon. search. model. *; import com. rokkon. search. sdk. *; import io. grpc. ManagedChannel; import io. grpc. ManagedChannelBuilder; import io. grpc. Status; import io. grpc.?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_0  (¶:standard_500_50" 
average_word_length	F¶óýÔx@"$
potential_heading_score	        "
sentence_count	     €@@"$
alphanumeric_percentage	 ‰°áé•è?"h
punctuation_countsR*P

*	       @

;	      $@

-	       @

.	     €@@

/	       @"!
uppercase_percentage	“V-¢?""
whitespace_percentage	qà-À?"
list_item_indicator  "

word_count	     €Z@"$
average_sentence_length	QÚ|a²	@"
vocabulary_density	ßà“©‚Ñ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk "
character_count	     ð}@"
relative_position	        2Ú	
?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_1Æ
ë; import io. grpc. Status; import io. grpc. StatusRuntimeException; import io. quarkus. test. junit. QuarkusIntegrationTest; import org. junit. jupiter. api. *; import org. slf 4 j. Logger; import org. slf 4 j. LoggerFactory; import java. nio. charset. StandardCharsets; import java. security. MessageDigest; import java. util. *; import java. util. concurrent. TimeUnit; import java. util. regex. Pattern; import static org. junit. jupiter. api. Assertions. *; / ** * Comprehensive security?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_1 (Ó:standard_500_50" 
average_word_length	°çŒ(m@"$
potential_heading_score	š™™™™™É?"
sentence_count	     €A@"$
alphanumeric_percentage	?5^ºIè?"X
punctuation_countsB*@

*	      @

;	      *@

.	      A@

/	      ð?"!
uppercase_percentage	ÆÜµ„|Ð£?""
whitespace_percentage	î|?5^ºÁ?"
list_item_indicator  "

word_count	     À\@"$
average_sentence_length	Ó¼ãI
@"
vocabulary_density	Õxé&1Ô?"
digit_percentage		ž^)Ëp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     °~@"
relative_position	F%uš‹?2Ž

?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_2É
î. api. Assertions. *; / ** * Comprehensive security integration tests to validate input validation, malicious content handling, * data integrity verification, and security boundaries across all services. * * These tests verify: * - Input validation and sanitization * - Malicious content detection and handling * - Data integrity verification and checksums * - Security boundary enforcement * - Buffer overflow and injection attack prevention * - Content filtering and blacklist enforcement * -?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_2 ¤(™
:standard_500_50" 
average_word_length	vàœ¥=@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	QÚ|a2é?"ˆ
punctuation_countsr*p

*	      ,@

:	      ð?

;	      ð?

,	      @

-	      @

.	      @

/	      ð?"!
uppercase_percentage	Â&S£’?""
whitespace_percentage	"lxz¥,Ã?"
list_item_indicator  "

word_count	     ÀT@"$
average_sentence_length	š™™™™™0@"
vocabulary_density	ŒÛh oâ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position		Šcîš?2¶

?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_3Ï
ô- Content filtering and blacklist enforcement * - Secure error handling without information leakage * - Authentication and authorization patterns * - Secure data transmission and storage * - Privacy and data protection compliance * / @ QuarkusIntegrationTest @ TestMethodOrder (MethodOrderer. OrderAnnotation. class) @ Disabled (" Requires full gRPC service infrastructure for comprehensive security testing against malicious inputs and attacks ") class SecurityIntegrationTests {private static final?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_3 è	(Û:standard_500_50" 
average_word_length	 ‰°áéÕ@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	‘í|?5^ê?"ª
punctuation_counts“*

@	      @

"	       @

(	       @

)	       @

*	      @

{	      ð?

-	      @

.	       @

/	      ð?"!
uppercase_percentage	Zd;ßO§?""
whitespace_percentage	¤p=
×£À?"
list_item_indicator "

word_count	     @R@"$
average_sentence_length	¾Á&SU8@"
vocabulary_density		ž^)Ëæ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	ÓMbX9¤?2µ
?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_4Î
ó{private static final Logger LOG = LoggerFactory. getLogger (SecurityIntegrationTests. class); // Security test patterns private static final List < String > SQL _ INJECTION _ PATTERNS = Arrays. asList (" '; DROP TABLE users; -- ", " ' OR ' 1 ' = ' 1 ", " ' UNION SELECT * FROM sensitive _ data -- ", " admin ' -- ", " ' OR 1 = 1 # "); private static final List < String > XSS _ PATTERNS = Arrays. asList (" < script > alert (' XSS ') < / script > ", " javascript: alert (' XSS ') ", " < img src = x?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_4 Â(×:standard_500_50" 
average_word_length	¹ü‡ôÛW@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	ÆÜµ„|Ðã?"ª
punctuation_counts“*

"	      .@

#	      ð?

'	      (@

(	      @

)	      @

*	      ð?

,	      @

-	      @

.	      @

/	      @

:	      ð?

{	      ð?

;	      @

<	      @

=	      @

>	      @

_	      @"!
uppercase_percentage	´Yõ¹ÚŠÅ?""
whitespace_percentage	û\mÅþ²Ë?"
list_item_indicator  "

word_count	     À`@"$
average_sentence_length	ÍÌÌÌÌÌ:@"
vocabulary_density	NÑ‘\þCÚ?"
digit_percentage	ü©ñÒMb€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position		Šcîª?2Ó
?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_5Ì
ñ" javascript: alert (' XSS ') ", " < img src = x onerror = alert (' XSS ') > ", " < svg onload = alert (' XSS ') > ", " '; alert (' XSS '); // "); private static final List < String > COMMAND _ INJECTION _ PATTERNS = Arrays. asList ("; rm - rf / ", " | cat / etc / passwd ", " && whoami ", " ` rm - rf / ` ", " $ (cat / etc / passwd) "); private static final List < String > PATH _ TRAVERSAL _ PATTERNS = Arrays. asList (" .. / .. / .. / etc / passwd ", " .. \\ .. \\ .. \\ windows \\ system 32 \\?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_5 ª(¬:standard_500_50" 
average_word_length	ºk	ù ç@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	ÓMbX9à?"Ê
punctuation_counts³*°

`	       @

"	      5@

$	      ð?

&	       @

'	      "@

(	      @

)	      @

,	       @

-	       @

.	      ,@

/	      (@

:	      ð?

;	      @

<	      @

|	      ð?

\	      $@

=	      @

>	      @

_	      @"!
uppercase_percentage	çŒ(í¾À?""
whitespace_percentage	ÓMbX9Ð?"
list_item_indicator  "

word_count	      c@"$
average_sentence_length	¨WÊ2Äq1@"
vocabulary_density	Dioð…ÉÔ?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	*©ÐDØ°?2ï

?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_6È
í/ passwd ", " .. \\ .. \\ .. \\ windows \\ system 32 \\ config \\ sam ", " .... // .... // .... // etc / passwd ", " % 2 e % 2 e % 2 f % 2 e % 2 e % 2 f % 2 e % 2 e % 2 fetc % 2 fpasswd ", " .. % 252 f .. % 252 f .. % 252 fetc % 252 fpasswd "); // Content security patterns private static final Pattern SUSPICIOUS _ PATTERN = Pattern. compile (" (? i) (password | secret | key | token | auth | admin | root | exploit | hack | inject | malware | virus) ", Pattern. CASE _ INSENSITIVE | Pattern.?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_6 û(¿:standard_500_50" 
average_word_length	©¤N@á@"$
potential_heading_score	        "
sentence_count	      (@"$
alphanumeric_percentage	¿}8gDá?"ê
punctuation_countsÓ*Ð

"	      &@

%	      ,@

(	      @

)	      @

,	      @

.	      ;@

/	      $@

;	      ð?

\	      (@

|	      (@

=	      ð?

_	       @

?	      ð?"!
uppercase_percentage	DúíëÀ9³?""
whitespace_percentage	ÓMbX9Ð?"
list_item_indicator  "

word_count	      a@"$
average_sentence_length	     €'@"
vocabulary_density	P—nƒØ?"
digit_percentage	åa¡Ö4ï¨?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     Ð~@"
relative_position	Â†§WÊ2´?2Â

?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_7Ë
ð) ", Pattern. CASE _ INSENSITIVE | Pattern. MULTILINE); private static final long MAX _ CONTENT _ SIZE = 100 * 1024 * 1024; // 100 MB private static final int MAX _ FIELD _ LENGTH = 10000; private ManagedChannel tikaChannel; private ManagedChannel chunkerChannel; private ManagedChannel embedderChannel; private ManagedChannel echoChannel; private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub tikaClient; private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub chunkerClient; private?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_7 ‘(°:standard_500_50" 
average_word_length	w-!ô¬@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	Þ	Šcê?"º
punctuation_counts£* 

"	      ð?

)	       @

*	       @

;	      "@

,	      ð?

|	      ð?

=	       @

.	      @

_	      @

/	       @"!
uppercase_percentage	0»'µÆ?""
whitespace_percentage	°çŒ(í½?"
list_item_indicator  "

word_count	     €R@"$
average_sentence_length	š™™™™™-@"
vocabulary_density	      à?"
digit_percentage	@¤ß¾œ£?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	k+ö—Ý“·?2½

?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_8Æ
ëchunkerClient; private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub embedderClient; private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub echoClient; @ BeforeEach void setUp () {// Set up gRPC channels for security testing tikaChannel = ManagedChannelBuilder. forAddress (" localhost ", 9000). usePlaintext (). build (); chunkerChannel = ManagedChannelBuilder. forAddress (" localhost ", 9001). usePlaintext (). build (); embedderChannel = ManagedChannelBuilder. forAddress ("?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_8 —(œ :standard_500_50" 
average_word_length	ÌH¿}@"$
potential_heading_score	        "
sentence_count	      $@"$
alphanumeric_percentage	8gDioðé?"º
punctuation_counts£* 

@	      ð?

"	      @

(	       @

)	      @

;	      @

{	      ð?

,	       @

=	      @

.	      "@

/	       @"!
uppercase_percentage	HPüs·?""
whitespace_percentage	È˜»–º?"
list_item_indicator  "

word_count	     €S@"$
average_sentence_length	333333@"
vocabulary_density	ð§ÆK7‰Ý?"
digit_percentage	Åþ²{ò°?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     °~@"
relative_position	ÐDØðôº?2“

?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_9	Î
ó= ManagedChannelBuilder. forAddress (" localhost ", 9002). usePlaintext (). build (); echoChannel = ManagedChannelBuilder. forAddress (" localhost ", 9003). usePlaintext (). build (); tikaClient = PipeStepProcessorGrpc. newBlockingStub (tikaChannel); chunkerClient = PipeStepProcessorGrpc. newBlockingStub (chunkerChannel); embedderClient = PipeStepProcessorGrpc. newBlockingStub (embedderChannel); echoClient = PipeStepProcessorGrpc. newBlockingStub (echoChannel); LOG. info (" Security integration?7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_9 ù(’$:standard_500_50" 
average_word_length	 /Ý$†@"$
potential_heading_score	š™™™™™É?"
sentence_count	      (@"$
alphanumeric_percentage	eâX·é?"ˆ
punctuation_countsr*p

"	      @

(	      &@

)	      $@

;	      @

,	       @

=	      @

.	      &@"!
uppercase_percentage	ÌH¿}¸?""
whitespace_percentage	ÌH¿}¸?"
list_item_indicator  "

word_count	      U@"$
average_sentence_length	      @"
vocabulary_density	ioð…ÉTÕ?"
digit_percentage	ü©ñÒMb?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	¬­Ø_vO¾?2Õ

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_10
Í
ñ); LOG. info (" Security integration test environment initialized ");} @ AfterEach void tearDown () throws InterruptedException {if (tikaChannel! = null) {tikaChannel. shutdown (); tikaChannel. awaitTermination (5, TimeUnit. SECONDS);} if (chunkerChannel! = null) {chunkerChannel. shutdown (); chunkerChannel. awaitTermination (5, TimeUnit. SECONDS);} if (embedderChannel! = null) {embedderChannel. shutdown (); embedderChannel. awaitTermination (5, TimeUnit. SECONDS);} if (echoChannel! = null) {@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_10 á#(â(:standard_500_50" 
average_word_length	ƒÀÊ¡E¶@"$
potential_heading_score	        "
sentence_count	      &@"$
alphanumeric_percentage	®Gázè?"Ê
punctuation_counts³*°

@	      ð?

!	      @

"	       @

(	      (@

)	      *@

;	       @

{	      @

,	      @

}	      @

=	      @

.	      $@"!
uppercase_percentage	®¶bÙ=¹?""
whitespace_percentage	>èÙ¬ú\½?"
list_item_indicator  "

word_count	     À[@"$
average_sentence_length	­iÞqŠ.$@"
vocabulary_density	|ò°PkšÓ?"
digit_percentage	ú~j¼t“x?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	*©ÐDØÀ?2¸
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_11Ð
ô);} if (echoChannel! = null) {echoChannel. shutdown (); echoChannel. awaitTermination (5, TimeUnit. SECONDS);}} @ Test @ Order (1) @ DisplayName (" SQL Injection Attack Prevention ") void testSqlInjectionPrevention () {LOG. info (" Testing SQL injection attack prevention "); Map < String, Integer > serviceVulnerabilities = new HashMap < > (); int totalInjectionAttempts = 0; int blockedAttempts = 0; for (String injectionPattern: SQL _ INJECTION _ PATTERNS) {totalInjectionAttempts ++; // Test each@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_11 ´((µ-:standard_500_50" 
average_word_length	¥½Á&@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	Zd;ßOç?"ª
punctuation_counts“*

@	      @

!	      ð?

"	      @

(	      "@

)	      $@

+	       @

,	       @

.	      @

/	       @

:	      ð?

;	       @

{	      @

<	       @

}	      @

=	      @

>	       @

_	       @"!
uppercase_percentage	ôýÔxé&Á?""
whitespace_percentage	ìQ¸…ëÁ?"
list_item_indicator  "

word_count	     ÀZ@"$
average_sentence_length	ffffff5@"
vocabulary_density	ÎˆÒÞàá?"
digit_percentage	ü©ñÒMb€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	ö—Ý“‡…Â?2Ö

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_12Î
ò++; // Test each service with SQL injection patterns if (testServiceWithMaliciousInput (tikaClient, " tika ", injectionPattern, " SQL Injection " )) {blockedAttempts ++;} else {serviceVulnerabilities. merge (" tika ", 1, Integer :: sum);} if (testServiceWithMaliciousInput (chunkerClient, " chunker ", injectionPattern, " SQL Injection " )) {blockedAttempts ++;} else {serviceVulnerabilities. merge (" chunker ", 1, Integer :: sum);} if (testServiceWithMaliciousInput (embedderClient, " embedder ",@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_12 -(°2:standard_500_50" 
average_word_length	q=
×£p@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	ƒÀÊ¡E¶ç?"Ê
punctuation_counts³*°

"	      ,@

(	       @

)	      @

:	      @

+	      @

;	      @

{	      @

,	      (@

}	      @

.	       @

/	       @"!
uppercase_percentage	§èH.ÿ±?""
whitespace_percentage	¬Zd;ß¿?"
list_item_indicator  "

word_count	      Y@"$
average_sentence_length	ßà“©ª@@"
vocabulary_density	
×£p=
×?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	Kê46Ä?2à

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_13È
ì(embedderClient, " embedder ", injectionPattern, " SQL Injection " )) {blockedAttempts ++;} else {serviceVulnerabilities. merge (" embedder ", 1, Integer :: sum);} if (testServiceWithMaliciousInput (echoClient, " echo ", injectionPattern, " SQL Injection " )) {blockedAttempts ++;} else {serviceVulnerabilities. merge (" echo ", 1, Integer :: sum);} totalInjectionAttempts + = 3; // Added 3 more services} double blockingRate = (double) blockedAttempts / totalInjectionAttempts; // Verify SQL@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_13 •2(»7:standard_500_50" 
average_word_length	OjMó@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	`vOjç?"Ú
punctuation_countsÃ*À

"	      (@

(	      @

)	      @

:	      @

{	      @

+	      @

;	      @

,	      $@

}	      @

=	       @

.	       @

/	      @"!
uppercase_percentage	Å1w-±?""
whitespace_percentage	,Ôšæ§À?"
list_item_indicator  "

word_count	     @Y@"$
average_sentence_length	!ôlVÕ@@"
vocabulary_density	?ÆÜµØ?"
digit_percentage	‚âÇ˜»–€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     À~@"
relative_position	Ÿ<,ÔšæÅ?2—
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_14Ï
ó; // Verify SQL injection protection assertTrue (blockingRate > = 0. 90, String. format (" SQL injection blocking rate %. 2 f %% below minimum 90 %% ", blockingRate * 100 )); // Check for service - specific vulnerabilities for (Map. Entry < String, Integer > entry: serviceVulnerabilities. entrySet ()) {String serviceName = entry. getKey (); Integer vulnerabilityCount = entry. getValue (); assertTrue (vulnerabilityCount < = 1, String. format (" % s service has % d SQL injection vulnerabilities "@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_14 œ7(ñ;:standard_500_50" 
average_word_length	      @"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	Ház®Gç?"Š
punctuation_countsó*ð

"	      @

%	      @

(	       @

)	      @

*	      ð?

,	      @

-	      ð?

.	       @

/	      @

:	      ð?

;	      @

{	      ð?

<	       @

=	      @

>	       @"!
uppercase_percentage	Ú¬ú\mÅ®?""
whitespace_percentage	lxz¥,CÄ?"
list_item_indicator  "

word_count	     @Z@"$
average_sentence_length	…|Ð³YU'@"
vocabulary_density	eª`TR'à?"
digit_percentage	{®Gáz”?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	k+ö—Ý“Ç?2™
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_15Ñ
õ(" % s service has % d SQL injection vulnerabilities ", serviceName, vulnerabilityCount ));} LOG. info (" âœ… SQL injection prevention test completed - Blocking rate: {:. 2 f} %, Vulnerabilities: {} ", blockingRate * 100, serviceVulnerabilities);} @ Test @ Order (2) @ DisplayName (" Cross - Site Scripting (XSS) Prevention ") void testXssPreventionAndSanitization () {LOG. info (" Testing XSS prevention and content sanitization "); int totalXssAttempts = 0; int sanitizedResponses = 0; List < String@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_15 À;(€@:standard_500_50" 
average_word_length	æ®%äƒ@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	œÄ °rhç?"Š
punctuation_countsó*ð

@	      @

"	       @

%	      @

(	      @

)	       @

*	      ð?

,	      @

-	       @

.	      @

:	      @

;	      @

{	      @

<	      ð?

}	      @

=	       @"!
uppercase_percentage	<½R–!Žµ?""
whitespace_percentage	Ì]KÈ=Ã?"
list_item_indicator  "

word_count	     @[@"$
average_sentence_length	     @;@"
vocabulary_density	Ãdª`TRá?"
digit_percentage	yé&1¬Œ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	¿}8gDÉ?2•
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_16Í
ñint sanitizedResponses = 0; List < String > unsanitizedResponses = new ArrayList < > (); for (String xssPattern: XSS _ PATTERNS) {totalXssAttempts ++; // Test XSS pattern handling in document content PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" xss - test - " + System. currentTimeMillis ()). setTitle (" XSS Test: " + xssPattern). setBody (" Content with XSS attempt: " + xssPattern). build (); ProcessRequest request = createProcessRequest (" xss - security - test ", " echo - step ",@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_16 Ò?(ÔD:standard_500_50" 
average_word_length	7À[ A@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	ÓÞà“©æ?"Š
punctuation_countsó*ð

"	      $@

(	      "@

)	       @

+	      @

,	       @

-	      @

.	      @

/	       @

:	      @

;	      @

{	      ð?

<	       @

=	      @

>	       @

_	      ð?"!
uppercase_percentage	NÑ‘\þCº?""
whitespace_percentage	w¾Ÿ/ÝÄ?"
list_item_indicator  "

word_count	     €[@"$
average_sentence_length	ËÇº¸m/@"
vocabulary_density	_˜LŒJà?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	‹lçû©ñÊ?2
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_17È
ì(" xss - security - test ", " echo - step ", maliciousDoc); try {ProcessResponse response = echoClient. processData (request); if (response. getSuccess ()) {String responseTitle = response. getOutputDoc (). getTitle (); String responseBody = response. getOutputDoc (). getBody (); // Check if XSS patterns were sanitized or escaped boolean titleSanitized =! responseTitle. contains (" < script > ") &&! responseTitle. contains (" javascript: ") &&! responseTitle. contains (" onerror = ") &&!@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_17 ³D(­J:standard_500_50" 
average_word_length	¡Ö4ï8E@"$
potential_heading_score	        "
sentence_count	      $@"$
alphanumeric_percentage	à¾œ3¢æ?"Š
punctuation_countsó*ð

!	      @

"	      $@

&	      @

(	      &@

)	      &@

,	       @

-	      @

.	      "@

/	       @

:	      ð?

;	      @

{	       @

<	      ð?

=	      @

>	      ð?"!
uppercase_percentage	ðHPü¨?""
whitespace_percentage	}Ð³Yõ¹Â?"
list_item_indicator  "

word_count	     À[@"$
average_sentence_length	333333&@"
vocabulary_density	äÉå?Ü?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     À~@"
relative_position	à¾œ3¢Ì?2§
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_18Ï
ó") &&! responseTitle. contains (" onload = "); boolean bodySanitized =! responseBody. contains (" < script > ") &&! responseBody. contains (" javascript: ") &&! responseBody. contains (" onerror = ") &&! responseBody. contains (" onload = "); if (titleSanitized && bodySanitized) {sanitizedResponses ++;} else {unsanitizedResponses. add (" Pattern: " + xssPattern + " - Title: " + responseTitle + " - Body: " + responseBody);}} else {// Service rejected malicious content - also counts as protection@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_18 üI(¯Q:standard_500_50" 
average_word_length	±¿ìž<,@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	ÌîÉÃB­å?"š
punctuation_countsƒ*€

!	      @

"	      1@

&	      $@

(	      @

)	       @

+	      @

-	      @

.	      @

/	       @

:	      @

;	      @

{	      @

<	      ð?

=	      @

}	      @

>	      ð?"!
uppercase_percentage	½R–!Žu¡?""
whitespace_percentage	t$—ÿ~Ã?"
list_item_indicator  "

word_count	      ]@"$
average_sentence_length	5ï8EG’0@"
vocabulary_density	Þ“‡…ZÓØ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	¬­Ø_vOÎ?2¸
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_19Ð
ômalicious content - also counts as protection sanitizedResponses ++;}} catch (StatusRuntimeException e) {// Service blocked the request - this is good sanitizedResponses ++; LOG. debug (" XSS pattern blocked by service: {} ", xssPattern);}} double sanitizationRate = (double) sanitizedResponses / totalXssAttempts; assertTrue (sanitizationRate > = 0. 95, String. format (" XSS sanitization rate %. 2 f %% below minimum 95 %% ", sanitizationRate * 100 )); assertTrue (unsanitizedResponses. size () < =@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_19 ƒQ(ªV:standard_500_50" 
average_word_length	)\Âõ(@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	X9´Èv¾ç?"ª
punctuation_counts“*

"	      @

%	      @

(	      @

)	      @

*	      ð?

+	      @

,	      @

-	       @

.	      @

/	      @

:	      ð?

;	      @

{	       @

<	      ð?

}	      @

=	      @

>	      ð?"!
uppercase_percentage	9´Èv¾Ÿª?""
whitespace_percentage	“V-Â?"
list_item_indicator  "

word_count	      Y@"$
average_sentence_length	B>èÙ¬ª0@"
vocabulary_density	×£p=
×ã?"
digit_percentage	;ßO—n’?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	      Ð?2˜
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_20Ð
ôassertTrue (unsanitizedResponses. size () < = 1, String. format (" Too many unsanitized XSS responses: % s ", unsanitizedResponses )); LOG. info (" âœ… XSS prevention test completed - Sanitization rate: {:. 2 f} %, Unsanitized: {} ", sanitizationRate * 100, unsanitizedResponses. size ());} @ Test @ Order (3) @ DisplayName (" Command Injection Attack Prevention ") void testCommandInjectionPrevention () {LOG. info (" Testing command injection attack prevention "); int totalCommandAttempts = 0; int@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_20 ‚V(ºZ:standard_500_50" 
average_word_length	6«>W[1@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	¥½Á&Sç?"Š
punctuation_countsó*ð

@	      @

"	       @

%	       @

(	      "@

)	      "@

*	      ð?

,	      @

-	      ð?

.	      @

:	      @

;	      @

{	      @

<	      ð?

=	       @

}	      @"!
uppercase_percentage	§èH.ÿ±?""
whitespace_percentage	ûËîÉÃÂ?"
list_item_indicator  "

word_count	     @[@"$
average_sentence_length	jÞqŠŽ$/@"
vocabulary_density	‚sF”öá?"
digit_percentage	ÿ!ýöuàŒ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	*©ÐDØÐ?2‡
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_21Ï
óint totalCommandAttempts = 0; int blockedCommands = 0; Map < String, List < String >> serviceFailures = new HashMap < > (); for (String commandPattern: COMMAND _ INJECTION _ PATTERNS) {totalCommandAttempts ++; // Test command injection in document processing String maliciousContent = " Document content with command injection: " + commandPattern; // Test Tika service (most likely to execute commands on files) if (testTikaServiceWithMaliciousCommand (commandPattern )) {blockedCommands ++;} else {@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_21 ’Z(Š_:standard_500_50" 
average_word_length	ú~j¼tS@"$
potential_heading_score	333333Ó?"
sentence_count	      ð?"$
alphanumeric_percentage	9´Èv¾Ÿè?"ú
punctuation_countsã*à

"	       @

(	      @

)	      @

+	      @

,	      ð?

/	      @

:	       @

;	      @

{	      @

<	      @

=	      @

}	      ð?

>	      @

_	       @"!
uppercase_percentage	[B>èÙ¬º?""
whitespace_percentage	Ýµ„|Ð³Á?"
list_item_indicator  "

word_count	     @V@"$
average_sentence_length	     @V@"
vocabulary_density	`vOjã?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	 ø1æ®Ñ?2
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_22Ç
ëblockedCommands ++;} else {serviceFailures. computeIfAbsent (" tika ", k - > new ArrayList < > ()). add (commandPattern);} // Test other services for (String serviceName: Arrays. asList (" chunker ", " embedder ", " echo " )) {PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" cmd - injection - " + System. currentTimeMillis ()). setTitle (" Command injection test "). setBody (maliciousContent). build (); ProcessRequest request = createProcessRequest (" command - injection - test ",@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_22 ä^(‡d:standard_500_50" 
average_word_length	çŒ(í@"$
potential_heading_score	        "
sentence_count	      $@"$
alphanumeric_percentage	³{ò°Pkæ?"Š
punctuation_countsó*ð

"	      ,@

(	      (@

)	      &@

+	      @

,	      @

-	      @

.	      "@

/	       @

:	      ð?

;	      @

{	       @

<	      ð?

}	       @

=	       @

>	       @"!
uppercase_percentage	*:’ËH¯?""
whitespace_percentage	îëÀ9#JÃ?"
list_item_indicator  "

word_count	     À[@"$
average_sentence_length	333333&@"
vocabulary_density	¾Ÿ/Ý$à?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     °~@"
relative_position	ºI+‡Ò?2ä

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_23Ì
ð= createProcessRequest (" command - injection - test ", serviceName + " - step ", maliciousDoc); try {PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client = getClientForService (serviceName); if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" command - injection - test ", serviceName + " - step ", maliciousDoc);} ProcessResponse response = client. processData (request); // Verify no command execution artifacts in response if (response. getSuccess ()) {@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_23 Øc(†i:standard_500_50" 
average_word_length	aTR' ‰@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	þÔxé&1è?"Ú
punctuation_countsÃ*À

"	      $@

(	       @

)	       @

+	       @

;	      @

{	      @

,	      @

=	      @

-	      @

}	      ð?

.	      @

/	       @"!
uppercase_percentage	!°rh‘í¬?""
whitespace_percentage	øSã¥›ÄÀ?"
list_item_indicator  "

word_count	     @W@"$
average_sentence_length	š™™™™™2@"
vocabulary_density	HPüs×Ú?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	 AñcÌ]Ó?2ñ

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_24É
íif (response. getSuccess ()) {String responseContent = response. getOutputDoc (). getBody (); // Check for signs of command execution boolean hasExecutionArtifacts = responseContent. contains (" root: ") || // passwd file responseContent. contains (" uid = ") || // whoami output responseContent. contains (" / bin / ") || // system paths responseContent. contains (" administrator "); // windows user if (! hasExecutionArtifacts) {blockedCommands ++;} else {serviceFailures. computeIfAbsent (@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_24 ëh(Ço:standard_500_50" 
average_word_length	]þCúí+@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	Ì]KÈ=ç?"ê
punctuation_countsÓ*Ð

!	      ð?

"	       @

(	      $@

)	      "@

+	       @

.	       @

/	      (@

:	      ð?

{	      @

;	      @

|	      @

=	      @

}	      ð?"!
uppercase_percentage	ƒÀÊ¡E¶£?""
whitespace_percentage	»'µ¦Á?"
list_item_indicator  "

word_count	     ÀX@"$
average_sentence_length	      &@"
vocabulary_density	QÚ|aÞ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     Ð~@"
relative_position	Kê46Ô?2†
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_25¾
âserviceFailures. computeIfAbsent (serviceName, k - > new ArrayList < > ()). add (commandPattern);}} else {// Service rejected malicious content blockedCommands ++;}} catch (StatusRuntimeException e) {// Service blocked the request blockedCommands ++;} totalCommandAttempts ++;}} double commandBlockingRate = (double) blockedCommands / totalCommandAttempts; assertTrue (commandBlockingRate > = 0. 90, String. format (" Command injection blocking rate %. 2 f %% below minimum 90 %% ",@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_25 ¨o(­u:standard_500_50" 
average_word_length	ŒÛh o@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	Õxé&1è?"Š
punctuation_countsó*ð

"	       @

%	      @

(	      @

)	      @

+	      @

,	      @

-	      ð?

.	      @

/	      @

;	      @

{	       @

<	      ð?

}	      @

=	       @

>	      @"!
uppercase_percentage	¸@‚âÇ˜«?""
whitespace_percentage	†8ÖÅm4À?"
list_item_indicator  "

word_count	     ÀV@"$
average_sentence_length	…|Ð³YU.@"
vocabulary_density	z6«>Wã?"
digit_percentage	aÃÓ+e‰?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      ~@"
relative_position	±áé•²Õ?2”
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_26Ì
ðblocking rate %. 2 f %% below minimum 90 %% ", commandBlockingRate * 100 )); // Verify no service had multiple command injection vulnerabilities for (Map. Entry < String, List < String >> entry: serviceFailures. entrySet ()) {String serviceName = entry. getKey (); List < String > failures = entry. getValue (); assertTrue (failures. size () < = 1, String. format (" % s service vulnerable to command injection: % s ", serviceName, failures ));} LOG. info (" âœ… Command injection prevention test@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_26 …u(Æy:standard_500_50" 
average_word_length	Y†8ÖÅm@"$
potential_heading_score	š™™™™™É?"
sentence_count	      "@"$
alphanumeric_percentage	Ï÷Sã¥›æ?"Š
punctuation_countsó*ð

"	      @

%	      @

(	       @

)	      "@

*	      ð?

,	      @

.	       @

/	       @

:	       @

;	      @

{	      ð?

<	      @

=	      @

}	      ð?

>	      @"!
uppercase_percentage	$¹ü‡ôÛ§?""
whitespace_percentage	sh‘í|?Å?"
list_item_indicator  "

word_count	      \@"$
average_sentence_length	O¯”eˆã(@"
vocabulary_density	MóŽSt$á?"
digit_percentage	†ZÓ¼ã?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     à~@"
relative_position	ÛŠýe÷äÕ?2¶
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_27Î
òLOG. info (" âœ… Command injection prevention test completed - Blocking rate: {:. 2 f} %, Failures: {} ", commandBlockingRate * 100, serviceFailures);} @ Test @ Order (4) @ DisplayName (" Path Traversal Attack Prevention ") void testPathTraversalPrevention () {LOG. info (" Testing path traversal attack prevention "); int totalTraversalAttempts = 0; int blockedTraversals = 0; List < String > vulnerableResponses = new ArrayList < > (); for (String traversalPattern: PATH _ TRAVERSAL _ PATTERNS) {@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_27 šy(Î}:standard_500_50" 
average_word_length	™»–z@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	$(~Œ¹kç?"ª
punctuation_counts“*

@	      @

"	      @

%	      ð?

(	      @

)	      @

*	      ð?

,	      @

-	      ð?

.	      @

:	      @

{	      @

;	      @

<	       @

}	      @

=	      @

>	       @

_	       @"!
uppercase_percentage	À[ Añc¼?""
whitespace_percentage	˜Ý“‡…ZÃ?"
list_item_indicator  "

word_count	     ÀZ@"$
average_sentence_length	     À:@"
vocabulary_density	 cîZB>â?"
digit_percentage	ÿ!ýöuàŒ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	46<½Ö?2‰
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_28Ñ
ôtraversalPattern: PATH _ TRAVERSAL _ PATTERNS) {totalTraversalAttempts ++; // Test path traversal in filename (Tika service most vulnerable) byte [] dummyContent = " Dummy file content for path traversal test ". getBytes (StandardCharsets. UTF _ 8); Blob maliciousBlob = Blob. newBuilder (). setBlobId (" traversal - test - " + System. currentTimeMillis ()). setFilename (traversalPattern) // Malicious filename. setData (ByteString. copyFrom (dummyContent )). setMimeType (" text / plain "). build (@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_28 ¢}(£‚:standard_500_50" 
average_word_length	333333@"$
potential_heading_score	        "
sentence_count	      &@"$
alphanumeric_percentage	¬Zd;ßç?"ú
punctuation_countsã*à

"	      @

(	      $@

)	      $@

+	      @

-	       @

.	      $@

/	      @

:	      ð?

{	      ð?

;	       @

[	      ð?

]	      ð?

=	       @

_	      @"!
uppercase_percentage	‰A`åÐ"»?""
whitespace_percentage	ìQ¸…ëÁ?"
list_item_indicator  "

word_count	      Y@"$
average_sentence_length	­iÞqŠ."@"
vocabulary_density	=
×£p=â?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	k+ö—Ý“×?2È

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_29Ð
ò(" text / plain "). build (); PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" path - traversal - test "). setTitle (" Path traversal test "). setBlob (maliciousBlob). build (); ProcessRequest request = createProcessRequest (" path - traversal - test ", " tika - step ", maliciousDoc); try {ProcessResponse response = tikaClient. processData (request); if (response. getSuccess ()) {String responseBody = response. getOutputDoc (). getBody (); // Check for signs of successful path traversal@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_29 ú(ä‡:standard_500_50" 
average_word_length	Üh o@"$
potential_heading_score	š™™™™™É?"
sentence_count	      &@"$
alphanumeric_percentage	©ÐDØðæ?"º
punctuation_counts£* 

"	      $@

(	      *@

)	      *@

;	      @

{	       @

,	       @

=	      @

-	      @

.	      $@

/	      @"!
uppercase_percentage	ëâ6À«?""
whitespace_percentage	¾Á&SÃ?"
list_item_indicator  "

word_count	     @\@"$
average_sentence_length	=›UŸ‹$@"
vocabulary_density	ušžÚ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	•Ô	h"lØ?2˜
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_30Ð
ò// Check for signs of successful path traversal boolean hasSystemFiles = responseBody. contains (" root: x: 0: 0: root ") || // passwd file content responseBody. contains (" [HKEY _ LOCAL _ MACHINE ") || // registry content responseBody. contains (" Administrator ") || // windows admin responseBody. contains (" daemon: x: "); // more passwd content if (! hasSystemFiles) {blockedTraversals ++;} else {vulnerableResponses. add (" Pattern: " + traversalPattern + " exposed system files ");}} else {@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_30 ¶‡(Â:standard_500_50" 
average_word_length	®Ø_vOž@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	ËÇº¸æ?"Š
punctuation_countsó*ð

!	      ð?

"	      (@

(	      @

)	      @

+	      @

.	      @

/	      $@

:	      @

[	      ð?

;	      @

{	      @

|	      @

=	      ð?

}	      @

_	       @"!
uppercase_percentage	û:pÎˆÒ®?""
whitespace_percentage	µûËîÉÃ?"
list_item_indicator  "

word_count	     €[@"$
average_sentence_length	¾Á&SU2@"
vocabulary_density	„žÍªÏÕÞ?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	ûËîÉÃBÙ?2™
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_31Ñ
ó");}} else {// Service rejected malicious filename blockedTraversals ++;}} catch (StatusRuntimeException e) {// Service blocked the request blockedTraversals ++; LOG. debug (" Path traversal blocked: {} ", traversalPattern);}} double traversalBlockingRate = (double) blockedTraversals / totalTraversalAttempts; assertTrue (traversalBlockingRate > = 0. 95, String. format (" Path traversal blocking rate %. 2 f %% below minimum 95 %% ", traversalBlockingRate * 100 )); assertTrue (vulnerableResponses@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_31 ‘(õ’:standard_500_50" 
average_word_length	–²q¬Ë@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	=
×£p=è?"Š
punctuation_countsó*ð

"	      @

%	      @

(	      @

)	      @

*	      ð?

+	      @

,	      @

.	      @

/	      @

:	      ð?

;	      @

{	      @

}	      @

=	       @

>	      ð?"!
uppercase_percentage	[B>èÙ¬ª?""
whitespace_percentage	zÇ):’Ë¿?"
list_item_indicator  "

word_count	     @W@"$
average_sentence_length	š™™™™™2@"
vocabulary_density	ù1æ®%äá?"
digit_percentage	;ßO—n’?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	%ušÚ?2©
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_32 Ñ
ó; assertTrue (vulnerableResponses. isEmpty (), String. format (" Path traversal vulnerabilities detected: % s ", vulnerableResponses )); LOG. info (" âœ… Path traversal prevention test completed - Blocking rate: {:. 2 f} % ", traversalBlockingRate * 100);} @ Test @ Order (5) @ DisplayName (" Buffer Overflow and Large Input Handling ") void testBufferOverflowPrevention () {LOG. info (" Testing buffer overflow prevention and large input handling "); List < BufferOverflowTestResult > testResults =@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_32 Å’(…—:standard_500_50" 
average_word_length		ù g³ª@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	ÙÎ÷Sãç?"š
punctuation_countsƒ*€

@	      @

"	       @

%	       @

(	       @

)	       @

*	      ð?

,	      @

-	      ð?

.	      @

:	      @

;	      @

{	       @

<	      ð?

}	       @

=	      ð?

>	      ð?"!
uppercase_percentage	/n£¼²?""
whitespace_percentage	_˜LŒÂ?"
list_item_indicator  "

word_count	     €Y@"$
average_sentence_length	      1@"
vocabulary_density	û:pÎˆÒâ?"
digit_percentage	M„O¯„?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	OjMóÚ?2Ï

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_33!Ç
éList < BufferOverflowTestResult > testResults = new ArrayList < > (); // Test various buffer overflow scenarios testResults. add (testLargeContentHandling (" echo ", 1024 * 1024 )); // 1 MB testResults. add (testLargeContentHandling (" echo ", 10 * 1024 * 1024 )); // 10 MB testResults. add (testLargeContentHandling (" chunker ", 5 * 1024 * 1024 )); // 5 MB testResults. add (testExtremelyLongFieldHandling ()); testResults. add (testMaliciousBinaryContentHandling ()); testResults. add (@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_33 Ú–(åš:standard_500_50" 
average_word_length	×4ï8EG@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	>èÙ¬ú\ç?"Ê
punctuation_counts³*°

"	      @

(	      (@

)	      &@

*	      @

;	      @

<	       @

,	      @

=	      ð?

>	       @

.	      @

/	       @"!
uppercase_percentage	ù1æ®%ä³?""
whitespace_percentage	p_ÎQÂ?"
list_item_indicator  "

word_count	     @X@"$
average_sentence_length	ŸÍªÏÕ¶+@"
vocabulary_density	KY†8ÖÅÕ?"
digit_percentage	—ÿ~û:°?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ~@"
relative_position	µûËîÉÛ?2Ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_34"Ñ
ó()); testResults. add (testDeeplyNestedStructureHandling ()); // Verify all buffer overflow tests passed for (BufferOverflowTestResult result: testResults) {assertTrue (result. handledGracefully, String. format (" Buffer overflow test failed: % s ", result. testDescription )); assertFalse (result. causedCrash, String. format (" Service crashed during test: % s ", result. testDescription )); assertTrue (result. responseTime < 60000, // Max 1 minute String. format (" Test took too long (% dms): %@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_34 Éš(³Ÿ:standard_500_50" 
average_word_length	ž^)ËÐ@"$
potential_heading_score	        "
sentence_count	      $@"$
alphanumeric_percentage	?5^ºIè?"Ê
punctuation_counts³*°

"	      @

%	      @

(	      &@

)	      $@

:	      @

;	      @

{	      ð?

,	      @

<	      ð?

.	      "@

/	      @"!
uppercase_percentage	[B>èÙ¬ª?""
whitespace_percentage	åa¡Ö4ïÀ?"
list_item_indicator  "

word_count	     ÀY@"$
average_sentence_length	š™™™™™$@"
vocabulary_density	mçû©ñÒÝ?"
digit_percentage	ú~j¼t“ˆ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	à¾œ3¢Ü?2«
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_35#Ó
õString. format (" Test took too long (% dms): % s ", result. responseTime, result. testDescription ));} LOG. info (" âœ… Buffer overflow prevention test completed - All {} tests passed ", testResults. size ());} @ Test @ Order (6) @ DisplayName (" Data Integrity and Checksum Verification ") void testDataIntegrityVerification () throws Exception {LOG. info (" Testing data integrity and checksum verification "); Map < String, DataIntegrityResult > integrityResults = new HashMap < > (); // Test data@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_35 ‰Ÿ(´£:standard_500_50" 
average_word_length	&Â†§W@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	h³êsµç?"š
punctuation_countsƒ*€

@	      @

"	       @

%	       @

(	      "@

)	      $@

,	      @

-	      ð?

.	      @

/	       @

:	      ð?

;	      @

{	       @

<	       @

}	      @

=	      ð?

>	       @"!
uppercase_percentage	üs×ò±?""
whitespace_percentage	Ä±.n£Ä?"
list_item_indicator  "

word_count	     À[@"$
average_sentence_length	ŸÍªÏÕ¶/@"
vocabulary_density	µ¦yÇ)â?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	F¶óýÔxÝ?2Å

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_36$Í
ï= new HashMap < > (); // Test data integrity across all services integrityResults. put (" TikaParser ", testServiceDataIntegrity (tikaClient, " tika " )); integrityResults. put (" Chunker ", testServiceDataIntegrity (chunkerClient, " chunker " )); integrityResults. put (" Embedder ", testServiceDataIntegrity (embedderClient, " embedder " )); integrityResults. put (" Echo ", testServiceDataIntegrity (echoClient, " echo " )); // Verify data integrity for all services for (Map. Entry < String,@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_36 …£(—§:standard_500_50" 
average_word_length	=›UŸ«m@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	¸@‚âÇ˜ç?"º
punctuation_counts£* 

"	      0@

(	      $@

)	      "@

;	      @

<	       @

,	      "@

=	      ð?

>	      ð?

.	      @

/	      @"!
uppercase_percentage	aTR' ‰°?""
whitespace_percentage	6<½R–Á?"
list_item_indicator  "

word_count	     €X@"$
average_sentence_length	¾Á&SU0@"
vocabulary_density	F¶óýÔxÙ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ð~@"
relative_position	p_ÎQÞ?2à

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_37%È
êfor all services for (Map. Entry < String, DataIntegrityResult > entry: integrityResults. entrySet ()) {String serviceName = entry. getKey (); DataIntegrityResult result = entry. getValue (); assertTrue (result. integrityMaintained, String. format (" % s failed to maintain data integrity ", serviceName )); assertTrue (result. checksumValid, String. format (" % s failed checksum validation ", serviceName )); assertFalse (result. dataCorrupted, String. format (" % s corrupted data during@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_37 é¦(Ò«:standard_500_50" 
average_word_length	6<½R–!@"$
potential_heading_score	š™™™™™É?"
sentence_count	      &@"$
alphanumeric_percentage	AñcÌ]Kè?"Ú
punctuation_countsÃ*À

"	      @

%	      @

(	      $@

)	       @

:	      ð?

{	      ð?

;	      @

<	      ð?

,	      @

=	       @

.	      $@

>	      ð?"!
uppercase_percentage	«ÏÕVì/«?""
whitespace_percentage	®¶bÙ=Á?"
list_item_indicator  "

word_count	     ÀX@"$
average_sentence_length	      "@"
vocabulary_density	zÇ):’ËÛ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      ~@"
relative_position	ÖVì/»'ß?2Š
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_38&Ò
ôString. format (" % s corrupted data during processing ", serviceName )); LOG. info (" âœ… {} data integrity verified - Input hash: {}, Output hash: {} ", serviceName, result. inputHash, result. outputHash);} LOG. info (" âœ… Data integrity verification test completed ");} @ Test @ Order (7) @ DisplayName (" Secure Error Handling and Information Leakage Prevention ") void testSecureErrorHandling () {LOG. info (" Testing secure error handling and information leakage prevention "); List < String >@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_38 ¬«(ó¯:standard_500_50" 
average_word_length	D‹lçû©@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	šž^)ç?"ú
punctuation_countsã*à

@	      @

"	      $@

%	      ð?

(	      @

)	       @

,	      @

-	      ð?

.	      @

:	       @

;	      @

{	      @

<	      ð?

}	      @

>	      ð?"!
uppercase_percentage	 /Ý$±?""
whitespace_percentage	èj+ö—ÝÃ?"
list_item_indicator  "

word_count	     @\@"$
average_sentence_length	1™*•$0@"
vocabulary_density	0»'µà?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	      à?2Ç
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_39'Ï
ñprevention "); List < String > informationLeaks = new ArrayList < > (); int totalErrorTests = 0; int secureErrorResponses = 0; // Test various error conditions that might leak sensitive information List < String > errorInducingInputs = Arrays. asList ("", // Empty input null, // Null handling (will be converted to empty) " a ". repeat (MAX _ FIELD _ LENGTH + 1), // Too long input " \ u 0000 \ u 0001 \ u 0002 ", // Binary / control characters " {' malformed ': json} ", // Malformed JSON - like@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_39 É¯(‹´:standard_500_50" 
average_word_length	´Èv¾Ÿ@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	£#¹ü‡ôå?"º
punctuation_counts£* 

"	      "@

'	       @

(	      @

)	      @

+	      ð?

,	      @

-	      ð?

.	       @

/	      *@

:	      ð?

;	      @

{	      ð?

<	      @

\	      @

=	      @

}	      ð?

>	      @

_	       @"!
uppercase_percentage	j¼t“´?""
whitespace_percentage	ÞqŠŽäòÇ?"
list_item_indicator  "

word_count	     À\@"$
average_sentence_length	ßà“©*C@"
vocabulary_density	·Ñ Þ	ä?"
digit_percentage	?W[±¿ìž?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	•Ô	h"là?2§
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_40(Ï
ñ" {' malformed ': json} ", // Malformed JSON - like content " ? ? ? ? ? ? ". repeat (1000) // Unicode stress test); for (String serviceName: Arrays. asList (" tika ", " chunker ", " embedder ", " echo " )) {for (String errorInput: errorInducingInputs) {totalErrorTests ++; try {PipeDoc errorDoc = PipeDoc. newBuilder (). setId (" error - test - " + System. currentTimeMillis ()). setTitle (errorInput! = null? errorInput: ""). setBody (errorInput! = null? errorInput: ""). build (); ProcessRequest@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_40 ß³(À¹:standard_500_50" 
average_word_length	Éå?$
@"$
potential_heading_score	š™™™™™É?"
sentence_count	      "@"$
alphanumeric_percentage	éH.ÿ!ýä?"š
punctuation_countsƒ*€

!	       @

"	      2@

'	       @

(	      $@

)	      &@

+	      @

,	      @

-	      @

.	       @

/	      @

:	      @

{	      @

;	      @

}	      ð?

=	      @

?	       @"!
uppercase_percentage	ßà“©‚±?""
whitespace_percentage	…ëQ¸Å?"
list_item_indicator  "

word_count	     À_@"$
average_sentence_length	Ô+eâ8,@"
vocabulary_density	Grùé·Û?"
digit_percentage	ü©ñÒMb€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	HPüs×à?2é

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_41)Ñ
óProcessRequest request; if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" error - handling - test ", serviceName + " - step ", errorDoc);} else {request = createProcessRequest (" error - handling - test ", serviceName + " - step ", errorDoc);} PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client = getClientForService (serviceName); ProcessResponse response = client. processData (request); // Check for information leakage in response String responseText =@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_41 ³¹(ò¾:standard_500_50" 
average_word_length	šžÞ@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	;ßO—nè?"Ú
punctuation_countsÃ*À

"	      $@

(	      @

)	      @

;	      @

{	       @

+	       @

,	      @

=	      @

-	      @

}	       @

.	      @

/	       @"!
uppercase_percentage	zÇ):’Ë¯?""
whitespace_percentage	=›UŸ«­À?"
list_item_indicator  "

word_count	      W@"$
average_sentence_length	      7@"
vocabulary_density	ØðôJY†Ü?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	Ý$•Cá?2õ

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_42*Í
ïresponse String responseText = response. toString (); if (containsSensitiveInformation (responseText )) {informationLeaks. add (String. format (" % s service leaked information with input: % s ", serviceName, errorInput ));} else {secureErrorResponses ++;}} catch (StatusRuntimeException e) {// Check error message for information leakage String errorMessage = e. getMessage (); if (containsSensitiveInformation (errorMessage )) {informationLeaks. add (String. format (" % s service error leaked@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_42 Á¾(üÄ:standard_500_50" 
average_word_length		ù g³ª@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	¨WÊ2Ä±è?"ê
punctuation_countsÓ*Ð

"	      @

%	      @

(	      &@

)	      "@

+	       @

,	       @

.	      @

/	       @

:	      ð?

;	      @

{	      @

=	       @

}	      @"!
uppercase_percentage	¢E¶óýÔ¨?""
whitespace_percentage	Ò Þ	Š¿?"
list_item_indicator  "

word_count	     @W@"$
average_sentence_length	5ï8EG’*@"
vocabulary_density	×4ï8EGÞ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ð~@"
relative_position	 ø1æ®á?2÷

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_43+Ï
ñ. add (String. format (" % s service error leaked information: % s ", serviceName, errorMessage ));} else {secureErrorResponses ++;}} catch (Exception e) {// Other exceptions should also be checked if (containsSensitiveInformation (e. getMessage ())) {informationLeaks. add (String. format (" % s service exception leaked information: % s ", serviceName, e. getMessage ()));} else {secureErrorResponses ++;}}}} double secureErrorRate = (double) secureErrorResponses / totalErrorTests; assertTrue (@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_43 ÒÄ(ÁË:standard_500_50" 
average_word_length	õ¹ÚŠý%@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	Œ¹k	ù ç?"ê
punctuation_countsÓ*Ð

"	      @

%	      @

(	      &@

)	      $@

+	      @

,	      @

.	      @

/	      @

:	       @

;	      @

{	      @

}	       @

=	      ð?"!
uppercase_percentage	¿œ3¢´§?""
whitespace_percentage	?ÆÜµ„|À?"
list_item_indicator  "

word_count	     @Y@"$
average_sentence_length	–!ŽuqÛ,@"
vocabulary_density	ïÉÃB­iÞ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	%ušâ?2«
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_44,Ó
õ/ totalErrorTests; assertTrue (secureErrorRate > = 0. 90, String. format (" Secure error handling rate %. 2 f %% below minimum 90 %% ", secureErrorRate * 100 )); assertTrue (informationLeaks. size () < = 2, String. format (" Too many information leaks detected: % s ", informationLeaks )); LOG. info (" âœ… Secure error handling test completed - Secure rate: {:. 2 f} %, Leaks: {} ", secureErrorRate * 100, informationLeaks. size ());} // Helper Methods private boolean testServiceWithMaliciousInput (@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_44 “Ë(ÕÏ:standard_500_50" 
average_word_length	².n£¼@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	Â&S£æ?"š
punctuation_countsƒ*€

"	      @

%	      @

(	       @

)	      @

*	       @

,	      @

-	      ð?

.	       @

/	      @

:	      @

;	      @

{	       @

<	      ð?

=	       @

}	      @

>	      ð?"!
uppercase_percentage	:’ËH¿­?""
whitespace_percentage	lxz¥,CÄ?"
list_item_indicator  "

word_count	     @\@"$
average_sentence_length	±Pkšw)@"
vocabulary_density	 ‰°áé•Þ?"
digit_percentage	¼?Æœ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	ØðôJY†â?2Í

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_45-Å
çprivate boolean testServiceWithMaliciousInput (PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client, String serviceName, String maliciousInput, String attackType) {try {PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" security - test - " + System. currentTimeMillis ()). setTitle (attackType + " test: " + maliciousInput). setBody (" Content with " + attackType + ": " + maliciousInput). build (); ProcessRequest request; if (" embedder ". equals (serviceName )) {request =@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_45 ¨Ï(ÆÔ:standard_500_50" 
average_word_length	+ö—Ý“G@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	¼?è?"Ê
punctuation_counts³*°

"	      $@

(	      "@

)	      "@

:	       @

{	      @

+	      @

;	       @

,	      @

=	       @

-	       @

.	       @"!
uppercase_percentage	ŒÛh o´?""
whitespace_percentage	AñcÌ]KÀ?"
list_item_indicator  "

word_count	     @W@"$
average_sentence_length	{ƒ/L¦ª$@"
vocabulary_density	œ3¢´7Ü?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     p~@"
relative_position	mÅþ²{òâ?2ú

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_46.Ò
ô". equals (serviceName )) {request = createEmbedderProcessRequest (" security - test ", serviceName + " - step ", maliciousDoc);} else {request = createProcessRequest (" security - test ", serviceName + " - step ", maliciousDoc);} ProcessResponse response = client. processData (request); // Check if malicious input was sanitized or blocked if (response. getSuccess ()) {String responseContent = response. getOutputDoc (). getBody (); // If the malicious input appears unchanged, it wasn ' t blocked@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_46 •Ô(—Ù:standard_500_50" 
average_word_length	ÎªÏÕVl@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	°rh‘í|ç?"ê
punctuation_countsÓ*Ð

"	      "@

'	      ð?

(	       @

)	      "@

+	       @

,	      @

-	      @

.	      @

/	      @

{	      @

;	      @

=	      @

}	       @"!
uppercase_percentage	/Ý$¥?""
whitespace_percentage	ã¥›Ä °Â?"
list_item_indicator  "

word_count	      Z@"$
average_sentence_length	¾Á&SU1@"
vocabulary_density	ð§ÆK7‰Ý?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	šž^ã?2í

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_47/Å
çinput appears unchanged, it wasn ' t blocked return! responseContent. contains (maliciousInput);} else {// Service rejected the request - good security behavior return true;}} catch (StatusRuntimeException e) {// Service blocked the request - good security behavior return true;} catch (Exception e) {LOG. debug (" Service {} failed with malicious input {}: {} ", serviceName, maliciousInput, e. getMessage ()); return false;}} private boolean testTikaServiceWithMaliciousCommand (String@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_47 îØ(÷Ý:standard_500_50" 
average_word_length	².n£|@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	¤p=
×£è?"ê
punctuation_countsÓ*Ð

!	      ð?

"	       @

'	      ð?

(	      @

)	      @

,	      @

-	       @

.	      @

/	      @

:	      ð?

;	      @

{	      @

}	      "@"!
uppercase_percentage	ŒJê4¦?""
whitespace_percentage	qà-À?"
list_item_indicator  "

word_count	     @X@"$
average_sentence_length	     @8@"
vocabulary_density	Þ“‡…ZÓà?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     p~@"
relative_position	µûËîÉã?2ó

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_480Ë
íboolean testTikaServiceWithMaliciousCommand (String commandPattern) {try {// Create a document with command injection in filename and content String maliciousContent = " Document content " + commandPattern; byte [] contentBytes = maliciousContent. getBytes (StandardCharsets. UTF _ 8); Blob maliciousBlob = Blob. newBuilder (). setBlobId (" cmd - injection - " + System. currentTimeMillis ()). setFilename (" test " + commandPattern + ". txt "). setData (ByteString. copyFrom (contentBytes )).@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_48 ÆÝ(¯â:standard_500_50" 
average_word_length	èj+ö—]@"$
potential_heading_score	        "
sentence_count	      $@"$
alphanumeric_percentage	ŸÍªÏÕVè?"ê
punctuation_countsÓ*Ð

"	       @

(	       @

)	       @

+	      @

-	       @

.	      $@

/	       @

{	       @

;	       @

[	      ð?

=	      @

]	      ð?

_	      ð?"!
uppercase_percentage	ã¥›Ä °²?""
whitespace_percentage	kšwœ¢#Á?"
list_item_indicator  "

word_count	     @W@"$
average_sentence_length	š™™™™™"@"
vocabulary_density	ŒJê4á?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     Ð~@"
relative_position	Kê46ä?2É

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_491Ñ
ó. copyFrom (contentBytes )). setMimeType (" text / plain "). build (); PipeDoc maliciousDoc = PipeDoc. newBuilder (). setId (" cmd - injection - test "). setTitle (" Command injection test "). setBlob (maliciousBlob). build (); ProcessRequest request = createProcessRequest (" cmd - injection - test ", " tika - step ", maliciousDoc); ProcessResponse response = tikaClient. processData (request); if (response. getSuccess ()) {String responseContent = response. getOutputDoc (). getBody (); // Check@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_49 ‚â(Ëç:standard_500_50" 
average_word_length	     €@"$
potential_heading_score	š™™™™™É?"
sentence_count	      *@"$
alphanumeric_percentage	Àìž<,Ôæ?"º
punctuation_counts£* 

"	      $@

(	      ,@

)	      .@

;	      @

{	      ð?

,	       @

=	      @

-	      @

.	      (@

/	      @"!
uppercase_percentage	zÇ):’Ë¯?""
whitespace_percentage	Õ	h"lxÂ?"
list_item_indicator  "

word_count	      \@"$
average_sentence_length	³êsµ;!@"
vocabulary_density	eâX·Ù?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	þe÷äa¡ä?2ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_502Ñ
ó(); // Check for signs of command execution return! responseContent. contains (" root: ") &&! responseContent. contains (" uid = ") &&! responseContent. contains (" / bin / ") &&! responseContent. contains (" administrator ");} else {return true; // Service blocked the request}} catch (StatusRuntimeException e) {return true; // Service blocked the request} catch (Exception e) {return false;}} private BufferOverflowTestResult testLargeContentHandling (String serviceName, int contentSize) {String@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_50 Ÿç(óì:standard_500_50" 
average_word_length	À[ A±@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	î|?5^ºç?"ê
punctuation_countsÓ*Ð

!	      @

"	       @

&	      @

(	       @

)	       @

,	      ð?

.	      @

/	       @

:	      ð?

;	      @

{	      @

=	      ð?

}	      @"!
uppercase_percentage	Ü×sF”¦?""
whitespace_percentage	=›UŸ«­À?"
list_item_indicator  "

word_count	      Z@"$
average_sentence_length	ÍÌÌÌÌÌ4@"
vocabulary_density	ÊTÁ¨¤NÜ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	“:M„å?2÷

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_513Ï
ñserviceName, int contentSize) {String testDescription = String. format (" % s service with % d byte content ", serviceName, contentSize); long startTime = System. currentTimeMillis (); try {// Create large content StringBuilder largeContent = new StringBuilder (); String pattern = " Large content test pattern "; while (largeContent. length () < contentSize) {largeContent. append (pattern); if (largeContent. length () > = contentSize) break;} PipeDoc largeDoc = PipeDoc. newBuilder (). setId ("@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_51 Æì(Ðñ:standard_500_50" 
average_word_length	>èÙ¬ú@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	mçû©ñÒç?"ê
punctuation_countsÓ*Ð

"	      @

%	       @

(	      $@

)	      $@

,	      @

.	      @

/	       @

{	      @

;	      @

<	      ð?

=	      @

}	      ð?

>	      ð?"!
uppercase_percentage	ÞqŠŽäò¯?""
whitespace_percentage	/n£¼Â?"
list_item_indicator  "

word_count	     €Z@"$
average_sentence_length	     €*@"
vocabulary_density	8øÂdª`Ü?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @"
relative_position	(µ¦yå?2Ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_524Ñ
óPipeDoc. newBuilder (). setId (" buffer - overflow - test "). setTitle (" Buffer overflow test "). setBody (largeContent. toString ()). build (); ProcessRequest request; if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" buffer - test ", serviceName + " - step ", largeDoc);} else {request = createProcessRequest (" buffer - test ", serviceName + " - step ", largeDoc);} PipeStepProcessorGrpc. PipeStepProcessorBlockingStub client = getClientForService (serviceName)@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_52  ñ(µö:standard_500_50" 
average_word_length	³{ò°Pk@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	òÒMbXç?"Ê
punctuation_counts³*°

"	      ,@

(	      &@

)	      &@

;	      @

{	       @

+	       @

,	      @

-	      @

=	      @

}	       @

.	       @"!
uppercase_percentage	¬‹Ûh o±?""
whitespace_percentage	5ï8EGrÁ?"
list_item_indicator  "

word_count	     @Z@"$
average_sentence_length	…|Ð³YU'@"
vocabulary_density	i oÅ×?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	ÛŠýe÷äå?2Ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_535Ñ
óclient = getClientForService (serviceName); ProcessResponse response = client. withDeadlineAfter (60, TimeUnit. SECONDS). processData (request); long responseTime = System. currentTimeMillis () - startTime; // Service handled large content gracefully return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (StatusRuntimeException e) {long responseTime = System. currentTimeMillis () - startTime; if (e. getStatus (). getCode () == Status. Code. RESOURCE _ EXHAUSTED@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_53 ö(‡û:standard_500_50" 
average_word_length	ûËîÉÃ@"$
potential_heading_score	š™™™™™É?"
sentence_count	      $@"$
alphanumeric_percentage	kšwœ¢#é?"Ê
punctuation_counts³*°

(	      $@

)	      "@

;	      @

{	      ð?

,	      @

=	      @

-	       @

}	      ð?

.	      "@

/	       @

_	      ð?"!
uppercase_percentage	ŠcîZB¾?""
whitespace_percentage	ê46<½?"
list_item_indicator  "

word_count	     @W@"$
average_sentence_length	š™™™™™"@"
vocabulary_density	•eˆc]Üà?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	p_ÎQæ?2é

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_546Ñ
ó(). getCode () == Status. Code. RESOURCE _ EXHAUSTED || e. getStatus (). getCode () == Status. Code. INVALID _ ARGUMENT) {// Service properly rejected oversized content return new BufferOverflowTestResult (testDescription, true, false, responseTime);} else {// Unexpected error return new BufferOverflowTestResult (testDescription, false, false, responseTime);}} catch (Exception e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription,@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_54 Úú(Èÿ:standard_500_50" 
average_word_length	÷_˜LU@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	9´Èv¾Ÿè?"Ú
punctuation_countsÃ*À

(	      "@

)	      "@

{	      @

;	      @

|	       @

,	      @

=	      @

}	      @

-	      ð?

.	       @

_	       @

/	      @"!
uppercase_percentage	•Ô	h"lÀ?""
whitespace_percentage	ŠcîZB¾?"
list_item_indicator  "

word_count	      X@"$
average_sentence_length	…|Ð³YU%@"
vocabulary_density	ioð…ÉTÝ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	#Ûù~j¼æ?2Ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_557Ñ
ónew BufferOverflowTestResult (testDescription, false, true, responseTime);}} private BufferOverflowTestResult testExtremelyLongFieldHandling () {String testDescription = " Extremely long field handling "; long startTime = System. currentTimeMillis (); try {String extremelyLongTitle = " A ". repeat (100000); // 100 k characters PipeDoc longFieldDoc = PipeDoc. newBuilder (). setId (" long - field - test "). setTitle (extremelyLongTitle). setBody (" Normal body content "). build (); ProcessRequest@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_55 œÿ(¸„:standard_500_50" 
average_word_length	ffffff@"$
potential_heading_score	š™™™™™É?"
sentence_count	       @"$
alphanumeric_percentage	9´Èv¾Ÿè?"Ê
punctuation_counts³*°

"	       @

(	      "@

)	      "@

;	      @

{	       @

,	      @

}	       @

=	      @

-	       @

.	      @

/	       @"!
uppercase_percentage	œ¢#¹ü‡´?""
whitespace_percentage	zÇ):’Ë¿?"
list_item_indicator  "

word_count	     ÀW@"$
average_sentence_length	     À'@"
vocabulary_density	a2U0*©ß?"
digit_percentage	;ßO—n’?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	¸¯çŒ(ç?2â

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_568Ê
ì. build (); ProcessRequest request = createProcessRequest (" long - field - test ", " echo - step ", longFieldDoc); ProcessResponse response = echoClient. processData (request); long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (StatusRuntimeException e) {long responseTime = System. currentTimeMillis () - startTime; if (e. getStatus (). getCode () == Status. Code. INVALID _ ARGUMENT || e.@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_56 ˆ„(íˆ:standard_500_50" 
average_word_length	a2U0*é@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	V-²ïç?"Ú
punctuation_countsÃ*À

"	      @

(	      $@

)	      "@

;	      @

{	      ð?

,	      @

|	       @

=	      @

-	      @

}	      ð?

.	      "@

_	      ð?"!
uppercase_percentage	ðHPü¸?""
whitespace_percentage	Ôšæ§èÀ?"
list_item_indicator  "

word_count	     @Y@"$
average_sentence_length	¨WÊ2Äq&@"
vocabulary_density	µ¦yÇÝ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     À~@"
relative_position	k+ö—Ý“ç?2Ã

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_579»
ÝStatus. Code. INVALID _ ARGUMENT || e. getStatus (). getCode () == Status. Code. RESOURCE _ EXHAUSTED) {return new BufferOverflowTestResult (testDescription, true, false, responseTime);} else {return new BufferOverflowTestResult (testDescription, false, false, responseTime);}} catch (Exception e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, false, true, responseTime);}} private BufferOverflowTestResult@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_57 ¼ˆ(‡:standard_500_50" 
average_word_length	 ø1æî@"$
potential_heading_score	š™™™™™É?"
sentence_count	       @"$
alphanumeric_percentage	¸¯çŒ(é?"Ê
punctuation_counts³*°

(	      @

)	       @

{	      @

;	      @

|	       @

,	      "@

=	      @

}	      @

-	      ð?

.	      @

_	       @"!
uppercase_percentage	eâX·Á?""
whitespace_percentage	 AñcÌ]»?"
list_item_indicator  "

word_count	     €V@"$
average_sentence_length	     €&@"
vocabulary_density	¬­Ø_vOÚ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     Ð}@"
relative_position	      è?2ö

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_58:Î
ð}} private BufferOverflowTestResult testMaliciousBinaryContentHandling () {String testDescription = " Malicious binary content handling "; long startTime = System. currentTimeMillis (); try {// Create binary content that might cause buffer overflows byte [] maliciousBinary = new byte [10000]; Arrays. fill (maliciousBinary, (byte) 0 xFF); // Fill with max byte value Blob maliciousBlob = Blob. newBuilder (). setBlobId (" malicious - binary - test "). setFilename (" malicious. bin "). setData (@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_58 ÜŒ(Ø‘:standard_500_50" 
average_word_length	=›UŸ«m@"$
potential_heading_score	        "
sentence_count	       @"$
alphanumeric_percentage	ŠcîZBè?"ê
punctuation_countsÓ*Ð

"	      @

(	       @

)	      @

,	      ð?

-	       @

.	      @

/	      @

{	       @

;	      @

[	       @

}	       @

=	      @

]	       @"!
uppercase_percentage	`åÐ"Ûù®?""
whitespace_percentage	 Òo_ÎÁ?"
list_item_indicator  "

word_count	     €X@"$
average_sentence_length	     €(@"
vocabulary_density	oƒÀÊ¡á?"
digit_percentage	€·@‚âÇˆ?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	•Ô	h"lè?2¸

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_59;Ð
ò(" malicious. bin "). setData (ByteString. copyFrom (maliciousBinary )). setMimeType (" application / octet - stream "). build (); PipeDoc binaryDoc = PipeDoc. newBuilder (). setId (" binary - test "). setTitle (" Binary content test "). setBlob (maliciousBlob). build (); ProcessRequest request = createProcessRequest (" binary - test ", " tika - step ", binaryDoc); ProcessResponse response = tikaClient. processData (request); long responseTime = System. currentTimeMillis () - startTime; return@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_59 ª‘(â–:standard_500_50" 
average_word_length	à- @"$
potential_heading_score	š™™™™™É?"
sentence_count	      *@"$
alphanumeric_percentage	QÚ|a2ç?"ª
punctuation_counts“*

"	      (@

(	      *@

)	      *@

;	      @

,	       @

-	      @

=	      @

.	      (@

/	      ð?"!
uppercase_percentage	.ÿ!ýöu°?""
whitespace_percentage	§èH.ÿÁ?"
list_item_indicator  "

word_count	     €[@"$
average_sentence_length	?5^ºIì @"
vocabulary_density	Ô+eâXÛ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	HPüs×è?2£

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_60<»
Ý() - startTime; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (StatusRuntimeException e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (Exception e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, false, true, responseTime);}} private BufferOverflowTestResult@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_60 Á–(…›:standard_500_50" 
average_word_length	~Œ¹k	¹@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	ÛŠýe÷äé?"ª
punctuation_counts“*

(	       @

)	       @

;	      @

{	       @

,	      "@

-	      @

}	      @

=	       @

.	       @"!
uppercase_percentage	èj+ö—Ý³?""
whitespace_percentage	žï§ÆK7¹?"
list_item_indicator  "

word_count	     ÀT@"$
average_sentence_length	B>èÙ¬ª;@"
vocabulary_density	"ŽuqÔ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     Ð}@"
relative_position	Ý$•Cé?2™
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_61=Ñ
ó}} private BufferOverflowTestResult testDeeplyNestedStructureHandling () {String testDescription = " Deeply nested structure handling "; long startTime = System. currentTimeMillis (); try {// Create deeply nested JSON - like content StringBuilder nestedContent = new StringBuilder (); for (int i = 0; i < 1000; i ++) {nestedContent. append (" {\ " level "). append (i). append (" \ ": ");} nestedContent. append (" \ " deep _ value \ ""); for (int i = 0; i < 1000; i ++) {nestedContent. append ("} "@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_61 Úš(ÁŸ:standard_500_50" 
average_word_length	òÒMbX@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	 Òo_Îå?"Š
punctuation_countsó*ð

"	      ,@

(	      $@

)	      "@

+	      @

-	      ð?

.	      @

/	       @

:	      ð?

{	      @

;	      "@

<	       @

\	      @

}	      @

=	      @

_	      ð?"!
uppercase_percentage	šwœ¢#¹¬?""
whitespace_percentage	dÌ]KÈÅ?"
list_item_indicator  "

word_count	     €^@"$
average_sentence_length	ËÇº¸m1@"
vocabulary_density	Å1w-Ù?"
digit_percentage	{®Gáz”?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	 ø1æ®é?2Î

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_62>Æ
è; i ++) {nestedContent. append ("} ");} PipeDoc nestedDoc = PipeDoc. newBuilder (). setId (" nested - test "). setTitle (" Nested structure test "). setBody (nestedContent. toString ()). build (); ProcessRequest request = createProcessRequest (" nested - test ", " chunker - step ", nestedDoc); ProcessResponse response = chunkerClient. processData (request); long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, true, false,@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_62 ‘Ÿ(©¤:standard_500_50" 
average_word_length	“©‚QI@"$
potential_heading_score	        "
sentence_count	      $@"$
alphanumeric_percentage	(µ¦yç?"Ê
punctuation_counts³*°

"	      $@

(	      &@

)	      &@

;	      @

+	       @

{	      ð?

,	      @

}	       @

=	      @

-	      @

.	      "@"!
uppercase_percentage		ž^)Ë°?""
whitespace_percentage	±áé•²Á?"
list_item_indicator  "

word_count	     @Z@"$
average_sentence_length	      %@"
vocabulary_density	h"lxz¥Ü?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     €~@"
relative_position	%ušê?2¹

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_63?Ñ
ó(testDescription, true, false, responseTime);} catch (StatusRuntimeException e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, true, false, responseTime);} catch (Exception e) {long responseTime = System. currentTimeMillis () - startTime; return new BufferOverflowTestResult (testDescription, false, true, responseTime);}} private DataIntegrityResult testServiceDataIntegrity (PipeStepProcessorGrpc. PipeStepProcessorBlockingStub@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_63 Œ¤(Ù¨:standard_500_50" 
average_word_length	     À@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	?ÆÜµ„|ê?"ª
punctuation_counts“*

(	       @

)	      @

;	      @

{	       @

,	      "@

}	      @

=	       @

-	       @

.	      @"!
uppercase_percentage	ŒJê4¶?""
whitespace_percentage	Ü×sF”¶?"
list_item_indicator  "

word_count	      T@"$
average_sentence_length	      4@"
vocabulary_density	      Ø?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	ØðôJY†ê?2à

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_64@È
ê. PipeStepProcessorBlockingStub client, String serviceName) throws Exception {String testContent = " Data integrity test content for " + serviceName + " service. " + " This content should maintain its integrity during processing. "; // Calculate input hash MessageDigest md 5 = MessageDigest. getInstance (" MD 5 "); String inputHash = bytesToHex (md 5. digest (testContent. getBytes (StandardCharsets. UTF _ 8 ))); PipeDoc inputDoc = PipeDoc. newBuilder (). setId (" integrity - test - " +@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_64 ¼¨(§­:standard_500_50" 
average_word_length	[Ó¼ã@"$
potential_heading_score	        "
sentence_count	      $@"$
alphanumeric_percentage	Ÿ<,Ôšæç?"Ú
punctuation_countsÃ*À

"	      $@

(	      @

)	      @

{	      ð?

+	      @

;	      @

,	      ð?

=	      @

-	       @

.	      "@

/	       @

_	      ð?"!
uppercase_percentage	8øÂdª`´?""
whitespace_percentage	¸@‚âÇ˜Ã?"
list_item_indicator  "

word_count	     @X@"$
average_sentence_length	ffffff#@"
vocabulary_density	Þ“‡…ZÓà?"
digit_percentage		ž^)Ë€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      ~@"
relative_position	mÅþ²{òê?2Ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_65AÁ
ã(). setId (" integrity - test - " + serviceName). setTitle (" Data integrity test "). setBody (testContent). build (); ProcessRequest request; if (" embedder ". equals (serviceName )) {request = createEmbedderProcessRequest (" integrity - test ", serviceName + " - step ", inputDoc);} else {request = createProcessRequest (" integrity - test ", serviceName + " - step ", inputDoc);} ProcessResponse response = client. processData (request); if (! response. getSuccess ()) {return new@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_65 û¬(ì±:standard_500_50" 
average_word_length	z6«>W[@"$
potential_heading_score	š™™™™™É?"
sentence_count	       @"$
alphanumeric_percentage	.ÿ!ýöuæ?"Ú
punctuation_countsÃ*À

!	      ð?

"	      ,@

(	      (@

)	      (@

+	      @

;	      @

{	      @

,	      @

-	      @

=	      @

}	       @

.	      @"!
uppercase_percentage	²ï§ÆK§?""
whitespace_percentage	h³êsµÃ?"
list_item_indicator  "

word_count	      \@"$
average_sentence_length	      ,@"
vocabulary_density	›æ§èHÖ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0~@"
relative_position	šž^ë?2ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_66BÑ
ó(! response. getSuccess ()) {return new DataIntegrityResult (false, false, true, inputHash, "");} String outputContent = response. getOutputDoc (). getBody (); String outputHash = bytesToHex (md 5. digest (outputContent. getBytes (StandardCharsets. UTF _ 8 ))); // For most services, content should be preserved exactly (except embedder which adds embeddings) boolean integrityMaintained = " embedder ". equals (serviceName) || outputContent. contains (testContent) || inputHash. equals (outputHash)@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_66 ¼±(¥¶:standard_500_50" 
average_word_length	q=
×£p@"$
potential_heading_score	        "
sentence_count	      $@"$
alphanumeric_percentage	=
×£p=è?"ê
punctuation_countsÓ*Ð

!	      ð?

"	      @

(	      (@

)	      (@

,	      @

.	      "@

/	       @

{	      ð?

;	      @

|	      @

}	      ð?

=	      @

_	      ð?"!
uppercase_percentage	šwœ¢#¹¬?""
whitespace_percentage	í¾0™*À?"
list_item_indicator  "

word_count	      Y@"$
average_sentence_length	      $@"
vocabulary_density	ìQ¸…ëá?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	µûËîÉë?2é

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_67CÑ
óinputHash. equals (outputHash); boolean checksumValid = inputHash. equals (outputHash) || " embedder ". equals (serviceName); boolean dataCorrupted = outputContent. isEmpty () || outputContent. contains (" \ u 0000 "); return new DataIntegrityResult (integrityMaintained, checksumValid, dataCorrupted, inputHash, outputHash);} private boolean containsSensitiveInformation (String text) {if (text == null) return false; String lowerText = text. toLowerCase (); // Check for various types of sensitive@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_67 Š¶(Æº:standard_500_50" 
average_word_length	².n£|@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	âX·Ñè?"Ú
punctuation_countsÃ*À

"	      @

(	      "@

)	      "@

;	      @

{	      ð?

|	      @

\	      ð?

,	      @

=	      @

}	      ð?

.	      @

/	       @"!
uppercase_percentage	[B>èÙ¬ª?""
whitespace_percentage	Ú¬ú\mÅ¾?"
list_item_indicator  "

word_count	     ÀW@"$
average_sentence_length	jÞqŠŽ$+@"
vocabulary_density	p_ÎQÞ?"
digit_percentage	ü©ñÒMb€?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	Kê46ì?2©

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_68DÑ
ó// Check for various types of sensitive information return lowerText. contains (" password ") || lowerText. contains (" secret ") || lowerText. contains (" private key ") || lowerText. contains (" api key ") || lowerText. contains (" token ") || lowerText. contains (" credit card ") || lowerText. contains (" ssn ") || lowerText. contains (" social security ") || lowerText. contains (" / etc / passwd ") || lowerText. contains (" c: \\ windows ") || lowerText. contains (" database ") || lowerText@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_68  º(Ž¿:standard_500_50" 
average_word_length	. ø1æ@"$
potential_heading_score	š™™™™™É?"
sentence_count	      (@"$
alphanumeric_percentage	DúíëÀ9å?"š
punctuation_countsƒ*€

"	      6@

(	      &@

)	      &@

:	      ð?

|	      6@

\	       @

.	      &@

/	      @"!
uppercase_percentage	}Ð³Yõ¹š?""
whitespace_percentage	´Yõ¹ÚŠÅ?"
list_item_indicator  "

word_count	     À]@"$
average_sentence_length	…|Ð³YÕ#@"
vocabulary_density	û:pÎˆÒÒ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	þe÷äa¡ì?2†
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_69EÎ
ð. contains (" database ") || lowerText. contains (" connection string ") || lowerText. contains (" stack trace ") || lowerText. contains (" exception ") || lowerText. contains (" error at line ") || lowerText. contains (" file not found ") || lowerText. contains (" access denied ");} private String bytesToHex (byte [] bytes) {StringBuilder result = new StringBuilder (); for (byte b: bytes) {result. append (String. format (" % 02 x ", b ));} return result. toString ();} private ProcessRequest@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_69 Þ¾(¿Ã:standard_500_50" 
average_word_length	f÷äa¡Ö
@"$
potential_heading_score	š™™™™™É?"
sentence_count	      &@"$
alphanumeric_percentage	vàœ¥½å?"ú
punctuation_countsã*à

"	      0@

%	      ð?

(	      *@

)	      *@

,	      ð?

.	      $@

:	      ð?

;	      @

[	      ð?

{	       @

|	      (@

}	      @

]	      ð?

=	      ð?"!
uppercase_percentage	 oÅ¡?""
whitespace_percentage	h"lxz¥Ä?"
list_item_indicator  "

word_count	      _@"$
average_sentence_length	=›UŸ‹&@"
vocabulary_density	¼?ÆØ?"
digit_percentage	ü©ñÒMbp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	      @"
relative_position	“:M„í?2Ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_70FÑ
ó. toString ();} private ProcessRequest createProcessRequest (String pipelineName, String stepName, PipeDoc document) {ServiceMetadata metadata = ServiceMetadata. newBuilder (). setPipelineName (pipelineName). setPipeStepName (stepName). setStreamId (" security - stream - " + System. currentTimeMillis ()). setCurrentHopNumber (1). build (); ProcessConfiguration config = ProcessConfiguration. newBuilder (). build (); return ProcessRequest. newBuilder (). setDocument (document). setConfig (config)@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_70 “Ã(È:standard_500_50" 
average_word_length	M„Oo@"$
potential_heading_score	        "
sentence_count	      ,@"$
alphanumeric_percentage	kšwœ¢#é?"Ê
punctuation_counts³*°

"	       @

(	      ,@

)	      ,@

;	      @

{	      ð?

+	      ð?

,	       @

}	      ð?

=	       @

-	       @

.	      *@"!
uppercase_percentage	ì/»'µ?""
whitespace_percentage	[B>èÙ¬º?"
list_item_indicator  "

word_count	      W@"$
average_sentence_length	Ó¼ãI@"
vocabulary_density	Å1w-!Û?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	(µ¦yí?2Ù

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_71GÑ
ó(document). setConfig (config). setMetadata (metadata). build ();} private ProcessRequest createEmbedderProcessRequest (String pipelineName, String stepName, PipeDoc document) {ServiceMetadata metadata = ServiceMetadata. newBuilder (). setPipelineName (pipelineName). setPipeStepName (stepName). setStreamId (" security - stream - " + System. currentTimeMillis ()). setCurrentHopNumber (1). build (); Struct embedderConfig = Struct. newBuilder (). putFields (" embeddingModel ", Value. newBuilder ()@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_71 äÇ(ðÌ:standard_500_50" 
average_word_length	÷_˜L•@"$
potential_heading_score	        "
sentence_count	      ,@"$
alphanumeric_percentage	ÃÓ+eâè?"Ê
punctuation_counts³*°

"	      @

(	      .@

)	      ,@

;	       @

{	      ð?

+	      ð?

,	      @

}	      ð?

=	       @

-	       @

.	      *@"!
uppercase_percentage	ì/»'µ?""
whitespace_percentage	«ÏÕVì/»?"
list_item_indicator  "

word_count	      X@"$
average_sentence_length	=›UŸ«m@"
vocabulary_density	KÈ=›UÛ?"
digit_percentage	ü©ñÒMb`?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	ÛŠýe÷äí?2¡

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_72HÉ
ë. putFields (" embeddingModel ", Value. newBuilder (). setStringValue (" ALL _ MINILM _ L 6 _ V 2 "). build ()). putFields (" fieldsToEmbed ", Value. newBuilder (). setListValue (com. google. protobuf. ListValue. newBuilder (). addValues (Value. newBuilder (). setStringValue (" title "). build ()). addValues (Value. newBuilder (). setStringValue (" body "). build ()). build ()). build ()). build (); ProcessConfiguration config = ProcessConfiguration. newBuilder (). setCustomJsonConfig (@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_72 ÂÌ(ÆÑ:standard_500_50" 
average_word_length	šž^@"$
potential_heading_score	        "
sentence_count	      9@"$
alphanumeric_percentage	)\Âõ(æ?"š
punctuation_countsƒ*€

"	      $@

(	      5@

)	      4@

;	      ð?

,	       @

=	      ð?

.	      8@

_	      @"!
uppercase_percentage	HPüs·?""
whitespace_percentage	–C‹lçûÁ?"
list_item_indicator  "

word_count	     À]@"$
average_sentence_length	
×£p=
@"
vocabulary_density	:’ËH¿Ñ?"
digit_percentage		ž^)Ëp?"
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     °~@"
relative_position	p_ÎQî?2ª

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_73IÒ
ônewBuilder (). setCustomJsonConfig (embedderConfig). build (); return ProcessRequest. newBuilder (). setDocument (document). setConfig (config). setMetadata (metadata). build ();} private PipeStepProcessorGrpc. PipeStepProcessorBlockingStub getClientForService (String serviceName) {switch (serviceName) {case " tika ": return tikaClient; case " chunker ": return chunkerClient; case " embedder ": return embedderClient; case " echo ": return echoClient; default: throw new IllegalArgumentException (@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_73 •Ñ(´Ö:standard_500_50" 
average_word_length	tµûË.@"$
potential_heading_score	        "
sentence_count	      "@"$
alphanumeric_percentage	Ház®Gé?"š
punctuation_countsƒ*€

"	       @

(	      &@

)	      $@

:	      @

;	      @

{	       @

}	      ð?

.	       @"!
uppercase_percentage	L7‰A`å°?""
whitespace_percentage	ÙÎ÷Sã¥»?"
list_item_indicator  "

word_count	     @W@"$
average_sentence_length	{ƒ/L¦ª$@"
vocabulary_density	I€&Â†Û?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     @@"
relative_position	#Ûù~j¼î?2ß

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_74JÇ
édefault: throw new IllegalArgumentException (" Unknown service: " + serviceName);}} // Inner classes for test results private static class BufferOverflowTestResult {final String testDescription; final boolean handledGracefully; final boolean causedCrash; final long responseTime; BufferOverflowTestResult (String testDescription, boolean handledGracefully, boolean causedCrash, long responseTime) {this. testDescription = testDescription; this. handledGracefully = handledGracefully; this.@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_74 ‰Ö(ùÚ:standard_500_50" 
average_word_length	¨WÊ2Äq@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	Àìž<,Ôê?"Ú
punctuation_countsÃ*À

"	       @

(	       @

)	       @

:	       @

+	      ð?

;	      @

{	       @

,	      @

}	       @

=	       @

.	      @

/	       @"!
uppercase_percentage	-!ôlV­?""
whitespace_percentage	»'µ¦¹?"
list_item_indicator  "

word_count	      R@"$
average_sentence_length	      8@"
vocabulary_density	ÄB­iÞqà?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     ~@"
relative_position	¸¯çŒ(ï?2©

@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_75KÑ
ó= handledGracefully; this. causedCrash = causedCrash; this. responseTime = responseTime;}} private static class DataIntegrityResult {final boolean integrityMaintained; final boolean checksumValid; final boolean dataCorrupted; final String inputHash; final String outputHash; DataIntegrityResult (boolean integrityMaintained, boolean checksumValid, boolean dataCorrupted, String inputHash, String outputHash) {this. integrityMaintained = integrityMaintained; this. checksumValid = checksumValid; this@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_75 ÔÚ(äß:standard_500_50" 
average_word_length	X¨5Í;@"$
potential_heading_score	š™™™™™É?"
sentence_count	      @"$
alphanumeric_percentage	9EGrùë?"š
punctuation_countsƒ*€

(	      ð?

)	      ð?

;	      $@

{	       @

,	      @

=	      @

}	       @

.	      @"!
uppercase_percentage	:’ËH¿­?""
whitespace_percentage	à- ¸?"
list_item_indicator  "

word_count	      R@"$
average_sentence_length	ÍÌÌÌÌÌ,@"
vocabulary_density	ioð…ÉTÕ?"
digit_percentage	        "
is_last_chunk  "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     0@"
relative_position	k+ö—Ý“ï?2÷
@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_76Lâ
„. checksumValid = checksumValid; this. dataCorrupted = dataCorrupted; this. inputHash = inputHash; this. outputHash = outputHash;}}}@7885272f-c5f4-40b9-bd05-6291a036935b_tika-input-doc-017_chunk_76 µß(çà:standard_500_50" 
average_word_length	     €@"$
potential_heading_score	        "
sentence_count	      @"$
alphanumeric_percentage	}Ð³Yõ¹è?"X
punctuation_countsB*@

;	      @

=	      @

}	      @

.	      @"!
uppercase_percentage	‚sF”ö¯?""
whitespace_percentage	†ZÓ¼ã½?"
list_item_indicator  "

word_count	      8@"$
average_sentence_length	333333@"
vocabulary_density	      Ø?"
digit_percentage	        "
is_last_chunk "
contains_urlplaceholder  "
is_first_chunk  "
character_count	     €`@"
relative_position	      ð?